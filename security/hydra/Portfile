# $Id$

PortSystem 1.0

name               hydra
version            5.4
revision	   1
distname           ${name}-${version}-src
categories         security net
platforms          darwin
maintainers        pmq

description        A very fast network logon cracker which support many services
long_description   Hydra is a parallelized logon cracker utility. Hydra can \
		   brute force attack on FTP, POP3, IMAP, Telnet, HTTP Auth, \
		   NNTP, VNC, ICQ, Socks5, PCNFS and more services within SSL \
		   support.

homepage           http://www.thc.org/thc-hydra
master_sites       http://freeworld.thc.org/releases
checksums          md5 fa08b465d19321e77b1a0ef912eeecc1

depends_lib        port:openssl port:libssh

livecheck.check	   regex
livecheck.url      ${homepage}
livecheck.regex	   "${name}-(.*?)-src"

post-patch {
    reinplace "s|/usr/local/|${prefix}/|g" ${worksrcpath}/configure
    # don't take any chance with auto-detection
    reinplace "s|SSL_PATH=\"\"|SSL_PATH=\"${prefix}/lib\"|" ${worksrcpath}/configure
    reinplace "s|SSL_IPATH=\"\"|SSL_IPATH=\"${prefix}/include\"|" ${worksrcpath}/configure
    reinplace "s|CRYPTO_PATH=\"\"|CRYPTO_PATH=\"${prefix}/lib\"|" ${worksrcpath}/configure
}

build.args         XLIBPATHS="-L${prefix}/lib"

pre-destroot {
    reinplace "s|PREFIX=${prefix}|PREFIX=${destroot}${prefix}|" ${worksrcpath}/Makefile
    xinstall -m 755 -d ${destroot}${prefix}/share/doc/${name}
    xinstall -m 644 ${worksrcpath}/README ${destroot}${prefix}/share/doc/${name}
}

platform darwin 8 {
    build.args-append CC=/usr/bin/gcc-4.0
}
