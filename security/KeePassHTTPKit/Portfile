# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem              1.0
PortGroup               xcode 1.0
PortGroup               github 1.0

github.setup            MacPass KeePassHTTPKit 1.3.1
categories              security
platforms               darwin
license                 MIT
maintainers             {@janosch mailbox.org:janosch1} openmaintainer
description             An Objective-C implementation of the KeePassHttp protocol.
long_description        ${description}

checksums               rmd160  75fa070ee531dbc90128d2d35fa7bd47628e12bb \
                        sha256  375de8a610b8098bb2c4dd27f796d33c00c273df84fc8533cdcd5d74e9114f82 \
                        size    16943

depends_lib             port:GCDWebServer \
                        port:JSONModel

patchfiles              patch-remove-versioning-script.diff

xcode.scheme            KeePassHTTPKit
xcode.configuration     Release
xcode.destroot.type     framework

xcode.destroot.settings CODE_SIGN_IDENTITY=- \
                        CODE_SIGN_STYLE=Manual \
                        ENABLE_HARDENED_RUNTIME=NO \
                        FRAMEWORK_SEARCH_PATHS=${frameworks_dir} \
                        LD_DYLIB_INSTALL_NAME=${frameworks_dir}/${name}.framework/Versions/A/${name} \
                        SKIP_INSTALL=NO

# xcode PortGroup sets the DerivedData to /var/root/... which is not writeable. This fixes it.
destroot.pre_args-append -derivedDataPath ./DerivedData

# Building will be done in the destroot phase.
# See https://trac.macports.org/ticket/57137
build {}
