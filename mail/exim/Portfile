PortSystem 1.0
name            exim
version		4.12
revision	2	
categories	mail
description     complete replacement for sendmail	
long_description	Exim is a mail transfer agent (MTA) developed at the University of Cambridge for use on Unix systems connected to the Internet. It is freely available under the terms of the GNU General Public Licence. In overall style it is similar to Smail 3, but its facilities are more extensive.
platforms	darwin
maintainers     fkr@opendarwin.org
master_sites    ftp://ftp.csx.cam.ac.uk/pub/software/email/exim/exim4/ \
                ftp://ftp.exim.org/pub/exim/exim4/
depends_lib     path:/usr/include/netinet/ip_var.h:netinet-headers 
checksums 	md5 a69c8ebeec91559dea8fc4364ecb89a2

set exim_user 	exim 

configure   { 	cd ${worksrcpath}
              	system "cp src/EDITME Local/Makefile"
              	reinplace "s|/usr/exim/bin|${prefix}/sbin|g" Local/Makefile
              	reinplace "s|/usr/exim/configure|${prefix}/etc/exim/exim.conf|g" Local/Makefile
              	reinplace "s|EXIM_USER=|EXIM_USER=${exim_user}|g" Local/Makefile
              	reinplace "s|/var/spool/exim|${prefix}/var/spool/exim|g" Local/Makefile 
              	reinplace "s|EXIM_MONITOR=eximon.bin|#EXIM_MONITOR=eximon.bin|g" Local/Makefile
              	adduser ${exim_user} gid=[existsgroup mail] }

post-install {  system "install -o root -m 755 -d ${prefix}/share/exim"
                cd ${worksrcpath}
                system "cp -R doc/ ${prefix}/share/exim"
                system "install -o ${exim_user} -g mail -m 750 -d ${prefix}/var/spool/exim"
                system "install -o root -m 755 -d ${prefix}/etc/rc.d"
                system "install -o root -m 755 -c \
                    ${portpath}/files/exim.sh ${prefix}/etc/rc.d"
                reinplace "s|__PREFIX|${prefix}|g" ${prefix}/etc/rc.d/exim.sh }

contents    	etc/exim \
            	etc/exim/exim.conf \
            	sbin \
            	sbin/exicyclog \
            	sbin/exigrep \
            	sbin/exim \
            	sbin/exim-4.12-1 \
            	sbin/exim_checkaccess \
            	sbin/exim_dbmbuild \
            	sbin/exim_dumpdb \
            	sbin/exim_fixdb \
            	sbin/exim_lock \
            	sbin/exim_tidydb \
            	sbin/eximstats \
            	sbin/exinext \
            	sbin/exiqsumm \
            	sbin/exiwhat
