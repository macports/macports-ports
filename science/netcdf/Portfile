# $Id$

PortSystem   1.0

name         netcdf
version      4.0.1
revision     1
maintainers  nomaintainer
platforms    darwin
categories   science

description  NetCDF - Network Common Data Form
long_description \
    NetCDF is an interface \
    for array-oriented data access and a library that \
    provides an implementation of the interface. The \
    netCDF library also defines a machine-independent \
    format for representing scientific data. Together, \
    the interface, library, and format support the \
    creation, access, and sharing of scientific data. \
    The netCDF software was developed at the Unidata \
    Program Center in Boulder, Colorado.

homepage     http://unidata.ucar.edu/packages/netcdf/

master_sites ftp://ftp.unidata.ucar.edu/pub/netcdf/ \
             http://www.gfd-dennou.org/arch/netcdf/unidata-mirror/ \
             ftp://www.gfd-dennou.org/arch/netcdf/unidata-mirror/

checksums           md5     a251453c5477599f050fa4e593295186 \
                    sha1    96b361de72bcf68eaba42e7e5cf0f92c33d288e9 \
                    rmd160  ba74363bbc4c76fc1bbac578ba4c2af4739b4958



depends_lib  port:szip \
             port:hdf5-18 \
             port:openmpi

configure.fc        openmpif77
configure.cc        openmpicc
configure.cxx       openmpicxx
configure.cppflags  "-DNDEBUG -Df2cFortran"
configure.cxxflags  "-O2 -fno-common"
configure.cflags    "-O2 -fno-common"
configure.args \
    --enable-shared \
    --enable-netcdf-4 \
    --with-hdf5=${prefix} \
    --with-szlib=${prefix}

test.run    yes
test.target check

destroot.destdir \
    prefix=${destroot}${prefix} \
    MANDIR=\\\${prefix}/share/man

post-destroot {
    file delete -force ${destroot}${prefix}/share/man/whatis.db
}

variant g95 description {Enable Fortran support with g95} {
    depends_lib     port:g95
    configure.args-delete   --disable-f77
    configure.fc        ${prefix}/bin/g95
    configure.env-append    FCFLAGS=-O2
}
