--- a/libext/scalapack/build_scalapa.sh
+++ b/libext/scalapack/build_scalapa.sh
@@ -1,4 +1,10 @@
 #!/usr/bin/env bash
+declare -a LIST_MPIFWRAP
+LIST_MPIFWRAP=( 'mpif90' 'mpifort' 'mpiifort' 'mpifc' 'mpixlf_r' 'mpixlf' 'mpif77' 'mpifrt' 'mpifrtpx' 'mpif90-mpich-mp' 'mpifort-mpich-mp' 'mpif90-openmpi-mp' 'mpifort-openmpi-mp')
+export LIST_MPIFWRAP
+declare -a LIST_MPICWRAP
+LIST_MPICWRAP=( 'mpicc' 'mpicc'    'mpiicc'  'mpiicc' 'mpixlc_r' 'mpixlc' 'mpicc' 'mpifcc' 'mpifccpx' 'mpicc-mpich-mp' 'mpicc-mpich-mp' 'mpicc-openmpi-mp' 'mpicc-openmpi-mp')
+export LIST_MPICWRAP
 myscalapwd=`pwd`
 source ../libext_utils/cmake.sh
 cd $myscalapwd
@@ -9,11 +15,25 @@
     MPICC="cc"
 else
     if ! [ -x "$(command -v mpif90)" ]; then
-	echo
-	echo mpif90 not installed
-	echo mpif90 is required for building Scalapack
-	echo
-	exit 1
+	length=${#LIST_MPIFWRAP[*]}
+	indx=0
+	while [ "${indx}" -lt "${length}" ] ; do
+	    candidate="${LIST_MPIFWRAP[${indx}]}"
+	    CMDGUESS="$(command -v $candidate)"
+	    if [ $? -eq 0 ] ; then
+		MPIF90="${LIST_MPIFWRAP[${indx}]}"
+		MPICC="${LIST_MPICWRAP[${indx}]}"
+		echo found mpi wrappers $MPIF90 $MPICC
+		break 
+	    else   ((indx++)); fi
+	done
+	if [ -z ${MPIF90} ] ; then
+	    echo
+	    echo mpif90 not installed
+	    echo mpif90 is required for building Scalapack
+	    echo
+	    exit 1
+	fi
     else
 	MPIF90="mpif90"
 	if [[ -z "${MPICC}" ]]; then
@@ -25,6 +45,9 @@
 if [[  -z "${FC}" ]]; then
     FC=$($MPIF90 -show|cut -d " " -f 1)
 fi
+if [[  -z "${CC}" ]]; then
+    CC=$($MPICC -show|cut -d " " -f 1)
+fi
 if [[  -z "${NWCHEM_TOP}" ]]; then
     dir3=$(dirname `pwd`)
     dir2=$(dirname "$dir3")
@@ -119,6 +142,7 @@
 #COMMIT=ea5d20668a6b8bbee645b7ffe44623c623969d33
 COMMIT=5bad7487f496c811192334640ce4d3fc5f88144b
 COMMIT=782e739f8eb0e7f4d51ad7dd23fc1d03dc99d240
+COMMIT=a23c2cdc6586c427686f6097ae66bb54ef693571
 rm -rf scalapack 
 if [[ -f "scalapack-$COMMIT.tar.gz" ]]; then
     echo "using existing"  "scalapack-$COMMIT.tar.gz"
@@ -134,7 +158,7 @@
 		  tries=$((tries+1)) ;  done
 fi
 tar xzf scalapack-$COMMIT.tar.gz
-ln -sf scalapack-$COMMIT scalapack
+ln -sf scalapack-*$COMMIT scalapack
 #ln -sf scalapack-${VERSION} scalapack
 #curl -L http://www.netlib.org/scalapack/scalapack-${VERSION}.tgz -o scalapack.tgz
 #tar xzf scalapack.tgz
@@ -150,7 +174,11 @@
 if [[ $(echo "$LAPACK_LIB" |awk '/lapack/ {print "Y"; exit}' ) == "Y" ]]; then
     export USE_DCOMBSSQ=1
 fi
-if [[ $(echo ""$LAPACK_LIB |awk '/lfjlapack/ {print "Y"; exit}'  ) == "Y" ]]; then
+if [[ $(echo "$LAPACK_LIB" |awk '/lfjlapack/ {print "Y"; exit}'  ) == "Y" ]]; then
+    export USE_DCOMBSSQ=1
+fi
+# ubuntu 24.04 openblas pkg does not contain dcombossq
+if [[ $(echo "$LAPACK_LIB" |awk '/openblas/ {print "Y"; exit}'  ) == "Y" ]]; then
     export USE_DCOMBSSQ=1
 fi
 if [[  -z "$USE_DCOMBSSQ" ]]; then
@@ -209,7 +237,7 @@
     export MPICH_CC="$CC"
 fi
 echo MPICH_CC is "$MPICH_CC"
-echo $(mpicc -show)
+echo $(${MPICC} -show)
 #Intel MPI
 if [[  -z "$I_MPI_F90"   ]] ; then
     export I_MPI_F90="$FC"
@@ -235,11 +263,20 @@
 GOTCLANG=$( "$MPICC" -dM -E - </dev/null 2> /dev/null |grep __clang__|head -1|cut -c19)
 if [[ `${MPICC} -dM -E - < /dev/null 2> /dev/null | grep -c GNU` > 0 ]] ; then
     let GCCVERSIONGT12=$(expr `${MPICC} -dumpversion | cut -f1 -d.` \> 12)
+    let GCCVERSIONGT13=$(expr `${MPICC} -dumpversion | cut -f1 -d.` \> 13)
+    let GCCVERSIONGT14=$(expr `${MPICC} -dumpversion | cut -f1 -d.` \> 14)
 fi
 
 if [[ ${GOTCLANG} == "1" ]] || [[ ${GCCVERSIONGT12} == "1" ]]  ; then
     C_FLAGS=" -Wno-error=implicit-function-declaration "
 fi
+if [[ ${GCCVERSIONGT13} == "1" ]]  ; then
+    C_FLAGS+=" -std=gnu17 "
+fi
+if [[ ${GCCVERSIONGT14} == "1" ]]  ; then
+    C_FLAGS+=" -fPIE "
+    Fortran_FLAGS+=" -fPIE "
+fi
 if [[  "$SCALAPACK_SIZE" == 8 ]] ; then
     if  [[ ${FC} == f95 ]] || [[ ${FC_EXTRA} == gfortran ]] ; then
     Fortran_FLAGS+=" -fdefault-integer-8 -w "
