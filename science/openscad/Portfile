# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0

PortGroup           qmake5 1.0
PortGroup           github 1.0

name                openscad

github.setup openscad openscad 2019.05 openscad-

license             GPL-2
categories          science cad
maintainers         {dstrubbe @dstrubbe} openmaintainer
description         OpenSCAD is a software for creating solid 3D CAD objects
long_description    OpenSCAD is a software for creating solid 3D CAD objects. \
                    Unlike most free software for creating 3D models (such as the \
                    famous application Blender) it does not focus on the artistic \
                    aspects of 3D modelling but instead on the CAD aspects. Thus \
                    it might be the application you are looking for when you are \
                    planning to create 3D models of machine parts. \
                    OpenSCAD is not an interactive modeller. Instead it is something \
                    like a 3D-compiler that reads in a script file that describes \
                    the object and renders the 3D model from this script file. 

platforms           darwin
homepage            http://www.openscad.org/

checksums           rmd160  6a349c251e82f32eab755504b3c83eaf722d7947 \
                    sha256  2c59f788654ea4fafcf7335118c303a8330bce46c8db31c7ec519680d83d79cc \
                    size    14605719

depends_build-append \
                    port:bison \
                    port:flex

depends_lib-append  port:boost \
                    port:libzip \
                    port:cgal4 \
                    port:lib3mf \
                    port:qscintilla-qt5 \
                    port:qt5-qtmultimedia \
                    port:glew \
                    path:lib/pkgconfig/glib-2.0.pc:glib2 \
                    port:gmp \
                    port:mpfr \
                    port:double-conversion \
                    port:OpenCSG

configure.env-append \
                    OPENSCAD_LIBRARIES=${prefix} \
                    LIB3MF_LIBDIR=${prefix}/lib

configure.pre_args-append \
                    VERSION=${version} openscad.pro

post-destroot {
    # Application
    move ${destroot}${prefix}/bin/OpenSCAD.app ${destroot}${applications_dir}

    # Examples
    file mkdir ${destroot}${applications_dir}/OpenSCAD.app/Contents/Resources/
    move ${destroot}${prefix}/share/openscad/examples ${destroot}${applications_dir}/OpenSCAD.app/Contents/Resources/
    move ${destroot}${prefix}/share/openscad/color-schemes ${destroot}${applications_dir}/OpenSCAD.app/Contents/Resources/
    move ${destroot}${prefix}/share/openscad/fonts ${destroot}${applications_dir}/OpenSCAD.app/Contents/Resources/
    move ${destroot}${prefix}/share/openscad/locale ${destroot}${applications_dir}/OpenSCAD.app/Contents/Resources/

    # Delete un-needed files
    file delete ${destroot}${prefix}/share/appdata/openscad.appdata.xml
    file delete ${destroot}${prefix}/share/appdata
    file delete ${destroot}${prefix}/share/applications/openscad.desktop
    file delete ${destroot}${prefix}/share/applications
    file delete ${destroot}${prefix}/share/mime/packages/openscad.xml
    file delete ${destroot}${prefix}/share/pixmaps/openscad.png
    file delete ${destroot}${prefix}/share/pixmaps
}
