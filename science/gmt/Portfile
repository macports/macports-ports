# $Id$

PortSystem       1.0

name             gmt
version          4.2.1
categories       science
maintainers      takeshi@macports.org
description      the generic mapping tools
long_description an open source collection of ~60 tools         \
    for manipulating geographic and Cartesian data sets and     \
    producing Encapsulated PostScript File (EPS) illustrations  \
    ranging from simple x-y plots via contour maps to           \
    artificially illuminated surfaces and 3-D perspective views.
homepage         http://gmt.soest.hawaii.edu/
platforms        darwin
master_sites     ftp://ftp.soest.hawaii.edu/gmt/4        \
                 ftp://ibis.grdl.noaa.gov/pub/gmt/4      \
                 ftp://ftp.iris.washington.edu/pub/gmt/4 \
                 ftp://ftp.iag.usp.br/pub/gmt/4          \
                 ftp://ftp.geologi.uio.no/pub/gmt/4      \
                 ftp://life.csu.edu.au/pub/gmt/4         \
                 ftp://ftp.scc.u-tokai.ac.jp/pub/gmt/4
use_bzip2        yes
set gshhsversion 1.9
set gmtsrc       GMT${version}_src.tar.bz2
set gmtshare     GMT${version}_share.tar.bz2
set gmtsuppl     GMT${version}_suppl.tar.bz2
set gshhslow     GSHHS${gshhsversion}_coast.tar.bz2
distfiles  ${gmtsrc} ${gmtshare} ${gmtsuppl} ${gshhslow}
checksums  ${gmtsrc}   md5    cda1c16f59089646fdf34182f55625d8         \
           ${gmtsrc}   sha1   4a490fe86a921be26b6b78abe1335d7aafc4cd1a \
           ${gmtsrc}   rmd160 8b35ad3f237b8b9f072023bab9f8047e415fd212 \
           ${gmtshare} md5    ca385beb463cd248be4206bbc0f7fa4c         \
           ${gmtshare} sha1   8fddaa3b26f1d79b76be54f37488c25da771103e \
           ${gmtshare} rmd160 1e2f1a8063f028148534bfba5d768a73d078fa59 \
           ${gmtsuppl} md5    9838b944b9f81277f1c4575f1225f218         \
           ${gmtsuppl} sha1   f1b9fade27c9d8ce5a9791433f3b43d912278371 \
           ${gmtsuppl} rmd160 2e023fecbc5112b250821198a0364bf55ab6fdbf \
           ${gshhslow} md5    3eda660b999ee888ff59f6c7eba209a6         \
           ${gshhslow} sha1   19da37fb0a44b420d2bfeeb7958ce350b1c9a1b0 \
           ${gshhslow} rmd160 9a841f0ceeb26c0f3c4af75a406ed93cd1747d66
depends_lib      port:netcdf
worksrcdir       GMT${version}
configure.args --mandir=${prefix}/share/man --enable-shared --datadir=${prefix}/share/${name} --enable-netcdf=${prefix} --disable-www --disable-xgrid --disable-mexInstallScript
destroot.target  install-all
destroot.destdir prefix=${destroot}${prefix}

post-destroot {
  file mkdir ${destroot}${prefix}/share/${name}
  file copy ${workpath}/share/coast ${destroot}${prefix}/share/${name}/
  if {[variant_isset doc]} {
    file mkdir ${destroot}${prefix}/share/doc
    file copy ${worksrcpath}/examples ${destroot}${prefix}/share/${name}/
    file copy ${worksrcpath}/tutorial ${destroot}${prefix}/share/${name}/
    file copy ${worksrcpath}/www/${name} ${destroot}${prefix}/share/doc/
  }
}

variant gshhs description \
  {installs high and full resolution GSHHS coast line data} {
  set gshhshigh GSHHS${gshhsversion}_high.tar.bz2
  set gshhsfull GSHHS${gshhsversion}_full.tar.bz2
  distfiles-append ${gshhshigh} ${gshhsfull}
  checksums-append \
           ${gshhshigh} md5    de50a3eab394393a7246f293ac0c840a         \
           ${gshhshigh} sha1   5a31513b740eaf304b65baf228bc68f9ac6b5122 \
           ${gshhshigh} rmd160 bcf8b9d31b2eba45894efeb6e9f18e305636ec70 \
           ${gshhsfull} md5    2d3064c3fa2f7a4c3a2603dbb9885fff         \
           ${gshhsfull} sha1   04b110acc21d39ff314e22dd3e73019aa5848b73 \
           ${gshhsfull} rmd160 c016adfa90138e1128fa0448528b234521eb04c7
}

variant doc description {installs documentation, examples and tutorial} {
  set gmtpdf GMT${version}_pdf.tar.bz2
  set gmtweb GMT${version}_web.tar.bz2
  set gmtscr GMT${version}_scripts.tar.bz2
  set gmttut GMT${version}_tut.tar.bz2
  distfiles-append ${gmtpdf} ${gmtweb} ${gmtscr} ${gmttut}
  checksums-append \
           ${gmtpdf}   md5    9a0498b17ef297d528b5e445649b62e0         \
           ${gmtpdf}   sha1   691a795c4faee0a1f949bd706c434e2b3feb2e49 \
           ${gmtpdf}   rmd160 121d9f33dbb866b147dd17e92e00a01b268c51b1 \
           ${gmtweb}   md5    5b90eeb24610275ac8dea323b38ecb7e         \
           ${gmtweb}   sha1   e735a7cd59494b763e1509f27ff2584c5b8962d3 \
           ${gmtweb}   rmd160 e5b5d31276528359b2b0fa90f725c1618438c64d \
           ${gmtscr}   md5    d3de4e3535ca2fb3454b3cec267acfcf         \
           ${gmtscr}   sha1   88fc9a44f904a7787ef48767e8d2e309051ee52a \
           ${gmtscr}   rmd160 1684d534d9465b327044c9dbeb0eead8a22a2a4f \
           ${gmttut}   md5    016c137e8f47d10b7aaa2cccd6c0fbb4         \
           ${gmttut}   sha1   76489b9cb776eca5f7c64ab0289a5b2a70043308 \
           ${gmttut}   rmd160 f8bc669cc3cfb982d47ea0f211977b955b1a0bb7
}

livecheck.check regex
livecheck.url   http://gmt.soest.hawaii.edu/gmt/gmt_home.html
livecheck.regex {Current version is ([0-9]+.[0-9]+.[0-9]+.)}

