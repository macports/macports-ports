# $Id: Portfile,v 1.3 2004/02/24 20:41:32 jkh Exp $

PortSystem		1.0
name			blender
version			20040216
categories		aqua graphics
platforms		darwin
maintainers		krugazor@free.fr
description		3D modeler / renderer
long_description	Blender, the open source software for 3D modeling, \
			animation, rendering, post-production, interactive \
			creation and playback. Available for Windows, \
			Linux, Irix, Sun Solaris, FreeBSD or Mac OS X. \
			This is the CVS version that includes patches for Quicktime.

depends_lib		lib:libintl.1:gettext \
			lib:libftgl:ftgl \
			bin:sdl-config:libsdl \
			lib:libjpeg:jpeg \
			lib:libpng:libpng
depends_run		bin:python2.2:python

fetch.type		cvs
cvs.root		:pserver:anonymous@cvs.blender.org:/cvsroot/bf-blender
cvs.args		-D"20040216"
cvs.module		blender
worksrcdir		blender

patchfiles		patch-source-nan_definitions.mk \
			patch-source-Makefile

variant GameEngine {
 patchfiles-append	patch-source-nan_compile.mk
}

configure		{}

pre-build {
	# ./bootstrap fails, but it's ok.
	system "cd ${workpath}/blender && ./bootstrap ; mkdir -p ${workpath}/lib"
}

build.args		prefix=${prefix}

destroot {
	xinstall -m 755 -d ${destroot}/Applications/DarwinPorts
	system "ditto -rsrcFork ${workpath}/blender/obj/*/bin/blender.app \
		${destroot}/Applications/DarwinPorts/blender.app"
	if { [variant_isset GameEngine] } {
		system "ditto -rsrcFork ${workpath}/blender/obj/*/bin/blenderplayer.app \
			${destroot}/Applications/DarwinPorts/blenderplayer.app"
	}
}
