--- FL/mac.H.orig
+++ FL/mac.H
@@ -78,14 +78,17 @@
 #define MAC_OS_X_VERSION_10_12 101200
 #endif
 
-#ifndef NSINTEGER_DEFINED // appears with 10.5 in NSObjCRuntime.h
-#if defined(__LP64__) && __LP64__
-typedef long NSInteger;
-typedef unsigned long NSUInteger;
+#ifdef __OBJC__
+#if MAC_OS_X_VERSION_MAX_ALLOWED >= MAC_OS_X_VERSION_10_10
+#include <objc/NSObjCRuntime.h>
 #else
-typedef int NSInteger;
-typedef unsigned int NSUInteger;
+#include <Foundation/NSObjCRuntime.h>
+#endif
+
+#ifndef NSINTEGER_DEFINED // appears with 10.5 in NSObjCRuntime.h
+#error "NSINTEGER_DEFINED not defined"
 #endif
+
 #endif
 
 #ifdef __OBJC__
@@ -115,11 +118,7 @@
 struct XPoint { int x, y; };
 struct XRectangle {int x, y, width, height;};
 #ifndef CGFLOAT_DEFINED //appears with 10.5 in CGBase.h
-#if defined(__LP64__) && __LP64__
-typedef double CGFloat;
-#else
-typedef float CGFloat;
-#endif
+#error "CGFLOAT_DEFINED not defined"
 #endif // CGFLOAT_DEFINED
 
 extern CGRect fl_cgrectmake_cocoa(int x, int y, int w, int h);
--- src/Fl_Quartz_Printer.mm.orig
+++ src/Fl_Quartz_Printer.mm
@@ -89,7 +89,7 @@
   else
 #endif
   {
-#if !defined(__LP64__) || !__LP64__
+#if (!defined(__LP64__) || !__LP64__) && (MAC_OS_X_VERSION_MAX_ALLOWED < MAC_OS_X_VERSION_10_5)
     Boolean accepted;
     status = PMCreateSession(&printSession);
     if (status != noErr) return 1;
