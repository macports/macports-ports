# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:filetype=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0

name                djview
version             4.5
revision            1
categories          aqua graphics www
maintainers         nomaintainer
platforms           darwin

description         DjVu files viewer.
long_description    DjVu can advantageously replace PDF, PS, TIFF,JPEG, and GIF for \
                    distributing scanned documents, digital documents, or high-resolution \
                    pictures. DjVu content downloads faster, displays and renders faster, \
                    looks nicer on a screen and consume less client resources than competing \
                    formats.

homepage            http://djvu.sourceforge.net/

master_sites        sourceforge:djvu
distname            ${name}4-${version}

checksums           md5     0461a26dbcac33dcc5eb7955ac357504 \
                    sha1    d2fd259aa88f80393767f6dec921463da7820143 \
                    rmd160  256abad9cc6d661ba19caf209b74d9937eec4bce

use_parallel_build  yes

depends_build \
    path:bin/pkg-config:pkgconfig

depends_lib \
    port:djvulibre \
    port:qt4-mac

configure.env             QTDIR=${prefix}/libexec/qt4-mac

configure.args \
    --disable-nsdejavu \
    --disable-desktopfiles \
    QMAKESPEC=macx-g++

universal_variant no

post-configure {
    # fix issue with qmake adding an extra -arch sometimes
    reinplace "s|-arch ${build_arch} -arch|-arch ${build_arch}|" \
        ${worksrcpath}/src/Makefile
}

destroot {
    xinstall -m 755 -d ${destroot}${applications_dir}
    copy ${worksrcpath}/src/djview.app ${destroot}${applications_dir}
}

livecheck.name	djvu
livecheck.regex  "(?i)<title>${name} (.*) released.*</title>"
