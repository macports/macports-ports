# $Id$

PortSystem              1.0
PortGroup               xcode 1.0

name                    Quicksilver          
version                 B59    
platforms               darwin
maintainers             singingwolfboy openmaintainer
categories              aqua sysutils
license                 Apache-2.0
supported_archs         i386
description             Mac OS X at your fingertips
long_description        \
    Quicksilver is a light, fast and free Mac OS X application that gives you \
    the power to control your Mac with keystrokes alone.

homepage                http://qsapp.com/
fetch.type              git
git.url                 https://github.com/quicksilver/${name}.git
git.branch              ${version}
build.dir               ${worksrcpath}/${name}
xcode.project           ${name}.xcodeproj

set config_root         ${prefix}/share/QS
use_configure           yes
configure   {
    file mkdir ${workpath}${config_root}
    reinplace -E "s|/tmp/QS|${workpath}${config_root}|" \
        ${build.dir}/Configuration/Common.xcconfig ${build.dir}/${xcode.project}/project.pbxproj
}

post-destroot {
    move ${workpath}${config_root} ${destroot}${config_root}
    foreach framework [glob ${destroot}${applications_dir}/*.framework] {
        move ${framework} ${destroot}${frameworks_dir}
    }
    set plugins_dir "/Library/Application Support/${name}/PlugIns/"
    xinstall -d ${destroot}${plugins_dir}
    foreach plugin [glob ${destroot}${applications_dir}/*.qsplugin] {
        move ${plugin} ${destroot}${plugins_dir}
    }

    # not sure why this hierarchy is here, but we don't want it
    if {[file exists ${destroot}${prefix}/var/macports]} {
        delete ${destroot}${prefix}/var/macports
    }
}

# xcode.target            "${name} Distribution"
# xcode.configuration     Release
