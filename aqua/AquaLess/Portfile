# $Id$

PortSystem      1.0
PortGroup       xcode 1.0

name            AquaLess
version         1.5
categories      aqua sysutils
maintainers     nox
description     Cocoa pager similar to less

long_description \
    AquaLess is a text pager for Mac OS X. It allows you to browse plain \
    text files and -- more importantly -- text output from Unix command \
    line tools. AquaLess is a Cocoa replacement for the less command, which \
    is constrained to the terminal window. AquaLess opens a separate window \
    for each text, so you can keep working in the terminal while you read.

homepage        http://aqualess.sourceforge.net/
master_sites    sourceforge:aqualess
distname        ${name}-${version}-src

xcode.target            ${name}
xcode.destroot.settings SKIP_INSTALL=NO

checksums       md5 7e3d04993dc09c31f1daf09dbb5e2677 \
                sha1 754681d9bd3e85586d2e50a9697c2ca0dc3b4750 \
                rmd160 7a574fff89463fa57e0f1a0e49ad790be2e00b93

post-patch {
    reinplace -E "/@/s|/usr|${prefix}|" \
        ${worksrcpath}/ToolInstaller.m

    reinplace -E "/(MACOSX_DEPLOYMENT_TARGET|SDKROOT)_ppc =/d" \
        ${worksrcpath}/${name}.xcodeproj/project.pbxproj
}

# Dummy configure to enable universal variant.
use_configure   yes
configure       {}

if {! [variant_isset universal]} {
    set arch ${os.arch}
    if {! [string compare ${arch} powerpc]} {
        set arch ppc
    }

    xcode.build.settings-append     ARCHS=${arch}
    xcode.destroot.settings-append  ARCHS=${arch}
}

post-destroot {
    delete ${destroot}/Applications/MacPorts/aless
    xinstall -m 0755 ${destroot}/Applications/MacPorts/${name}.app/Contents/Resources/aless \
        ${destroot}${prefix}/bin
}

livecheck.distname  ${name}

