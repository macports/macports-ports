# $Id: Portfile,v 1.2 2003/08/05 09:29:30 jkh Exp $

PortSystem 1.0

name		ksh
version		93
categories	shells
maintainers	jkh@opendarwin.org
description	The AT&T Korn shell
long_description The official version of ksh-93, by David Korn and AT&T research
platforms	darwin
distfiles	{}

fetch {
	global all_dist_files

	set URL http://www.research.att.com/sw/download
	system "mkdir -p ${workdir}/bin"
	system "curl -s $URL/package > ${workdir}/bin/package && chmod +x ${workdir}/bin/package"
	system "cd ${workdir}; bin/package setup flat source $URL ast-ksh ast-open"
	# This is bogus and I shouldn't need to do this, but the checksum
	# check is too anal.
	unset all_dist_files
}

extract {}

configure {}

build {
	system "cd ${workdir}; bin/package make"
}

destroot {
# this is the approved way of installing, but it doesn't work on Mac OS X
#	system "cd ${workdir}; bin/package install flat ${destroot}${prefix} ast-ksh"
	system "install -m 755 ${workdir}/arch/darwin.ppc/bin/ksh ${destroot}${prefix}/bin"
	system "install -m 755 ${workdir}/arch/darwin.ppc/man/man1/sh.1 ${destroot}${prefix}/man/man1/ksh.1"
}
