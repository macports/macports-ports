# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           golang 1.0

go.setup            github.com/HyNetwork/hysteria 0.9.4 v
revision            1
set git-commit      bd67d017c00fe1513dbf59a0dc4b2c75abf6832c
categories          net
maintainers         {i0ntempest @i0ntempest} openmaintainer
license             MIT

description         network utility and proxy optimized for networks of poor quality
long_description    Hysteria is a feature-packed network utility optimized for networks of poor quality \
                    (e.g. satellite connections, congested public Wi-Fi, cross-country connection) \
                    powered by a custom version of QUIC protocol. 

checksums           ${distname}${extract.suffix} \
                        rmd160  c51592a58e35818eb9d5dcf9c078eb0058d77f1d \
                        sha256  4fda699b799fc26693243f2719c3e0ca8933e3f203b1898e43476c5cbe5964f3 \
                        size    496758
go.package          github.com/tobyxdd/hysteria

go.vendors          gopkg.in/yaml.v3 \
                        lock    496545a6307b \
                        rmd160  16a43936d8ae6243895e23465132977d3a1193c2 \
                        sha256  333e78b3b9cb73b3572d62f692d32426a8554b86c93025ea032f779395869e84 \
                        size    90145 \
                    gopkg.in/yaml.v2 \
                        lock    v2.4.0 \
                        rmd160  66e9feb7944b3804efa63155ed9b618717b8955c \
                        sha256  72812077e7f20278003de6ab0d85053d89131d64c443f39115a022114fd032b6 \
                        size    73231 \
                    gopkg.in/tomb.v1 \
                        lock    dd632973f1e7 \
                        rmd160  ae07f5ddbbc6afc772d6dc5273bb72eaba50529a \
                        sha256  91c562a4e31c89d13e5391143ff653231fc2d80562743db89ce2172ad8f81008 \
                        size    3636 \
                    gopkg.in/check.v1 \
                        lock    41f04d3bba15 \
                        rmd160  1e5543a8e6a3159296ee63e28cbde9931a04f6b3 \
                        sha256  c41575a73d10809f89b05ef9e783f2d53facdc6573697770d30efb05a9d2dc28 \
                        size    31612 \
                    google.golang.org/protobuf \
                        repo    github.com/protocolbuffers/protobuf-go \
                        lock    v1.27.1 \
                        rmd160  a4ac7b66fd88a34a9ea447476d19ff3c1f2b57dd \
                        sha256  fe1055b9bf6b8792aed1771f56c31f836c24a18d69eaeb13c88990db3d9da7ce \
                        size    1278850 \
                    golang.org/x/xerrors \
                        lock    5ec99f83aff1 \
                        rmd160  6e8267f353e153297f205e4be219236d6ae43880 \
                        sha256  9a500a49d83a09e7de6c71b215d1c14b81e315d26884530ef327c95ddf1f2d28 \
                        size    13667 \
                    golang.org/x/tools \
                        lock    v0.1.1 \
                        rmd160  861f7f72627b4449752dded9ab7c1a376435e841 \
                        sha256  b26d3b51fbcbabc7ff8fd2cfdb152421753dfeb8f7e38be9041c0bddfa1b8acd \
                        size    2785629 \
                    golang.org/x/text \
                        lock    v0.3.6 \
                        rmd160  e3da48fcc60d98e202458228188bf6dac408e309 \
                        sha256  6b2d69df22b5ba1634bc6730c3f03404db499536a96c48b8016da80ced804450 \
                        size    8356058 \
                    golang.org/x/sys \
                        lock    0f9fa26af87c \
                        rmd160  b5e5b546cddec0ad97bccbc3a19fe3630792097b \
                        sha256  e9ff4a07a3cc01341990da0d8ecd1cfa05643a2db423bb1efcf62f577901ea77 \
                        size    1202158 \
                    golang.org/x/sync \
                        lock    036812b2e83c \
                        rmd160  f42be6eb3565d2ed3d1066ea1a7f69437c8bb1e6 \
                        sha256  6f1daceb16cd75bdbf35da6c50aa352d1995d68ccd0049851d27686f451fad92 \
                        size    18756 \
                    golang.org/x/net \
                        lock    abc453219eb5 \
                        rmd160  22a39345610f64ddadd6778a0d0a80beecd93d48 \
                        sha256  8f0f8e126d014d7c29f832abcb44ff1783c92fcf57d1e6234aad2bebb4dc7bd2 \
                        size    1252607 \
                    golang.org/x/mod \
                        lock    v0.4.2 \
                        rmd160  0f3ca57198b4de4eb89b2c1a2bdb01af040d1f36 \
                        sha256  e2e4cba5719f804f2ec901b4ccdf6d3abf05521868ed54f271be7c1bf6c48549 \
                        size    104573 \
                    golang.org/x/crypto \
                        lock    c07d793c2f9a \
                        rmd160  bd005f5fd86d9021e5da5d606b5a0b0091f27476 \
                        sha256  cfd0c4c624ae799ae9dae5ac2b1ca48c054c8db8b2f281be6c7bd6a7ee277919 \
                        size    1732033 \
                    go.uber.org/zap \
                        repo    github.com/uber-go/zap \
                        lock    v1.17.0 \
                        rmd160  cb23224e75a92136e4095381052ce87d3bad8073 \
                        sha256  c55e23096f9d58b3cc4cb6ff207c407b646c4eda305077fdf0051f3a9da8bb88 \
                        size    142763 \
                    go.uber.org/multierr \
                        repo    github.com/uber-go/multierr \
                        lock    v1.6.0 \
                        rmd160  d132836fdf8d1853ddff41df3b06d2574b03a768 \
                        sha256  87ee707f3e3930098315c9045cc651347c7d689d6dec6d9a1424200c20cc17d4 \
                        size    12375 \
                    go.uber.org/atomic \
                        repo    github.com/uber-go/atomic \
                        lock    v1.7.0 \
                        rmd160  90f5738aeea3515c0084dc76639a87de557e8a74 \
                        sha256  9aa45eeb415a1d252b03d08d46dc1e186f4a8a37ce9dd2c5f9fb61602cade57b \
                        size    18573 \
                    github.com/yosuke-furukawa/json5 \
                        lock    v0.1.1 \
                        rmd160  12277fa3933b0deb4e9c0e6e6c5abbbf365f717f \
                        sha256  f6a5ebbece75795a7efb7d450139111b3da1634df7949cafd0f30e0b42e8c6e2 \
                        size    23963305 \
                    github.com/urfave/cli \
                        lock    v2.3.0 \
                        rmd160  fec9e73bc45d02b2afe43e8d9c76398722494e4b \
                        sha256  3138857026c9564559b3e734b9b8abfeda57354fc4aa87717879882bff68ef09 \
                        size    3408338 \
                    github.com/txthinking/x \
                        lock    476fab902fbe \
                        rmd160  a89c168ebd1cb1b4c1c80aa45a6bce08efea7d96 \
                        sha256  18bb1b84f2abfcd3564830588efaf4bad9649fc1ea5a637994f8639cd974fd04 \
                        size    5360 \
                    github.com/txthinking/socks5 \
                        lock    61b5745ff346 \
                        rmd160  6ae8438b87b0061218852cf5fb3b9a9fed73287b \
                        sha256  b785607377bbff0468bf35f330d20d1d8bd8edffd3b17a3f492e5c159139b70a \
                        size    12128 \
                    github.com/txthinking/runnergroup \
                        lock    37fc67d0da7c \
                        rmd160  1313067a137ff99f14619dc96e058621328566b6 \
                        sha256  75ced8b00cb910eb3d8bae5c000e828cf3f27fd2cfd66ee5fec8ed4a6a54474d \
                        size    2223 \
                    github.com/lucas-clemente/quic-go \
                        repo    github.com/tobyxdd/quic-go \
                        lock    v0.24.0-mod \
                        rmd160  3c26153f9135c6c4f0f1b99a8b991bb1c14edfce \
                        sha256  dc9778d890c034087a49db4b66b013a35fd80ea0aedc8e52dfea0c40e0c115c4 \
                        size    522623 \
                    github.com/stretchr/testify \
                        lock    v1.7.0 \
                        rmd160  adae5096e8c4cfcc8e3f6d096646d1165b5ef49a \
                        sha256  f7dde97d0c9634483ae6ea273968f80f3105c22382a1f841886cd20d57586642 \
                        size    91096 \
                    github.com/songgao/water \
                        lock    fd331bda3f4b \
                        rmd160  b6ece32740af654d43febfe797082b6c8d41ea07 \
                        sha256  64799f1dba1ebfef66e8cd1b907e3724d0ee9404666342dd69576754c7278bf3 \
                        size    17094 \
                    github.com/sirupsen/logrus \
                        lock    v1.8.1 \
                        rmd160  aeb4e5f2ea8112e787a72fba611605c4c87f42b5 \
                        sha256  931c31f624d05136760b41a63f6bc146b79ac91776b4642cbd2026c2792e3aca \
                        size    47184 \
                    github.com/russross/blackfriday \
                        lock    v2.1.0 \
                        rmd160  c42a9332a2c2f3074c6f7e8d37a58d6148d2af08 \
                        sha256  c4df56f2012a7d16471418245e78b5790569e27bbe8d72a860d7117a801a7fae \
                        size    92950 \
                    github.com/prometheus/procfs \
                        lock    v0.6.0 \
                        rmd160  ae0e0bcf1c664eacc18c03ec77973f0212dce472 \
                        sha256  4ffc099c6f2ce85a7681e09462e465b140556743a248f4b3bdc665498f3380b1 \
                        size    169970 \
                    github.com/prometheus/common \
                        lock    v0.26.0 \
                        rmd160  6767da5e89b5aa9e4872df991afdd96abbb0c872 \
                        sha256  7f1004d8c389191b2c918e267807b6fee0e24d0073de5fa87e47e0798ef13644 \
                        size    116913 \
                    github.com/prometheus/client_model \
                        lock    v0.2.0 \
                        rmd160  9b5b538e80eeb491b02806cc1cb87a83e62a9577 \
                        sha256  55c1223bb5d1ae7e33527bc0ce80e3ab5153c47d396a9f864feea150b301f690 \
                        size    10985 \
                    github.com/prometheus/client_golang \
                        lock    v1.11.0 \
                        rmd160  96f9efe7bff3d325ea9f2a3a2caecf1dbebc77c2 \
                        sha256  fcad11001028f3cecfc6e7f5221a361f0f5ea49cf6ab29a2baf70cf5e005d5a5 \
                        size    168768 \
                    github.com/pmezard/go-difflib \
                        lock    v1.0.0 \
                        rmd160  fc879bfbdef9e3ff50844def58404e2b5a613ab8 \
                        sha256  7cd492737641847266115f3060489a67f63581e521a8ec51efbc280c33fc991f \
                        size    11409 \
                    github.com/pkg/errors \
                        lock    v0.9.1 \
                        rmd160  dc065c655f8a24c6519b58f9d1202eb266ecda40 \
                        sha256  208d21a7da574026f68a8c9818fa7c6ede1b514ef9e72dc733b496ddcb7792a6 \
                        size    13422 \
                    github.com/patrickmn/go-cache \
                        lock    v2.1.0 \
                        rmd160  9e869a3bd93bb2c8a59c96afc0d758ce0430df4f \
                        sha256  57bba72974dfe36ff8dc0003c51888746f34be75addbe18a97413d5830103844 \
                        size    13583 \
                    github.com/oschwald/maxminddb-golang \
                        lock    v1.8.0 \
                        rmd160  df12137865d3ed774cfa8a2280fadb1cc3f70666 \
                        sha256  a97543b5273e1ac29ce20cd691d8e7df4e38d320cc3a161ed4773db582fefff5 \
                        size    25015 \
                    github.com/oschwald/geoip2-golang \
                        lock    v1.5.0 \
                        rmd160  b904a315a009ba73d834ec2f843e2fa0e0f9b40f \
                        sha256  4730f81213989b0c32c857b033f5dfe049f664d9959a3c1f8c534183eecd0874 \
                        size    9608 \
                    github.com/onsi/gomega \
                        lock    v1.13.0 \
                        rmd160  dc92bda8de121272ba08a6fd53d305f86af161fb \
                        sha256  84bb470e2662d0243c708df882666f82aa735376b837fa3edecea02ede08efac \
                        size    127847 \
                    github.com/onsi/ginkgo \
                        lock    v1.16.4 \
                        rmd160  e0c7145b2a5a9fa39d1883b7ceb788af8a3dd4db \
                        sha256  1cf29213663b89b7578f41a0185b814dab82d40fb5233bf0fe951591ce32ab10 \
                        size    164059 \
                    github.com/nxadm/tail \
                        lock    v1.4.8 \
                        rmd160  bb6c5515804a1d141478074ba9a4f836fa51fb71 \
                        sha256  a4e98c422980433e9a9830f16b4155836baba4c3e3aa387f03840e5cb608c84d \
                        size    1256274 \
                    github.com/miekg/dns \
                        lock    v1.1.43 \
                        rmd160  e75226f069ef60f98ba1e236740e0cb91d0b477a \
                        sha256  86210f5d727b429c39d9dad8010e91cbbe13de1839257b26b688fc3486e39112 \
                        size    200644 \
                    github.com/mholt/acmez \
                        lock    v1.0.1 \
                        rmd160  ab3fe2e2d17dcfcb2fc71b5eb16f0bbdc672f2b3 \
                        sha256  ad1870df7d0e294529a3f91b6905a4a253ed5a4622ee6b8b79147717cee244ff \
                        size    50757 \
                    github.com/matttproud/golang_protobuf_extensions \
                        lock    v1.0.1 \
                        rmd160  e28c4169919e72c08ee6520ad2ce16943d18e40c \
                        sha256  c40d4c38e7dc2a7bae57e3740bb28d463e173d82e4603622d04d01741ff7a083 \
                        size    37197 \
                    github.com/marten-seemann/qtls-go1-17 \
                        lock    v0.1.0 \
                        rmd160  53d4d3eb6609de0c808934f977288c9bf06b3633 \
                        sha256  c764f1cc401e4e9b61c5e344d9916246962dfc0739b32a66882c6f372758c29a \
                        size    421717 \
                    github.com/marten-seemann/qtls-go1-16 \
                        lock    v0.1.4 \
                        rmd160  1cadd0881456cc0d4dd653b432c06be1e1a1e43e \
                        sha256  6e750d55689b9eeff04ddadd5fd37f57c794f0eb0897622ea318b4b73990261a \
                        size    415570 \
                    github.com/lunixbochs/struc \
                        lock    784aaebc1d40 \
                        rmd160  a9a289f74c01c85c6c272ee3a5a21550c1d65fbf \
                        sha256  7ba956f1055c32b76274641f2af6d9893f732b3bbf6877d2d7e827f4c6ba3ba6 \
                        size    16071 \
                    github.com/libdns/libdns \
                        lock    v0.2.1 \
                        rmd160  7cd2eb2452f9767d17aac199550e8fd4b2076ffb \
                        sha256  66022788fd014e2d6da6ef43eb7360d5adc6d59b635f93f601b3415c6720a9be \
                        size    5833 \
                    github.com/kr/text \
                        lock    v0.1.0 \
                        rmd160  0b3c78459e227170a3b80a0103d87a3eef77ed88 \
                        sha256  5ed970aad0da3cba3cffacdb4d154a162a8968655ee6d6f7b627e71b869efaf6 \
                        size    8691 \
                    github.com/kr/pretty \
                        lock    v0.1.0 \
                        rmd160  9aa7a5aad4c48840eecfd0f80186d1fb5ded0fd6 \
                        sha256  f6c3f89667c63e5b7f1fc6ee2c06b6a6bfdce88f3a965ccd395b64c6f95c9a47 \
                        size    8553 \
                    github.com/klauspost/cpuid \
                        lock    v2.0.9 \
                        rmd160  74b904a37421c1553ab642a54bf2f4c5eee76be0 \
                        sha256  4e7fa18aac1517dfe13b3973210bbc995cb1571506258fc1a667b09f6c5cd383 \
                        size    342181 \
                    github.com/hashicorp/golang-lru \
                        lock    v0.5.4 \
                        rmd160  833d8d87b84f13bc545ecffff9358a19671d185a \
                        sha256  c358bb5050adae91e443f59ff70b7c0ad6906fc4abe1b30066bf0c408fdf9b5c \
                        size    13435 \
                    github.com/google/gopacket \
                        lock    v1.1.19 \
                        rmd160  4f1732d15d1f4057d37f8e8cdb6bbbcbd722cdd2 \
                        sha256  546027e7edd39388cd5a8f265e30ba921ed452889eceaaecbc1484f20b350a21 \
                        size    950824 \
                    github.com/google/go-cmp \
                        lock    v0.5.5 \
                        rmd160  5caef57da3ce09c102ed270168afa2a5200c2c47 \
                        sha256  be284023d91976ef03d13cb5670e338c09a0a0da9925d7de457f44e33aebb724 \
                        size    102365 \
                    github.com/golang/protobuf \
                        lock    v1.5.2 \
                        rmd160  9924f66e6525b49769f4ef61f7196387185b2f9b \
                        sha256  d7b5f7c44e324b3f510fec1b79de20bd8d7537229b23ad7236769cf3974ce0c7 \
                        size    171736 \
                    github.com/golang/mock \
                        lock    v1.6.0 \
                        rmd160  ed853462703f04ce365bb17b8c88a92994aa5006 \
                        sha256  4b107f6d26db03f8a36ae38f7b017399ed56571cdbf7b7ebc7bff0006c7dffb5 \
                        size    69263 \
                    github.com/go-task/slim-sprig \
                        lock    348f09dbbbc0 \
                        rmd160  7cc4d26be51d6fdf2b54b1fd1506b58c58317303 \
                        sha256  94d84e08cdff9c92c5cf526f0ec803f46593247f8e0d4b19b30c9df1819c933d \
                        size    40027 \
                    github.com/fsnotify/fsnotify \
                        lock    v1.5.1 \
                        rmd160  c99fbad44a371ce38eb2bd5c6ef70fb4537952e3 \
                        sha256  699405dfda2fe02a305bee66f58046adb43f426ac905f85d80710e36846b3768 \
                        size    32714 \
                    github.com/eycorsican/go-tun2socks \
                        lock    v1.16.11 \
                        rmd160  52222f7ac946eb96a98e73b0e49932ee46d40d3f \
                        sha256  93c1088d0501554b1f42fd1960f112816258e3801134d048b97ec8e3c5c8b71d \
                        size    510836 \
                    github.com/elazarl/goproxy \
                        lock    a92cc753f88e \
                        rmd160  a77d7a147c486d8d2727cee44548dd875e0f1d91 \
                        sha256  fdb56cf06d0e22acca1b4c2049f1b7bde122f52b18a192e37970eee6d649d1f1 \
                        size    108520 \
                    github.com/davecgh/go-spew \
                        lock    v1.1.1 \
                        rmd160  7c02883aa81f81aca14e13a27fdca9e7fbc136f7 \
                        sha256  e85d6afa83e64962e0d63dd4812971eccf2b9b5445eda93f46a4406f0c177d5f \
                        size    42171 \
                    github.com/cpuguy83/go-md2man \
                        lock    v2.0.0 \
                        rmd160  85f342c341fa928e9ec874490c277bdabf1c39c6 \
                        sha256  2f3f8bc701df4890a5a4baf0b632ad3290be1e0aaf572b2e58fd57df93efc306 \
                        size    52040 \
                    github.com/coreos/go-iptables \
                        lock    v0.6.0 \
                        rmd160  52cfe989de3fbe9a5de0f023a40815a8483ac08d \
                        sha256  94835a306bf2fb23776d1812c80c59903e8c166747da24356758207d88df9c96 \
                        size    16401 \
                    github.com/cheekybits/genny \
                        lock    v1.0.0 \
                        rmd160  c8f3f5af635b83ade08f9f8e08e7f2018cb5879c \
                        sha256  528d149522e053aed14048608751da8ace5b44466038b1a8d47d04a050d81bdc \
                        size    15585 \
                    github.com/cespare/xxhash \
                        lock    v2.1.1 \
                        rmd160  0c0da0840864215209db2afcd2ee92a52ca2d4d1 \
                        sha256  7416baf9eeefe07e3c50c57826d839cdbba125ea0a6d74af378e865df4f25e00 \
                        size    9300 \
                    github.com/caddyserver/certmagic \
                        lock    v0.15.2 \
                        rmd160  46b3abf4c8b3f83541287748d92bd67186a4b7f0 \
                        sha256  dbc375acf5561705ee524d0c4920e2fb4357ac2130e8267a359be138ef904b8d \
                        size    105005 \
                    github.com/beorn7/perks \
                        lock    v1.0.1 \
                        rmd160  c6c5c7fd2132f01925c7fccd9d27c9d7a80f2adb \
                        sha256  78da4421e9f9fa2ee5e3855bdd31cfb04c7e823d9c0ec385cc2c008132d98b96 \
                        size    10874 \
                    github.com/antonfisher/nested-logrus-formatter \
                        lock    v1.3.1 \
                        rmd160  91248818e3653fc7ffbdbd0e055d08faadd68dc4 \
                        sha256  4a9c58325b0249a38600d91d1144b1d2b4fa19969e86c34a621eb7caf10546c2 \
                        size    4692 \
                    github.com/LiamHaworth/go-tproxy \
                        lock    ef7efd7f24ed \
                        rmd160  1e3d72b14f22b21e19668d716efaca4c7ae3871b \
                        sha256  f6d85714a6ce3ae27162a196d9fd16927549c7f4bbadbdea22c78d0494d9d4f0 \
                        size    58431

# Notes for updating this port:
# Replace go.googlesource.com/protobuf with github.com/protocolbuffers/protobuf-go
# Remove entry for github.com/elazarl/goproxy/ext as it's included in github.com/elazarl/goproxy/ext
# Change github.com/tobyxdd/quic-go to github.com/lucas-clemente/quic-go and add original url back as a repo
# Remember to update git commit hash

set time [clock format [clock seconds] -format %Y-%m-%dT%H:%M:%S]
build.args-append   -ldflags=\"-X 'main.appVersion=v${version}' -X 'main.appCommit=${git-commit}' -X 'main.appDate=${time}'\" -o ./hysteria ./cmd

destroot {
    xinstall -m 0755 ${worksrcpath}/${name} ${destroot}${prefix}/bin/
    file mkdir ${destroot}${prefix}/etc/hysteria
    copy ${filespath}/server.json ${filespath}/client.json ${destroot}${prefix}/etc/hysteria/
}

post-activate {
    if {![file exists ${prefix}/etc/hysteria/config.json]} {
        copy ${prefix}/etc/hysteria/client.json ${prefix}/etc/hysteria/config.json
    }
}

notes-append "
    The default config file is copied to ${prefix}/etc/hysteria/config.json and its content\
    will be preserved across upgrades and reinstalls. The startup item will use this config\
    file by default.
"

startupitem.create          yes
startupitem.executable      ${prefix}/bin/hysteria -config ${prefix}/etc/hysteria/config.json
