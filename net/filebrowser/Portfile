# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           golang 1.0

go.setup            github.com/filebrowser/filebrowser 2.15.0 v
set git-commit      73ccbe9
# This line is for displaying commit in CLI only
revision            0
categories          net sysutils
maintainers         {i0ntempest @i0ntempest} openmaintainer
license             Apache-2

description         Web File Browser
long_description    filebrowser provides a file managing interface within a specified directory\
                    and it can be used to upload, delete, preview, rename and edit your files.\
                    It allows the creation of multiple users and each user can have its own directory.\
                    It can be used as a standalone app or as a middleware.

homepage            https://filebrowser.org

checksums           ${distname}${extract.suffix} \
                        rmd160  f08830cfb6161043d6e576dc73cbac5a0c7741b5 \
                        sha256  87fb0688d85b864cd17e3f19e1ba9fc1e97322fbe664efd4aa9620e37842e9e8 \
                        size    3839823

go.vendors          gopkg.in/yaml.v3 \
                        lock    9f266ea9e77c \
                        rmd160  06dca2ede07b2f31c515b4711fbebc1d5359b5e4 \
                        sha256  e70dd42fb30b7b2d0129c5cdf0e079caaf5602cab24081fdac830ec01204fa59 \
                        size    86890 \
                    gopkg.in/yaml.v2 \
                        lock    v2.3.0 \
                        rmd160  2f8fa56d8a413b6288132eeb7f0d7c64d27d877f \
                        sha256  a8d1a8bc88239d25507456380b47d59ae3683d4a5f4336da4892db1ce026615f \
                        size    72838 \
                    gopkg.in/square/go-jose.v2 \
                        lock    v2.2.2 \
                        rmd160  3e9c34d142273f28643018b5cfe9a62b3a6a9f7d \
                        sha256  000fd4c193f598cc9c47d6d92caef080ce56abaac2abd13012f5ca296ee97767 \
                        size    298015 \
                    gopkg.in/natefinch/lumberjack.v2 \
                        lock    v2.0.0 \
                        rmd160  931b7db0e3893f0f6515a8113e7c35aa3e45c9da \
                        sha256  1f7796430424a4dd4c74f73929e7e82384672f6c2c311c5b671e6c36353780f3 \
                        size    12640 \
                    gopkg.in/ini.v1 \
                        lock    v1.51.0 \
                        rmd160  fb3d5484b20da6eee5d89fcf693f9fb94e834d5d \
                        sha256  f7760de2e1e32ed627a3526d3aedafd2c979a40208fdf871fff032e4cb969d98 \
                        size    43548 \
                    gopkg.in/check.v1 \
                        lock    788fd7840127 \
                        rmd160  b63165c8909a27edc15dda210df66a1b49efb49e \
                        sha256  7e5547c6471cc48da89a7c87f965b20ca5311f43fc4d883ca62f9fccf7551630 \
                        size    31597 \
                    google.golang.org/appengine \
                        repo    github.com/golang/appengine \
                        lock    v1.5.0 \
                        rmd160  185aaecc595ad55585f7f5251d39f4579346e058 \
                        sha256  0f0c1e82b054c4f42d355744d26cfabb014097a663abce07a7364456ab36c879 \
                        size    325911 \
                    golang.org/x/text \
                        lock    v0.3.2 \
                        rmd160  3b9523084f6a8b2e6a6987e49c56f05e22ad69eb \
                        sha256  d624899dfd390d9d4a77e5c8e5abd8c45f0b6163e0dc7176aee39f25c5f1bed0 \
                        size    7168458 \
                    golang.org/x/sys \
                        lock    059865788121 \
                        rmd160  6547b831afd7544cf84853c58d6744887e97d4af \
                        sha256  ac404719da5dc2f0fcf63e45e8791173391c13e0b19ce9894d6df664d8e773f2 \
                        size    1052860 \
                    golang.org/x/sync \
                        lock    37e7f081c4d4 \
                        rmd160  b953b5c8caf602ee3be0fd142512a57b00c3e926 \
                        sha256  50c6c5742e6421160fb5bee3355b85afca99a4c3014daa50010997a7ae420556 \
                        size    16231 \
                    golang.org/x/net \
                        lock    3c3fba18258b \
                        rmd160  21038a8a4202f36d2ace229cccf3d6000c8a0384 \
                        sha256  bdcad5102613defd634171b5472411346ee0c4fa14f8f6337a125bf348cb78b0 \
                        size    1177148 \
                    golang.org/x/image \
                        lock    e7c1f5e7dbb8 \
                        rmd160  74f343ffd9cb3a214c9d13d90a612838c6b98a1c \
                        sha256  ec395f8df7c5d4e4f4aca5d5730b69b92647b814675a96d64e0b3c81829f5570 \
                        size    4895807 \
                    golang.org/x/crypto \
                        lock    06a226fb4e37 \
                        rmd160  0f11f7dda23b2dfd20a436eae805e768e7a91b9b \
                        sha256  a9b23e5976f0bc8cea58568726a2c0b5e11e8d213323e0d5dc6f309266431013 \
                        size    1728444 \
                    go.etcd.io/bbolt \
                        repo    github.com/etcd-io/bbolt \
                        lock    v1.3.3 \
                        rmd160  3d6d3bee82de0bf39c68096d4ca4375621f066df \
                        sha256  b3d414235d0d072b5510117ae36cbb90a5f0b26610fe6c308df99fdb513893e6 \
                        size    94670 \
                    github.com/xi2/xz \
                        lock    48954b6210f8 \
                        rmd160  80381ccf17a6eddadd49295e261f99955444f73e \
                        sha256  1019ea65e973ae91d42d31b00514c727bb2057ecae021bf24ac8014465af8b8f \
                        size    1135341 \
                    github.com/vmihailenco/msgpack \
                        lock    v4.0.4 \
                        rmd160  89df770ec853d2f63af382d7ebb109ad43a694cd \
                        sha256  fc5a47cf9572def5c376f25f031722819a218db68dc2c015bcda2398a29dc9a9 \
                        size    26969 \
                    github.com/ulikunitz/xz \
                        lock    v0.5.6 \
                        rmd160  483a0f36e8524101e8c01bd60c5f06150b129c4e \
                        sha256  bfb8744d16dc25991b8747a687e99dca9301c0599b99dce299ff7868798792f1 \
                        size    477469 \
                    github.com/tomasen/realip \
                        lock    f0c99a92ddce \
                        rmd160  9647d37dc83d15756eb5b168b44370311bea8e69 \
                        sha256  9e8bc86441796fe16edf2a271f5cdc6a561c633644efb6d326d65d8aadee29cc \
                        size    3125 \
                    github.com/subosito/gotenv \
                        lock    v1.2.0 \
                        rmd160  359083733ab5db2a09169c8d6d070b03463aef60 \
                        sha256  01fc25c8959371d006a0460132b72710ac120d5400fceebbc1d321d2e9bcd4a0 \
                        size    7375 \
                    github.com/stretchr/testify \
                        lock    v1.6.1 \
                        rmd160  7e5b798212a8f15cd58a63985ae0b928eede8e6b \
                        sha256  44d77d9b5c1dc08fa710eac9bb324898210660458085cdf965b78a39b1010f2a \
                        size    84248 \
                    github.com/spf13/viper \
                        lock    v1.6.1 \
                        rmd160  bf8a4349387e617eed10b437f22b75962b11b5d8 \
                        sha256  deb782ea2ea2f5c36eedf2468720d43968c490cb2f42713fd3b82aba2d71acca \
                        size    51750 \
                    github.com/spf13/pflag \
                        lock    v1.0.5 \
                        rmd160  2ce81608a38c6f383a35bccd24d64361df5828c9 \
                        sha256  7f41acdcba65b1fab5b9b633947a139f9915b60f94bdab486cdbe9d90c54f61e \
                        size    50815 \
                    github.com/spf13/jwalterweatherman \
                        lock    v1.1.0 \
                        rmd160  390db06ec6993dd9479d7fbfeaff1144d4fbc6e9 \
                        sha256  b75cd39c9d41c3f7e147225b3dbcb077d5e7a5688dc441ec15179bb1a4c6b941 \
                        size    6870 \
                    github.com/spf13/cobra \
                        lock    v0.0.5 \
                        rmd160  53e9a05596343a23f3a42bb6bf0d1a740591345d \
                        sha256  9987c8c42db1f7b6e17abb000d23457463bc3f8884c815777f7fbf5e48e6a498 \
                        size    111150 \
                    github.com/spf13/cast \
                        lock    v1.3.0 \
                        rmd160  26b82e9734f643bc70be8c73742d4a4f514b6dd2 \
                        sha256  f2913fc10731a578c016701bd10e6a267c299b94e69d8362d258ce8482d14faf \
                        size    11086 \
                    github.com/spf13/afero \
                        lock    v1.2.2 \
                        rmd160  14c42845beaf4ea85310555ff541c3fd993c2977 \
                        sha256  d14937aa235e66156aab75b2c27085d360d95244214ccfb843cfff771f372317 \
                        size    46167 \
                    github.com/smartystreets/goconvey \
                        lock    v1.6.4 \
                        rmd160  a3dfad6131b94d809efad84d30ce45828c6da756 \
                        sha256  a03963296bb6d031934a651c1e637e8ab2ce9604ce6a16c158ff551e44e7ba79 \
                        size    1478824 \
                    github.com/smartystreets/assertions \
                        lock    b2de0cb4f26d \
                        rmd160  32d7082172ea8c4a03119f3ffb803f8aad9744ce \
                        sha256  469875871db96f87e62f76f0bfc4b3b0b9e4761c2a14d4ce12f246797a7c342c \
                        size    52177 \
                    github.com/pmezard/go-difflib \
                        lock    v1.0.0 \
                        rmd160  fc879bfbdef9e3ff50844def58404e2b5a613ab8 \
                        sha256  7cd492737641847266115f3060489a67f63581e521a8ec51efbc280c33fc991f \
                        size    11409 \
                    github.com/pierrec/lz4 \
                        lock    473cd7ce01a1 \
                        rmd160  61fa331a1cf196cbefaf0328f66ad6acdeb58262 \
                        sha256  1e83202160d8c5ea7138e934ee9f3c7dfddcdc930854ecc65894edebb6a58cf8 \
                        size    7460804 \
                    github.com/pelletier/go-toml \
                        lock    v1.6.0 \
                        rmd160  8ce449abeefeaab912ce6b6e0479a76fd056fefb \
                        sha256  63a97d25dfed5f9a3a5d8c9f98a2e3894e556f31b4232483dedda3cd16348b87 \
                        size    82744 \
                    github.com/nwaples/rardecode \
                        lock    v1.0.0 \
                        rmd160  fa35f6be4ec0d9f80eaf6c3ef49f8171ab316e3c \
                        sha256  8d6aed215556c41edd2c0576b0261e93c6f442fc7c0e4bdf80985882cb5b6b0c \
                        size    34230 \
                    github.com/mitchellh/mapstructure \
                        lock    v1.1.2 \
                        rmd160  a4e01781ea5bb0c987e18e8e450c8f1023d5a857 \
                        sha256  9c1076f5a8e923d028cb65c36143f3b1478cbaa4420e2e8f332719edc2fc4f71 \
                        size    20992 \
                    github.com/mitchellh/go-homedir \
                        lock    v1.1.0 \
                        rmd160  44b3985e40e5bbb22d11f8622c340f9ed727ea91 \
                        sha256  024c8a57316c7fbc0eb23cdbfd57f72a74b51beb83d714034d67ee9aba48100c \
                        size    3366 \
                    github.com/miekg/dns \
                        lock    v1.1.3 \
                        rmd160  7b47ba6134c32571ef030c715e099fce690996f1 \
                        sha256  1a2d04bcd0c1654800f57b9ee28b2fb7187c1d5e82df0df71595db8e8f89754f \
                        size    3881347 \
                    github.com/mholt/certmagic \
                        lock    6a42ef9fe8c2 \
                        rmd160  c232e87b9d7dea825f5c95163a39cb1a2fd64214 \
                        sha256  e1168f5c164b944fe9a50e36d5cd23854011d4879443f5e66590ddc015062e4e \
                        size    66716 \
                    github.com/mholt/archiver \
                        lock    v3.1.1 \
                        rmd160  bfa3e266508101f17166c5381347638d65a98f19 \
                        sha256  bf2dfa27e915ed18ff451ef7a2aab2650840e47197fd7865ac8e36fbd9481d17 \
                        size    42556 \
                    github.com/marusama/semaphore \
                        lock    v2.4.1 \
                        rmd160  794b9e6de5cea51c8f5c6538e9ca398f5c8d9bc7 \
                        sha256  a13e6983ae3e506f2baf695168d2aea9df5ab2497191b60c67653ad5a0f56d98 \
                        size    6802 \
                    github.com/maruel/natural \
                        lock    dbcb3e2e8cf1 \
                        rmd160  d156cb818adf38a283c7ea3f68fefb55886e6219 \
                        sha256  888ddaea535460ebe80bde5294f591b700b9bef59a9871ffd59018617a405121 \
                        size    6179 \
                    github.com/magiconair/properties \
                        lock    v1.8.1 \
                        rmd160  c9768d4c6f488f56d9451cfe00898b00fa185e5a \
                        sha256  ba7ce8c50bdc43c67c5fd97e741ae49c9279c0d42b8e79f978e6e0cd814fec7c \
                        size    29730 \
                    github.com/kr/text \
                        lock    v0.1.0 \
                        rmd160  0b3c78459e227170a3b80a0103d87a3eef77ed88 \
                        sha256  5ed970aad0da3cba3cffacdb4d154a162a8968655ee6d6f7b627e71b869efaf6 \
                        size    8691 \
                    github.com/kr/pretty \
                        lock    v0.1.0 \
                        rmd160  9aa7a5aad4c48840eecfd0f80186d1fb5ded0fd6 \
                        sha256  f6c3f89667c63e5b7f1fc6ee2c06b6a6bfdce88f3a965ccd395b64c6f95c9a47 \
                        size    8553 \
                    github.com/klauspost/cpuid \
                        lock    v1.2.0 \
                        rmd160  43910d3df318a51408fd6823237d39fc6f4f88ce \
                        sha256  816989fc84edbcb2b4cbe6ef6e736661cf4987ce32f2f4e36a698afbe02f9d81 \
                        size    278886 \
                    github.com/jtolds/gls \
                        lock    v4.20.0 \
                        rmd160  31d8656bd6c1426338ceaac9535198244248b254 \
                        sha256  04069406ca336d355eab62b4ab9e84b820ac968ac1e20bd3777efec2d3843446 \
                        size    7305 \
                    github.com/jessevdk/go-flags \
                        lock    v1.4.0 \
                        rmd160  b0c73c434cdc6019a10f27b5ab9bbb2134ae063d \
                        sha256  407533a2bca7c9b49b2ef5860350f0533227335191dc90995ca880091e35b503 \
                        size    55476 \
                    github.com/inconshreveable/mousetrap \
                        lock    v1.0.0 \
                        rmd160  5c617a09f1432fc543672a0e0c1e13d3752030c2 \
                        sha256  0e6bae2849f13d12fe361ecac087728e4e97f3482f4cec44f6e7a2c53bb9cd0c \
                        size    2291 \
                    github.com/hashicorp/hcl \
                        lock    v1.0.0 \
                        rmd160  ad8d0b523bb708fd6ae77df8bb414c103a75aa92 \
                        sha256  4fc0e87ac9d3d6cd042f044df2db2703bed569051fb8c179d505edeb4433e96e \
                        size    70636 \
                    github.com/gorilla/websocket \
                        lock    v1.4.1 \
                        rmd160  fabb50c4c2297eb4485ccc1abb5ead16c239e26f \
                        sha256  79182d9e15e4dbd709c7d360245e25445628e0d111472a9809fc5ba6327af646 \
                        size    54230 \
                    github.com/gorilla/mux \
                        lock    v1.7.3 \
                        rmd160  9f022c499e08caa8fd0053b9620d66b5ff3be4e5 \
                        sha256  5589d13e1fa1705b71e6fae05ee10f435ccf09cec31daacaf1f59c91888c5af0 \
                        size    42508 \
                    github.com/gopherjs/gopherjs \
                        lock    0766667cb4d1 \
                        rmd160  fe92e39110b5c188dcce98abb3b9aa1b64d68f94 \
                        sha256  abe56698d0855027a1f6030a44924895d781b19526aa8f9b3ef49ed4199f7c57 \
                        size    217261 \
                    github.com/google/uuid \
                        lock    v1.1.1 \
                        rmd160  69112e9735ecc1d5360a3cc31531f8be661a007f \
                        sha256  70be7dec37826f2cbe13acfe534ce74cbb2107c1e348eb4e8365f7d900002e40 \
                        size    13552 \
                    github.com/golang/snappy \
                        lock    v0.0.1 \
                        rmd160  a10055b1a93ad290e600742c23156dbd55afe046 \
                        sha256  5ca0dcca007398f298a6386af5d4696faba962b6a625e3aa3961d212078722b8 \
                        size    62627 \
                    github.com/golang/protobuf \
                        lock    v1.3.1 \
                        rmd160  801150957b99de8eef10cb8d5ea2a08b240f2cb5 \
                        sha256  a53c2c8c5c02311d2fa3bc6656614e20f9e5568b87c9f07702f083457e69f7d2 \
                        size    310935 \
                    github.com/golang/geo \
                        lock    673a6f80352d \
                        rmd160  807722be6f541789039a52ac9ff720ee979c9c06 \
                        sha256  89044cb458bbddeea88f71a8f2e366adb39326239bce160e77698dbd0763825a \
                        size    367519 \
                    github.com/go-errors/errors \
                        lock    v1.1.1 \
                        rmd160  e5347710bd07ef59f4877070fe27b7d959b3a014 \
                        sha256  3c4bf9b862e447a39c8d99f7b53420132c56306afc04830d3f66e33a015807cf \
                        size    9337 \
                    github.com/go-acme/lego \
                        lock    v2.5.0 \
                        rmd160  b31baf8d23c87c4d85273c2698cad4b9c1974f75 \
                        sha256  c28fc4eba3d63f4935c37faf82d354b0abec2c9220e26e02b22c1cec2acc51ea \
                        size    4980013 \
                    github.com/fsnotify/fsnotify \
                        lock    v1.4.7 \
                        rmd160  24712e412814020224e2779186e634610e2f6926 \
                        sha256  bc839ee158ad34b81c1f11c3b9e3bcbabfba3297f61d165599880c400b8171dc \
                        size    31147 \
                    github.com/flynn/go-shlex \
                        lock    3f9db97f8568 \
                        rmd160  ec42eaffe2cf17a46e12c7c2a7d436c0f68ba655 \
                        sha256  b4205ec400df652238f7ed287c4b77b5f17a17d5793cd5371b7cc5e0f07dfeed \
                        size    7690 \
                    github.com/dsoprea/go-utility \
                        lock    2fccff4aa15e \
                        rmd160  2947b0bd26ede51826af5d68b96a321ad7f9036a \
                        sha256  782fe3c07c910ef0d76b7fe2647ed6a410e657605c4ec543fe8313d7ed3931ec \
                        size    53114 \
                    github.com/dsoprea/go-logging \
                        lock    a10564966e9d \
                        rmd160  ba9725e0d4ea03d935f73a14fcec41360d5375ec \
                        sha256  4df16d855e071a736c1736efc3f90f85ff401db3f9bed8dcd8125356179443b5 \
                        size    11173 \
                    github.com/dsoprea/go-exif \
                        lock    db167117f483 \
                        rmd160  2f28b938c1712b05793fe29a4cbe70348f09581d \
                        sha256  a916db4ad16eb3693942be20524c0e6dd7849089c10599bc5bbeaf7361f34e98 \
                        size    28369564 \
                    github.com/dsnet/compress \
                        lock    v0.0.1 \
                        rmd160  44a9ba6d99a11d15815c3600f997b48abfec5bd5 \
                        sha256  42eac045c3c85d633e26d3dfdf62ff0a2c7b970397baaa0de85f5de783489705 \
                        size    9963201 \
                    github.com/disintegration/imaging \
                        lock    v1.6.2 \
                        rmd160  eb7fc30603404bee955019c2a1a5f717bc784f89 \
                        sha256  69d5d90553fd187844d8ef4a8d89da9a6c9c1ec29402b44521aaa85640d0b83f \
                        size    2212673 \
                    github.com/dgrijalva/jwt-go \
                        lock    v3.2.0 \
                        rmd160  7441af83a55ddda618b3d1f813bfc9e2feaad17f \
                        sha256  de52f4d01154b4fdaf32dedb5f98de6ea19f3ad69307f388a5b8a562a8948078 \
                        size    36979 \
                    github.com/davecgh/go-spew \
                        lock    v1.1.1 \
                        rmd160  7c02883aa81f81aca14e13a27fdca9e7fbc136f7 \
                        sha256  e85d6afa83e64962e0d63dd4812971eccf2b9b5445eda93f46a4406f0c177d5f \
                        size    42171 \
                    github.com/cenkalti/backoff \
                        lock    v2.1.1 \
                        rmd160  1b900320d807e5b76aa20f1e488aebc2d798e0a5 \
                        sha256  8d5ccbac89e79859e9b4dfa7750c4547f34e52a3748d2d264ef0e4b9d9808614 \
                        size    8637 \
                    github.com/caddyserver/caddy \
                        lock    v1.0.3 \
                        rmd160  315ce525d45aa4afad859e7e479beffc1bfbd70c \
                        sha256  a64cbf24ecd0b6807dbf6171b73d545fd4f527199967ce5763ce40bf58da2ee6 \
                        size    381865 \
                    github.com/asdine/storm \
                        lock    v2.1.2 \
                        rmd160  504da99b3526b98ecc51d019efdab428b1f18e95 \
                        sha256  fb16cf75353b095bddc9d17373e0ca539b4561c3fc6527bd31d5058ed416f246 \
                        size    44028 \
                    github.com/Sereal/Sereal \
                        lock    6faf9605eb56 \
                        rmd160  987ebed42c8e90941e7ca90fa1c23df36fa9100f \
                        sha256  5f477c759abbb0d30c626f2403503d7a580b7bf937e947de860c916d11d90b3a \
                        size    2372296 \
                    github.com/DataDog/zstd \
                        lock    v1.4.0 \
                        rmd160  53e6264eca88e1d3d049f447028082589477598a \
                        sha256  385bcd480eaf96b8238ad32424db4fc57e7feff64b531a854ea8202cf2e3adfd \
                        size    494159 \
                    github.com/BurntSushi/toml \
                        lock    v0.3.1 \
                        rmd160  fb9650e2d16525153645e5547626f242f3800149 \
                        sha256  8cc9e5dc68e247554227973d0b4e023b27bbd9ba5a26e4fb40f44743afcb35f1 \
                        size    42087
# Notes for updating this port:
# You might need to manually change checksums for github.com/jtolds/gls
# Remember to update git commit hash

depends_build-append \
                     port:npm7

build.args-append   -ldflags=\"-X 'github.com/filebrowser/filebrowser/version.Version=${version}' -X 'github.com/filebrowser/filebrowser/version.CommitSHA=${git-commit}'\"

pre-build {
    system -W ${worksrcpath}/frontend "${prefix}/bin/npm --verbose ci && ${prefix}/bin/npm --verbose run build"
}

destroot {
    xinstall -m 0755 ${worksrcpath}/${name} ${destroot}${prefix}/bin/
    file mkdir ${destroot}${prefix}/etc/filebrowser/
    copy ${filespath}/config.json ${destroot}${prefix}/etc/filebrowser/config.json.example
    reinplace "s|@@PREFIX@@|${prefix}|g" ${destroot}${prefix}/etc/filebrowser/config.json.example
}

post-activate {
    if {![file exists ${prefix}/etc/filebrowser/config.json]} {
        copy ${prefix}/etc/filebrowser/config.json.example ${prefix}/etc/filebrowser/config.json
    }
}

startupitem.create          yes
startupitem.executable      ${prefix}/bin/filebrowser --config ${prefix}/etc/filebrowser/config.json

notes-append "
    The example config file is copied to ${prefix}/etc/filebrowser/config.json and its content\
    will be preserved across upgrades and reinstalls. This config file configures filebrowser\
    to use /var/empty as root by default for safty reasons, so modify it before using. The\
    startup item will use this config file by default.\
    
    The default login and password for the Web UI is admin and admin. Change this as soon as\
    you can.
"
