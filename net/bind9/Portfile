# $Id: Portfile,v 1.8 2004/11/07 01:03:19 jkh Exp $

PortSystem 1.0
name			bind9
version			9.2.2-P3
revision		1
categories		net
maintainers		bchesneau@mac.com
description		Domain Name System server
homepage		http://www.isc.org
long_description  	The BIND DNS Server is used on the vast majority of name serving machines on the Internet, providing a robust and stable architecture on top of which an organization's naming architecture can be built.  The resolver library included in the BIND distribution provides the standard APIs for translation between domain names and Internet addresses and is intended to be linked with applications requiring name service.

platforms		darwin freebsd
master_sites		isc:${portname}/${version}
distname		bind-${version}
worksrcdir		bind-${version}
checksums		md5 bb2097d4632991d2cc6d8db8aaf8e5d3
depends_run path:/Library/StartupItems/DarwinPortsStartup:DarwinPortsStartup


configure.args		--mandir=${prefix}/share/man --localstatedir=${prefix}/var --enable-libbind

post-destroot	{
	file mkdir ${destroot}${prefix}/etc/rc.d/
	file mkdir ${destroot}${prefix}/var/run/
	file mkdir ${destroot}${prefix}/var/named/
	
	system "install -o root -m 755 -c ${portpath}/files/bind.sh ${destroot}${prefix}/etc/rc.d/"
	reinplace "s|%%PREFIX%%|${prefix}|g" ${destroot}${prefix}/etc/rc.d/bind.sh

	system "install -o root -m 755 -c ${portpath}/files/named.conf ${destroot}${prefix}/etc/"
	reinplace "s|%%PREFIX%%|${prefix}|g" ${destroot}${prefix}/etc/named.conf
	
	system "install -o root -m 755 -c ${portpath}/files/db.* ${destroot}${prefix}/var/named/"
	destroot.keepdirs ${destroot}${prefix}/var/run
}


variant darwin {
        depends_lib-append      lib:libdl:dlcompat
}

variant ipv6 {
	configure.args-append 	--enable-ipv6
}

variant ssl {
	depends_lib-append      lib:libssl.0.9:openssl
	configure.args-append	--with-openssl
}	 	
