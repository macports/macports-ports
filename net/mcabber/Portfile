# $Id$

PortSystem          1.0

name                mcabber
version             0.9.6
categories          net
maintainers         hitzemann.org:simon
description         Console Jabber client
long_description    \
    mcabber is a small Jabber console client. It includes features like \
    SSL, MUC, history logging, command completion, OpenPGP encryption, \
    OTR and external action triggers.
homepage            http://www.lilotux.net/~mikael/mcabber/
platforms           darwin
master_sites        http://www.lilotux.net/~mikael/mcabber/files/
extract.suffix      .tar.bz2
use_bzip2           yes
checksums           md5 b3dc7d38f235b701a82a4926ea3caf91 \
                    sha1 7aa87943cce3e7c2cd42fe74960b53a0cd240331 \
                    rmd160 ac349286dbc2a9129e3601316532eb7ab1ba9e7b

depends_lib          lib:libgpgme:gpgme \
                     port:libiconv \
                     port:ncursesw \
                     port:glib2 \
                     port:gettext \
                     port:libotr

depends_build        bin:gawk:gawk \
                     bin:pkg-config:pkgconfig \
                     bin:gpgme-config:gpgme \
                     bin:gcrypt-config:libgcrypt

configure.args      --prefix=${prefix} \
                    --enable-otr \
                    --with-libotr-prefix=${prefix}/lib \
                    --with-libotr-inc-prefix=${prefix}/include \
                    --without-ssl \
                    --without-openssl

configure.env       LIBTOOL=glibtool

#TODO
#Check why I get errors during linking, until then keep disabled
#variant gnutls {
#                    configure.args-delete --without-ssl
#                    configure.args-append --with-ssl
#                    configure.args-append --with-libgnutls-extra-prefix=${prefix}
#                    depends_lib-append port:gnutls
#               }

variant ssl \
description "Use OpenSSL" {
                    configure.args-delete --without-ssl
                    configure.args-delete --without-openssl
                    configure.args-append --with-ssl
                    configure.args-append --with-openssl=${prefix}
                    depends_lib-append port:openssl
               }

variant aspell \
description "Use aspell spell checking" {
                    configure.args-append --enable-aspell
                    depends_lib-append port:aspell
               }

post-configure {
                    reinplace "s|#define HAVE_LOCALCHARSET_H 1|\/\* #undef HAVE_LOCALCHARSET_H \*\/|g" ${worksrcpath}/config.h
               }
