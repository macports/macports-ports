# $Id$

PortSystem 1.0
name                lftp
version             3.5.11
categories          net
maintainers         yeled@macports.org
description         Sophisticated file transfer program
long_description    LFTP is a shell-like command line ftp client. \
                    It is reliable: can retry operations and does reget \
                    automatically. It can do several transfers simultaneously \
                    in background. You can start a transfer in background and \
                    continue browsing the ftp site or another one. This all is \
                    done in one process. Background jobs will be completed in \
                    nohup mode if you exit or close modem connection. Lftp has \
                    reput, mirror, reverse mirror among its features.
homepage            http://lftp.yar.ru/
platforms           darwin 

depends_lib         port:expat port:libiconv port:ncurses port:openssl \
                    port:readline

master_sites        ftp://lftp.yar.ru/lftp/ \
                    ftp://lftp.yar.ru/lftp/old/ \
                    ftp://ftp.wiretapped.net/pub/mirrors/${name}/ \
                    ftp://ftp.wiretapped.net/pub/mirrors/${name}/old/ \
                    ftp://ftp.cs.tu-berlin.de/pub/net/ftp/${name}/ \
                    http://ftp.yars.free.net/pub/source/${name}/
use_bzip2           yes
checksums           md5 a1691cc0b6f0045a61e9f3d4f668fe13 \
                    sha1 d9a3add50667cbdf98ee765d521b77f628612c0d \
                    rmd160 a8c905073fcf13d50af11357662271985abcd220

configure.env   CPPFLAGS="-I${prefix}/include" \
                LDFLAGS="-L${prefix}/lib"

configure.args  --with-openssl --without-gnutls --disable-nls

pre-configure {
    # look for ncurses first
    reinplace "s|curses ncurses|ncurses curses|g" ${worksrcpath}/configure
}

post-destroot { xinstall -d ${destroot}${prefix}/share/doc/${name}
                xinstall -m 644 -v -W ${worksrcpath} \
                BUGS ChangeLog COPYING FAQ FEATURES NEWS \
                README README.debug-levels README.modules \
                MIRRORS THANKS TODO \
                ${destroot}${prefix}/share/doc/${name}
}

variant tls {
    configure.args-append --without-openssl --with-gnutls
    configure.args-delete --with-openssl --without-gnutls
    depends_lib-append port:gnutls
    depends_lib-delete port:openssl
}

variant nls {
    patchfiles patch-po-Makefile.in.in
    configure.args-append --enable-nls
    configure.args-delete --disable-nls
    depends_lib-append port:gettext
}
