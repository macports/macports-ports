# $Id: Portfile,v 1.2 2003/08/05 09:29:27 jkh Exp $

PortSystem 1.0
name		throttled
version		0.2.9
categories	net
maintainers	mail@mweissmann.de
description	network bandwidth throttle
long_description	throttled is a bandwidth throttle for Mac OS X, \
			FreeBSD, and Linux which allows you to put a cap on \
			your upstream bandwidth and keep your download speeds \
			high even when your server is sending out at full speed.

homepage	http://www.intrarts.com/throttled.html
master_sites	http://www.intrarts.com/Files/
distname        ${name}${version}
patch_sites	http://wwwcip.informatik.uni-erlangen.de/~simrweis/dports/throttled
patchfiles	throttledStartup.diff
checksums	${distfiles} md5 ed05b43f4a4584ca5c821ab40e07cac2 \
		${patchfiles} md5 d19214ef84d029a63200ed54ad7f7bd9

depends_run	path:/Library/StartupItems/DarwinPortsStartup:DarwinPortsStartup

platforms	darwin freebsd

pre-patch	{ system "cd ${workpath} && mv ${name}\\ ${version} ${name}${version}" }

configure	{ reinplace "s|/usr/local/sbin/|${prefix}/sbin/|g" \
			${worksrcpath}/throttledStartup/throttledStartup \
			${worksrcpath}/throttled-startup }

build.target
build.dir	${worksrcpath}/src

destroot.cmd	true

post-destroot	{ system "install -m 755 ${worksrcpath}/src/throttled \
				${destroot}${prefix}/sbin \
		&& install -v -d ${destroot}${prefix}/etc/rc.d \
		&& install -v -d ${destroot}${prefix}/share/doc/throttled \
		&& install -m 755 ${worksrcpath}/throttledStartup/throttledStartup \
				${destroot}${prefix}/etc/rc.d/throttled.sh \
		&& install -m 755 ${worksrcpath}/throttled-startup \
				${destroot}${prefix}/sbin \
		&& install -m 644 ${worksrcpath}/README.txt \
				${destroot}${prefix}/share/doc/throttled \
		&& install -m 644 ${worksrcpath}/COPYING.txt \
				${destroot}${prefix}/share/doc/throttled" }

variant darwin {
        extract.post_args       | gnutar x
}
variant freebsd {
        extract.post_args       | gtar x
}
