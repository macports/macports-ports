# $Id$

PortSystem 1.0
name			openmotif
version			2.3.0
revision		1
categories		x11
maintainers		nomaintainer@macports.org
description		The Open Motif toolkit for X11
long_description	\
                This is The Open Group's full version of Motif based on \
				the original OSF sources.
platforms		darwin
homepage		http://www.motifzone.net/
master_sites	ftp://ftp.ics.com/openmotif/2.3/2.3.0/
checksums		md5 99d0ecb84d3504da421021a19ff70500
fetch.use_epsv  no

# They updated the distfile from 2.3.0 beta to 2.3.0 final without changing
# the distfile's name! Remove this when updating to 2.3.1 or whatever's next.
dist_subdir		${name}/2.3.0-final

depends_build	lib:libX11.6:XFree86
depends_lib		port:jpeg port:libpng port:Xft2 port:expat port:fontconfig \
				port:freetype port:libiconv port:xrender port:zlib

worksrcdir		${name}-2.3.0

post-patch {
	reinplace "s|iconv_open|libiconv_open|g" ${worksrcpath}/configure
	reinplace "s|LDFLAGS = -version-info @CURRENT@:@REVISION@:@AGE@|LDFLAGS = -version-info @CURRENT@:@REVISION@:@AGE@ @LDFLAGS@|" \
		  ${worksrcpath}/lib/Xm/Makefile.in
}

configure.args	--mandir=${prefix}/share/man
configure.env	CFLAGS=-I${prefix}/include CPPFLAGS=-I${prefix}/include \
				LDFLAGS=-L${prefix}/lib

build.env	LANG=C

platform darwin 7 {
    patchfiles-append patch-freetype
}

platform darwin 8 {
	configure.env-append CC=/usr/bin/gcc-4.0 CPP=/usr/bin/cpp-4.0 CXX=/usr/bin/g++-4.0
}

