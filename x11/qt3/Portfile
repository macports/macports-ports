# $Id: Portfile,v 1.29 2005/01/19 19:23:49 rshaw Exp $

PortSystem 1.0
name		qt3
version		3.1.2
revision	5
categories	x11
maintainers	rshaw@opendarwin.org
description	Qt Tool Kit
long_description	Qt 3 is a multiplatform C++ application development framework.
homepage	http://www.trolltech.com/products/qt/index.html
platforms	darwin
master_sites	ftp://ftp.trolltech.com/qt/source/
distname	qt-x11-free-${portversion}
extract.suffix	.tar.bz2
use_bzip2	yes

depends_lib	lib:libGL.1:XFree86 lib:libX11.6:XFree86 \
		lib:libfreetype.6:XFree86 lib:libpng.3:libpng \
		lib:libjpeg.62:jpeg
checksums	qt-x11-free-3.1.2.tar.bz2 md5 156591717687799c69cf3f8b64a898f2

platform darwin 6	{	depends_lib-append	lib:libdl:dlcompat }

variant mysql {
		depends_lib-append lib:libmysqlclient.10:mysql
		configure.args-append -qt-sql-mysql -L${prefix}/lib/mysql -I${prefix}/include/mysql -plugin-sql-mysql
}

variant odbc {
		depends_lib-append lib:libodbc.1:unixODBC
		configure.args-append -qt-sql-odbc -L${prefix}/lib -I${prefix}/include -plugin-sql-odbc
}

variant psql {
		depends_lib-append lib:libpq.2:postgresql
		configure.args-append -qt-sql-psql -plugin-sql-psql
}

variant cups {
		depends_build-append path:${prefix}/include/cups/cups.h:cups-headers
		configure.args-append -cups
}

variant puredarwin {
		configure.args-append -puredarwin
}

set env(PATH) "/usr/X11R6/bin:$env(PATH):${prefix}/bin"

configure.cmd   sh ${portpath}/${filesdir}/qt-configure.sh
configure.env	\
		CFLAGS='-I${prefix}/include' \
		CPPFLAGS='-I${prefix}/include' \
		DYLD_LIBRARY_PATH='/usr/X11R6/lib:${worksrcpath}/lib:${prefix}/lib' \
		INSTALL_ROOT='' \
		INSTALLPREFIX='${prefix}' \
		LDFLAGS='-L/usr/X11R6/lib -L. -L${worksrcpath}/lib -L${prefix}/lib' \
		QMAKESPEC='${worksrcpath}/mkspecs/darwin-g++' \
		QTDIR='${worksrcpath}' \
		worksrcpath='${worksrcpath}' \
		prefix='${prefix}' \
		portname='${portname}'

build.env	${configure.env}
build.target	INSTALLPREFIX="${prefix}" SINGLE_MODULE="-single_module" symlinks src-qmake src-moc sub-src sub-tools
destroot.cmd	sh ${portpath}/${filesdir}/qt-install.sh
destroot.args	PREFIX="${prefix}" VERSION="${version}"
destroot.destdir	DESTROOT="${destroot}"
destroot.target

long_description This is Qt, TrollTech's C++ toolkit for writing \
cross-platform GUI applications.
