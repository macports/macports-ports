# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:et:sw=4:ts=4:sts=4
# $Id$

PortSystem 1.0

name         xorg-cf-files
version      1.0.3
categories   x11 devel
platforms    darwin
maintainers  mcalhoun openmaintainer

description       Build files for discontinued imake build system.
long_description  ${description}

homepage http://xorg.freedesktop.org
master_sites \
    http://xorg.freedesktop.org/archive/individual/util

use_bzip2 yes

#only text files are installed
if {[info exists supported_archs]} {
    supported_archs noarch
} else {
    universal_variant no
}

patchfiles 64bit.patch
patch.args -p1

checksums           md5     10546b5ddda3cdda7950bb56bf98e0ea \
                    sha1    0c63edf6ceeb78fe32dd88bfce8d71c85e311bb0 \
                    rmd160  de867edf4ea02da7fdb45a206076daa96c034029

post-configure {
    #ensure that configuration files are found
    reinplace "s|#define ConfigDir \$(LIBDIR)/config|#define ConfigDir ${prefix}/lib/X11/config|" ${worksrcpath}/X11.tmpl
    reinplace "s|#define XAppLoadDir \$(LIBDIR)/app-defaults|#define XAppLoadDir ${prefix}/share/X11/app-defaults|" ${worksrcpath}/X11.tmpl

    #ensure correct compilers are used
    reinplace -E s|/usr/bin/cpp\$|${configure.cpp}|g ${worksrcpath}/darwin.cf
    reinplace s|/usr/bin/cc|${configure.cc}|g ${worksrcpath}/darwin.cf
    reinplace s|/usr/bin/c++|${configure.cxx}|g ${worksrcpath}/darwin.cf
    reinplace s|/usr/X11|${prefix}| ${worksrcpath}/site.def 
}

livecheck.type   regex
livecheck.url    "http://xorg.freedesktop.org/archive/individual/util/?C=M;O=D"
livecheck.regex  ${name}-(\\d+(?:\\.\\d+)*)
