# $Id: Portfile,v 1.29 2005/07/24 22:50:52 landonf Exp $

PortSystem		1.0
name			tk
version			8.4.11
revision		2
categories		x11
maintainers		landonf@opendarwin.org
description		Tcl Tool Kit
long_description	This is Tk version ${version}, a GUI toolkit for Tcl. \
			The best way to get started with Tcl is to read \
			``Tcl and the Tk Toolkit'' by John K. Ousterhout, \
			Addison-Wesley, ISBN 0-201-63337-X.	
platforms		darwin
master_sites		sourceforge:tcl
dist_subdir		tcltk
distname		${name}${version}-src
worksrcdir		${name}${version}/unix
checksums		${distname}${extract.suffix} md5 408e34fe8a1cec497f98f05bbe89b348
# suck in Tcl as well so we can use it internally.
distfiles-append	tcl${version}-src${extract.suffix}
checksums-append	tcl${version}-src${extract.suffix} md5 629dfea34e4087eb4683f834060abb63
destroot.destdir	INSTALL_ROOT=${destroot}
configure.args		--mandir=${prefix}/share/man --with-tcl=${prefix}/lib
# force usage of DP Tcl
depends_lib		port:tcl lib:libX11.6:XFree86

configure.env		CFLAGS=-I${worksrcpath}/../../tcl${version}/generic

variant macosx {
	configure.args-append	--enable-aqua
}

post-patch {
	reinplace s|@TCL_SRC_DIR@|${worksrcpath}/../../tcl${version}/|g ${worksrcpath}/Makefile.in
}

post-destroot {
	cd ${destroot}${prefix}/bin
	system "ln -s ${prefix}/bin/wish8.4 wish"
	cd ${destroot}${prefix}/lib
	system "ln -s ${prefix}/lib/libtk8.4.dylib libtk.dylib"
}
