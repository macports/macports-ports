# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:filetype=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           github 1.0

name                fontforge
github.setup        fontforge fontforge 20190801
revision            0
github.tarball_from releases

distname            ${name}-${version}
categories          graphics fonts
platforms           darwin
maintainers         nomaintainer
license             BSD
description         Outline and bitmap font editor/converter for many formats

long_description    FontForge allows you to edit outline and bitmap fonts.  You may create \
                    new ones or modify old ones.  It is also a format converter and can \
                    interconvert between PostScript (ascii & binary Type1, some Type3, \
                    some Type0), TrueType, OpenType (Type2), CID, SVG.  Previously known as \
                    pfaedit.

homepage            http://fontforge.github.io/

checksums           rmd160  1b8e8ba52dc35034e250c0b2cd9c4acef01794f2 \
                    sha256  d92075ca783c97dc68433b1ed629b9054a4b4c74ac64c54ced7f691540f70852 \
                    size    20766334

depends_build       port:pkgconfig

depends_lib         path:lib/pkgconfig/cairo.pc:cairo \
                    port:readline \
                    port:freetype \
                    port:gettext \
                    port:giflib \
                    port:jpeg \
                    port:libiconv \
                    port:libpng \
                    port:libspiro \
                    port:libuninameslist \
                    port:libxml2 \
                    path:lib/pkgconfig/pango.pc:pango \
                    port:potrace \
                    port:tiff \
                    port:woff2 \
                    port:zlib

configure.args      --mandir=${prefix}/share/man \
                    --disable-python-scripting \
                    --disable-python-extension \
                    --without-x \
                    --enable-woff2 \
                    --disable-silent-rules

configure.ldflags-append \
                    -lintl

variant python37 description {Enable Python support (Python 3.7)} {
    depends_lib-append      port:python37
    configure.args-delete   --disable-python-scripting \
                            --disable-python-extension
    configure.python        ${prefix}/bin/python3.7
    configure.pkg_config_path \
                            "${frameworks_dir}/Python.framework/Versions/3.7/lib/pkgconfig"
}

variant gui description {Enable GUI support} {
    depends_lib-append      port:xorg-libXi
    configure.args-replace  --without-x --with-x
}

post-destroot {
    delete ${destroot}${prefix}/share/fontforge/osx/FontForge.app
}

notes "
macOS app bundles are available here:

    https://dl.bintray.com/fontforge/fontforge/
"

if {[variant_isset gui]} {
    notes-append "
To make the GUI work, you have to open a font when launching fontforge for the\
first time, e.g.:

    ${prefix}/bin/fontforge some-font-file.otf
"
}

default_variants    +python27
