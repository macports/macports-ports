package require port 1.0
portname	jpeg
portversion	6b 
categories	graphics
maintainers	eric@opendarwin.org
distname	jpegsrc.v6b
worksrcdir	${portname}-${portversion}
description	Library for manipulating JPEG images
master_sites	http://www.ijg.org/files/
checksums	md5 dbd5f3b47ed13132f04c685d608a7547
set libver	9
post-build	{ cd ${workpath}/${worksrcdir}
		  system "cc -dynamiclib -install_name \
		  ${prefix}/lib/libjpeg.${libver}.dylib -compatibility_version \
		  ${libver} jcapimin.o jcapistd.o jccoefct.o jccolor.o \
		  jcdctmgr.o jchuff.o jcinit.o jcmainct.o jcmarker.o \
		  jcmaster.o jcomapi.o jcparam.o jcphuff.o jcprepct.o \
		  jcsample.o jctrans.o jdapimin.o jdapistd.o jdatadst.o \
		  jdatasrc.o jdcoefct.o jdcolor.o jddctmgr.o jdhuff.o \
		  jdinput.o jdmainct.o jdmarker.o jdmaster.o jdmerge.o \
		  jdphuff.o jdpostct.o jdsample.o jdtrans.o jerror.o \
		  jfdctflt.o jfdctfst.o jfdctint.o jidctflt.o jidctfst.o \
		  jidctint.o jidctred.o jquant1.o jquant2.o jutils.o \
		  jmemmgr.o jmemnobs.o -o libjpeg.${libver}.dylib" }

pre-install	{ system "install -o root -m 755 -d ${prefix}/bin"
		  system "install -o root -m 755 -d ${prefix}/man/man1"
		  system "install -o root -m 755 -d ${prefix}/include"
		  system "install -o root -m 755 -d ${prefix}/lib" }

make.target.install	install install-lib

post-install	{ cd ${workpath}/${worksrcdir}
		  system "install -o root -m 644 -c libjpeg.${libver}.dylib \
		  ${prefix}/lib"
		  system "ln -sf libjpeg.${libver}.dylib \
		  ${prefix}/lib/libjpeg.dylib" }

contents	bin/cjpeg \
		bin/djpeg \
		bin/jpegtran \
		bin/rdjpgcom \
		bin/wrjpgcom \
		man/man1/cjpeg.1 \
		man/man1/djpeg.1 \
		man/man1/jpegtran.1 \
		man/man1/rdjpgcom.1 \
		man/man1/wrjpgcom.1 \
		include/jconfig.h \
		include/jpeglib.h \
		include/jmorecfg.h \
		include/jerror.h \
		lib/libjpeg.9.dylib \
		lib/libjpeg.a \
		lib/libjpeg.dylib
