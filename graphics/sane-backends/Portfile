# $Id$

PortSystem                  1.0

name                        sane-backends
version                     1.0.21
categories                  graphics
platforms                   darwin
maintainers                 gmail.com:aguynamedryan+sane
homepage                    http://www.sane-project.org/

description                 Backends for scanner access

long_description            These are the backends for the Scanner Access Now \
                            Easy project. They allow you to access various \
                            scanners either locally or remote using saned.

master_sites                ftp://ftp.sane-project.org/pub/sane/${distname}/ \
                            ftp://ftp.sane-project.org/pub/sane/old-versions/${distname}/

checksums                   md5     be586a23633949cf2ecf0c9c6d769130 \
                            sha1    4a2789ea9dae1ece090d016abd14b0f2450d9bdb \
                            rmd160  000ae42ffd6484c54389a9468bdde1dcfc758dde

depends_lib                 port:jpeg \
                            port:libusb-compat \
                            port:tiff \
                            port:zlib

patchfiles                  patch-configure.diff

configure.cppflags-append   -no-cpp-precomp \
                            -fno-common

configure.args              --mandir=${prefix}/share/man \
                            --with-docdir=${prefix}/share/doc/${name} \
                            --enable-local-backends \
                            --enable-libusb \
                            --without-gphoto2

use_parallel_build          yes

pre-destroot {
    xinstall -d -o root -g admin -m 775 ${destroot}${prefix}/var/lock
}

destroot.keepdirs ${destroot}${prefix}/var/lock

variant disable_localbackends conflicts enable_pnmbackend with_gphoto2 description "turn off compilation of all backends but net" {
    depends_lib-delete      port:libusb-compat
    configure.args-delete   --enable-local-backends --enable-libusb
    configure.args-append   --disable-local-backends --disable-libusb
}

variant enable_pnmbackend conflicts disable_localbackends description "enable the pnm backend for testing frontends (possible security risk, see PROBLEMS file)" {
    configure.args-append   --enable-pnm-backend
}

variant with_gphoto2 conflicts disable_localbackends description "include the gphoto2 backend" {
    depends_lib-append      port:libexif \
                            port:libgphoto2 \
                            port:pkgconfig
    configure.args-delete   --without-gphoto2
    configure.args-append   --with-gphoto2
}

livecheck.type              regex
livecheck.url               ftp://ftp.sane-project.org/pub/sane/
livecheck.regex             "${name}-(\\d+(?:\\.\\d+)*)"
