# -*- coding: utf-8; mode: tcl; tab-width: 4; truncate-lines: t; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:et:sw=4:ts=4:sts=4
# $Id$

PortSystem 1.0
PortGroup  muniversal 1.0
PortGroup  xcodeversion 1.0

name		tiff
version		3.9.2
revision	3
categories	graphics
maintainers	waqar
description	Library and tools for dealing with Tag Image File Format
long_description \
	This software provides support for the Tag Image File 		\
	Format (TIFF), a widely used format for storing image 		\
	data.  Included in this software distribution is a 		\
	library, libtiff, for reading and writing TIFF, a small 	\
	collection of tools for doing simple manipulations of 		\
	TIFF images on UNIX systems, documentation on the library 	\
	and tools.  A small assortment of TIFF-related software 	\
	for UNIX that has been contributed by others is also 		\
	included.  The library is capable of dealing with images 	\
	that are written to follow the 5.0 or 6.0 TIFF spec. 		\
	There is also considerable support for some of the more 	\
	esoteric portions of the 6.0 TIFF spec.
homepage	http://www.remotesensing.org/libtiff
platforms	darwin
master_sites	ftp://ftp.remotesensing.org/pub/libtiff/ \
		http://dl.maptools.org/dl/libtiff/ \
		freebsd

checksums           md5     93e56e421679c591de7552db13384cb8 \
                    sha1    5c054d31e350e53102221b7760c3700cf70b4327 \
                    rmd160  22716e0bcee93a654a704900f3e19f41600f3d18

# Turn on OpenGL with --with-apple-opengl-framework.
patchfiles      patch-configure.diff

depends_lib	port:jpeg port:zlib

test.run        yes
test.target     check

configure.args	--disable-jbig \
		--mandir=${prefix}/share/man \
                --with-docdir=${prefix}/share/doc/${name}-${version} \
		--with-jpeg-include-dir=${prefix}/include \
		--with-jpeg-lib-dir=${prefix}/lib \
		--with-zlib-include-dir=${prefix}/include \
		--with-zlib-lib-dir=${prefix}/lib

use_parallel_build  yes

post-destroot {
	xinstall -m 755 -d ${destroot}${prefix}/share/doc/${name}
	file copy ${worksrcpath}/html/images \
		${destroot}${prefix}/share/doc/${name}
	eval xinstall -m 644 [glob ${worksrcpath}/html/*.html] \
		${destroot}${prefix}/share/doc/${name}
}

platform macosx {
    if { ![variant_isset universal] } {
        configure.args-append   --with-apple-opengl-framework
    } else {
        # Tiger does not have 64-bit OpenGL.
        if { ${os.major} > 8 } {
            configure.args-append   --with-apple-opengl-framework
        } else {
            global merger_configure_args
            array set merger_configure_args {
                ppc  --with-apple-opengl-framework
               i386  --with-apple-opengl-framework
            }
        }
    }
}

minimum_xcodeversions {9 3.1}

livecheck.type  regex
livecheck.url   http://www.remotesensing.org/libtiff/
livecheck.regex {v(\d+(?:\.\d+)*)</a>}
