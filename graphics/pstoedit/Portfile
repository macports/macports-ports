# $Id: Portfile,v 1.2 2004/04/18 22:43:21 blb Exp $

PortSystem			1.0
name				pstoedit
version				3.33
categories			graphics
maintainers			blb@pobox.com
description			Translate PostScript and PDF to other vector formats
long_description \
	pstoedit converts Postscript(TM) and PDF files to other vector graphic \
	formats so that they can be edited graphically.

platforms			darwin

homepage			http://home.t-online.de/home/helga.glunz/wglunz/pstoedit/
master_sites		${homepage}

checksums			md5 6a671ef165bf7d1611a2ad3f0499ff5b

depends_lib			lib:libMagick++:ImageMagick lib:libplotter:plotutils \
					lib:libpng:libpng lib:libz:zlib
depends_run			bin:gs:ghostscript

configure.env		CPPFLAGS="-I${prefix}/include" LDFLAGS="-L${prefix}/lib"
configure.args		--disable-static

post-destroot {
	xinstall -m 755 -d ${destroot}/${prefix}/share/man/man1 \
		${destroot}/${prefix}/share/doc/${name}
	xinstall -m 644 -W ${worksrcpath}/doc pstoedit.1 \
		${destroot}/${prefix}/share/man/man1
	xinstall -m 644 -W ${worksrcpath}/doc pstoedit.htm pstoedit.tex \
		${destroot}/${prefix}/share/doc/${name}
}

variant gnughostscript {
	depends_run-delete	bin:gs:ghostscript
	depends_run-append	bin:gs:gnughostscript
}

variant darwin {
	depends_build-append	bin:automake-1.7:automake
	patchfiles-append		patch-src_dynload.cpp patch-src_Makefile.am
	# Need the 1.7 versions of automake/aclocal tools which is why we do
	# this here
	post-patch {
		cd ${worksrcpath}
		file copy -force /usr/share/libtool/ltmain.sh ltmain.sh
		system "aclocal-1.7 -I ${prefix}/share/aclocal-1.7 \
			-I /usr/share/aclocal"
		system "automake-1.7"
		system "autoconf"
	}
}

platform darwin 6 {
	depends_lib-append		lib:libdl:dlcompat
}

