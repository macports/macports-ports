--- tests/modules/Makefile	2025-11-18 22:58:24.000000000 +0800
+++ tests/modules/Makefile	2025-12-12 05:51:45.000000000 +0800
@@ -11,35 +11,7 @@
 	SHOBJ_LDFLAGS ?= -shared
 endif
 
-CLANG := $(findstring clang,$(shell sh -c '$(CC) --version | head -1'))
-
-ifeq ($(SANITIZER),memory)
-ifeq (clang, $(CLANG))
-	LD=clang
-	MALLOC=libc
-	CFLAGS+=-fsanitize=memory -fsanitize-memory-track-origins=2 -fno-sanitize-recover=all -fno-omit-frame-pointer
-	LDFLAGS+=-fsanitize=memory
-else
-    $(error "MemorySanitizer needs to be compiled and linked with clang. Please use CC=clang")
-endif
-endif
-
-
-# This is a hack to override the default CC. When running with SANITIZER=memory
-# tough we want to keep the compiler as clang as MSan is not supported for gcc
-ifeq ($(uname_S),Linux)
-ifneq ($(SANITIZER),memory)
-	LD = gcc
-	CC = gcc
-endif
-endif
-
-# OS X 11.x doesn't have /usr/lib/libSystem.dylib and needs an explicit setting.
-ifeq ($(uname_S),Darwin)
-ifeq ("$(wildcard /usr/lib/libSystem.dylib)","")
-LIBS = -L /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/lib -lsystem
-endif
-endif
+LD := $(CC)
 
 TEST_MODULES = \
     commandfilter.so \
