# $Id$

PortSystem 1.0

name			dokuwiki
version			2011-05-25a
categories		www
license			GPL-2
platforms		darwin
maintainers		nomaintainer
supported_archs		noarch

description		simple to use wiki aimed at documentation projects
long_description	dokuwiki is a simple to use wiki aimed at a small \
				companies documentation needs. It works on plain texts files \
				and thus needs no database. It has a simple but powerful \
				syntax which makes sure the datafiles remain readable outside \
				the Wiki.

homepage		http://www.splitbrain.org/projects/dokuwiki
master_sites		http://www.splitbrain.org/_media/projects/dokuwiki/ \
			http://dev.splitbrain.org/browse/snapshots/
extract.suffix	.tgz

checksums		sha1    a437e863aa5378091fe11ee21f0c5523ca993cee \
			rmd160  d4b9c26afb733ff5b02ed3503cefb03ee7a83c7b

depends_run		port:php5-web

use_configure	no

build			{}

destroot.violate_mtree	yes
destroot	{
	xinstall -m 755 -d ${destroot}${prefix}/apache2/htdocs \
		${destroot}${prefix}/share ${destroot}${prefix}/var/${name}
	system "cd ${destroot}${prefix}/apache2/htdocs/ \
		&& ln -sf ${prefix}/share/${name}"
	file copy ${worksrcpath} ${destroot}${prefix}/share/${name}
	file rename ${destroot}${prefix}/share/${name}/data \
		${destroot}${prefix}/var/${name}/data
	system "touch ${destroot}${prefix}/var/${name}/data/.turd"
	system "touch ${destroot}${prefix}/share/${name}/changes.log"
	system "cd ${destroot}${prefix}/share/${name}/ \
		&& ln -s ${prefix}/var/${name}/data"
	system "chown -R www:www ${destroot}${prefix}/var/${name} \
		${destroot}${prefix}/share/${name}/changes.log \
                ${destroot}${prefix}/share/${name}/conf \
                ${destroot}${prefix}/share/${name}/lib/plugins"
}
