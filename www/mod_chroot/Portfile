# $Id: Portfile,v 1.2 2004/05/04 19:29:40 mww Exp $

PortSystem 1.0

name		mod_chroot
version		0.2
categories	www security
platforms	darwin
maintainers	mww@opendarwin.org
description	module for running apache1 in a secure chroot environment
long_description	mod_chroot makes running apache1 in a secure chroot \
			environment easy. You don't need to create a special \
			directory hierarchy containing /dev, /lib, /etc...

homepage	http://core.segfault.pl/~hobbit/mod_chroot
master_sites	${homepage}/dist/
checksums	md5 85211cd8cafcfe64258e02291ea6439e

depends_lib	path:${prefix}/sbin/apxs:apache

use_configure	no

build.cmd	${prefix}/sbin/apxs
build.args	-c mod_chroot.c
build.target

destroot	{
	xinstall -d -m 755 ${destroot}${prefix}/libexec/apache/ \
		${destroot}${prefix}/share/doc/${name}
	xinstall -m 644 ${worksrcpath}/mod_chroot.so \
		${destroot}${prefix}/libexec/apache/
	xinstall -m 644 -W ${worksrcpath} CAVEATS ChangeLog EAPI INSTALL \
		LICENSE ${destroot}${prefix}/share/doc/${name}
}

post-install	{
	ui_msg "# To activate mod_chroot, add"
	ui_msg "#  LoadModule chroot_module  libexec/apache/mod_chroot.so"
	ui_msg "#  AddModule mod_chroot.c"
	ui_msg "# to ${prefix}/etc/apache/httpd.conf"
}
