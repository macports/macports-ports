# $Id$

PortSystem 1.0
name            neon
version         0.26.3
categories      www
maintainers     dluke@geeklair.net
description     An HTTP and WebDAV client library with a C interface
platforms       darwin freebsd
long_description \
    neon is an HTTP and WebDAV client library with a C language API.    \
    It provides a high-level interface to HTTP and WebDAV methods and a \
    low-level interface to HTTP request handling, easily allowing the   \
    implementation of new methods.

homepage        http://www.webdav.org/neon/
master_sites    http://www.webdav.org/neon/
checksums       md5 6e52cd9c03e372026d6eccbfb80f09ef

depends_lib     port:expat \
                port:gettext \
                port:libiconv \
                port:openssl \
                port:zlib
configure.env   LDFLAGS=-L$prefix/lib \
                CPPFLAGS=-I$prefix/include
configure.args  --with-ssl \
                --enable-shared \
                --with-expat \
                --mandir=\\\${prefix}/share/man

if {[llength [info commands configure.universal_ldflags-append]] > 0} {
    configure.universal_ldflags-append  -L$prefix/lib
    if {[variant_isset universal]} {
        post-destroot {
            cd ${destroot}${prefix}/bin
            set nc neon-config
            reinplace "s|-arch i386 -arch ppc ||g" ${nc}
            reinplace "s|-isysroot /Developer/SDKs/MacOSX10.4u.sdk ||g" ${nc}
        }
    }
} else {
	variant universal {
		return -code error "You need to be running MacPorts 1.5.0 or higher to \
		use this variant (universal)."
	}
}


destroot.destdir    prefix=${destroot}${prefix}

test.env    DYLD_LIBRARY_PATH=`find ${worksrcpath} -type d -name .libs | xargs echo | sed -e 's/ /:/g'`
test.run    yes
test.target check
