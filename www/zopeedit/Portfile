# $Id: Portfile,v 1.5 2004/07/19 23:59:27 rshaw Exp $
PortSystem		1.0

name			zopeedit
version			0.8
categories		www zope python
maintainers		rshaw@opendarwin.org
description		Client helper application for Zope ExternalEditor support
long_description	Configurable helper application that allows you \
					to drop into your favorite editor(s) directly from \
					the ZMI to modify Zope objects.
platforms		darwin freebsd
homepage		http://www.zope.org/Members/Caseman/ExternalEditor
master_sites	http://zope.org/Members/Caseman/ExternalEditor/${version}
distname		${name}-${version}-src
extract.suffix	.tgz
checksums		md5 8ecc65067d32ac961476f924fa3e8b5b

# Use Python 2.3 from DarwinPorts explicitly 
set python		${prefix}/bin/python2.3

# Depends on Python
depends_build	path:${python}:python23

platform freebsd {
	extract.post_args	| gtar -xf -
}

configure {
	cd ${worksrcpath}
	reinplace "s|/usr/bin/${name}|${prefix}/bin/${name}|g" man/${name}.1
}

build.cmd		${python} setup.py
build.target	build

destroot.cmd	${python} setup.py
destroot.destdir
destroot.args	--prefix=${destroot}${prefix}
post-destroot {
	cd ${worksrcpath}
	file rename ${destroot}${prefix}/bin/${name}.py \
		${destroot}${prefix}/bin/${name}
	xinstall -d -m 0755 ${destroot}${prefix}/share/man/man1
	xinstall -m 0644 man/${name}.1 ${destroot}${prefix}/share/man/man1
	xinstall -d -m 0755 ${destroot}${prefix}/share/doc/${name}
	xinstall -m 0644 README.txt ${destroot}${prefix}/share/doc/${name}
	xinstall -m 0644 CHANGES.txt ${destroot}${prefix}/share/doc/${name}
	xinstall -m 0644 INSTALL-UNIX.txt ${destroot}${prefix}/share/doc/${name}
	xinstall -m 0644 LICENSE.txt ${destroot}${prefix}/share/doc/${name}
}

