# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0

name                volta
version             0.1.1
categories          www net
platforms           darwin
maintainers         nomaintainer
license             BSD

description         a high performance Squid compatible URI redirector

long_description    Volta is a high performance, low resource URI rewriter \
                    for use with the Squid caching proxy server (or \
                    alternatively Polipo!) With it, you can dynamically alter \
                    URI requests on various criteria. It uses a finite state \
                    machine to parse URIs and rules, and a constant database \
                    for storage. It can perform conditional rewrites \
                    internally or by evaluating Lua scripts.

homepage            http://projects.martini.nu/volta/
master_sites        http://dl.dropbox.com/u/7234177/Releases/ \
                    ${homepage}chrome/site/
extract.suffix      .tgz

checksums           rmd160 e76a1a81b8d499e009a1ebc64cd6dc214b55707d \
                    sha256 596e54a59d19a84ff2d9019d0f4742ebcd33b9c4ab4a62e977df44242762d880

depends_build       port:pkgconfig \
                    port:tinycdb

depends_lib         port:lua

use_configure       no

variant universal {}

build.target        ${name}

build.args          CC="${configure.cc} [get_canonical_archflags cc]"

destroot {
    xinstall -m 755 ${worksrcpath}/volta ${destroot}${prefix}/bin/
    
    set docdir ${prefix}/share/doc/${subport}
    xinstall -d ${destroot}${docdir}
    xinstall -m 644 -W ${worksrcpath} \
        ChangeLog \
        LICENSE \
        README \
        ${destroot}${docdir}
}

livecheck.type      regex
livecheck.regex     /${name}-(\[0-9.\]+)${extract.suffix}
