# $Id$

PortSystem          1.0

name                kdebase4-devel
version             4.1.96
revision            0
categories          kde kde4
maintainers         illogic-al openmaintainer
description         KDE4 applications and libraries from the base package
long_description    Core desktop applications and libraries for the KDE4 desktop. This port installs the file manager dolphin file manager.
platforms      	    darwin
homepage            http://www.kde.org
master_sites        http://ftp.kde.org/unstable/${version}/src/
use_bzip2           yes
distname            kdebase-${version}
checksums           md5 d9010a13848e17d6f1cef3003a035b13

depends_lib         port:kdelibs4-devel \
                    port:qimageblitz \
                    port:kdepimlibs4-devel \
                    port:kdebase4-runtime-devel
                    #port:samba3 test whether this works
                    #port:antigraingeometry \ used by ksvg for rendering
                    # fix antigraingeometry to have no_x11 variant
                    # before enabling this


depends_build       port:cmake \
                    port:automoc

use_parallel_build  yes
worksrcdir          build
pre-configure       { file mkdir ${worksrcpath} }

configure.cmd       cmake
configure.ccache    no
configure.compiler  gcc-4.2
configure.args	../${distname} -DBUILD_SHARED_LIBS=ON \
		-DCMAKE_BUILD_WITH_INSTALL_RPATH=ON \
		-DCMAKE_VERBOSE_MAKEFILE=ON \
		-DCMAKE_BUILD_TYPE=Release \
		-DCMAKE_SYSTEM_PREFIX_PATH=\"${prefix}\;/usr\" \
		-DCMAKE_INSTALL_PREFIX=${prefix} \
		-DPHONON_INCLUDE_DIR=${prefix}/include \
		-DPHONON_LIBRARY=${prefix}/lib/libphonon.dylib \
		-DBUNDLE_INSTALL_DIR=${applications_dir} \
		-DCMAKE_OSX_SYSROOT=${universal_sysroot} \
		-DWITH_XKB=OFF \
		-DX11_XKB_INCLUDE_PATH=\"\" \
		-DWITH_Xine=OFF \
		-DQT_QMAKE_EXECUTABLE=${prefix}/libexec/qt4-mac/bin/qmake \
		-Wno-dev

default_variants    +debug

variant universal {
    configure.universal_args-delete  --disable-dependency-tracking
    configure.args-append	-DCMAKE_OSX_ARCHITECTURES=\"[strsed ${configure.universal_archs} "g| |;|"]\"
}

variant debug description "Enable debug binaries" {
	configure.args-delete		-DCMAKE_BUILD_TYPE=Release
	configure.args-append		-DCMAKE_BUILD_TYPE=debugFull

}

variant xine description "enable phonon_xine engine" {
# Unsupported. Don't report bugs, unless you fix it :-)
	depends_build               port:xine-lib
    configure.args-delete       -DWITH_XKB=OFF \
                                -DX11_XKB_INCLUDE_PATH=\"\" \
                                -DWITH_Xine=OFF
    configure.args-append       -DWITH_Xine=ON -DWITH_XKB=ON
}
