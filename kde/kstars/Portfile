# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0
PortGroup           kde4   1.1

name                kstars
version             4.7.2
categories          kde kde4
platforms           darwin
license             GPL-2+
maintainers         nicos openmaintainer

description         KStars is a Desktop Planetarium for KDE.
long_description    ${description} It provides an accurate graphical simulation \
                    of the night sky, from any location on Earth, at any date and time. The display \
                    includes up to 100 million stars, 13,000 deep-sky objects ,all 8 planets, the Sun \
                    and Moon, and thousands of comets and asteroids.

homepage            http://edu.kde.org/kstars/
master_sites        kde:stable/${version}/src/
distname            ${name}-${version}

checksums           rmd160  c1d74d91c650b2e0fce6e42a02c917eb6bd9c7a4 \
                    sha256  dd27e35642710dc34d59c4f12635f628243cf280e573cf7cf24ce6035f5cad8f

use_bzip2           yes

depends_lib-append  port:kdelibs4 \
                    port:eigen \
                    port:xplanet \
                    port:cfitsio

patchfiles          patch-CMakeLists.txt.diff

variant no_x11 description "Suppresses X11 dependencies" {
    depends_lib-delete  port:xplanet
}

pre-configure {
    reinplace "s|<GL/gl.h>|<gl.h>|g" ${worksrcpath}/kstars/skyglpainter.cpp

    if {![variant_isset docs]} {
        reinplace "s|add_subdirectory( doc )|#add_subdirectory( doc )|g" ${worksrcpath}/CMakeLists.txt
    }
}

livecheck.url       http://kde.mirrors.hoobly.com/stable/latest/src/
livecheck.regex     ${name}-(\\d+\\.\\d+\\.\\d+)${extract.suffix}
