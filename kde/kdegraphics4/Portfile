# $Id$

PortSystem          1.0
name                kdegraphics4
version             4.1.3
revision            1
categories          kde kde4
maintainers         illogic-al@macports.org openmaintainer
description         KDE4 graphics applications
long_description    KDE applications for managing and creating image files.
homepage            http://www.kde.org
platforms           darwin
master_sites	    http://anonsvn.kde.org/
distname            kdegraphics

fetch.type          svn 
svn.url             svn://anonsvn.kde.org/home/kde/tags/KDE/${version}/${distname}

depends_lib         port:qt4-mac port:kdebase4 \
                    port:exiv2 port:poppler \
                    port:djvulibre port:chmlib \
                    port:qca
# Poppler needs to be installed with +quartz +qt4 variants 
# so this portfile needs to ensure enventually that this happens

depends_build       port:cmake

use_parallel_build  yes

worksrcdir      build

pre-configure { file mkdir ${worksrcpath} }

configure.cmd	cmake

configure.args	../${distname} -DBUILD_SHARED_LIBS:BOOL=ON \
		-DCMAKE_VERBOSE_MAKEFILE=ON \
		-DCMAKE_BUILD_TYPE=Release \
		-DCMAKE_SYSTEM_PREFIX_PATH=\"${prefix};/usr\" \
		-DCMAKE_INSTALL_PREFIX=${prefix} \
		-DCMAKE_BUILD_WITH_INSTALL_RPATH=ON \
		-DPHONON_INCLUDE_DIR=${prefix}/include \
		-DPHONON_LIBRARY=${prefix}/lib/libphonon.dylib \
        -DQCA2_LIBRARIES=${prefix}/lib/libqca.2.dylib \
        -DQCA2_INCLUDE_DIR=${prefix}/include/QtCrypto \
        -DCMAKE_OSX_SYSROOT=${sysroot} \
		-Wno-dev 
# Manually defining qca location forces building of Okular's
# encrytped openoffice document viewer. Might not want to do that.

variant universal description "Compile for ppc and intel architectures" {
    configure.universal_args-delete  --disable-dependency-tracking
    configure.args-append	-DCMAKE_OSX_ARCHITECTURES=\"ppc\;i386\"
}

variant debug description "Enable debug binaries" {
	configure.args-delete		-DCMAKE_BUILD_TYPE=Release 
	configure.args-append		-DCMAKE_BUILD_TYPE=debugFull 
}

