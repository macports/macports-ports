# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:filetype=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           github 1.0
PortGroup           cmake 1.1

platforms           darwin macosx
categories          audio
license             LGPL-2.1
maintainers         {ra1nb0w @ra1nb0w} openmaintainer

description         Codec 2 is an open source speech codec designed for \
    communications quality speech between 700 and 3200 bit/s.
long_description    Codec 2 is an open source speech codec designed for \
    communications quality speech between 700 and 3200 bit/s. The main \
    application is low bandwidth HF/VHF digital radio. It fills a gap in \
    open source voice codecs beneath 5000 bit/s and is released under the \
    GNU Lesser General Public License (LGPL). Informal listening tests \
    indicate that Codec 2 at 700 bits/s has better speech quality than \
    MELP and is comparable to TWELP at 600 bit/s.  The Codec 2 project \
    also contains several modems (OFDM, FDMDV, COHPSK and mFSK) carefully \
    designed for digital voice over HF radio.
homepage            http://www.rowetel.com/codec2.html

github.setup        drowe67 codec2 67f31bce663caef85abb5dd2df62fb996b246c05
version             20221123-[string range ${github.version} 0 7]
checksums           rmd160  411957786cf5462eb74cc1c4d50772f724497b73 \
                    sha256  087f787fe31b9b82bc4814f198a7772894082e5e7a29e3212259f00a1a2cd8ae \
                    size    14805637
revision            0
epoch               1

depends_lib-append \
    port:libsamplerate \
    port:speex

compiler.c_standard 1999

configure.args-append \
    -DCMAKE_BUILD_TYPE="Release"

variant lpcnet description {Enable lpcnet support (FreeDV 2020 codec)} {
    depends_lib-append \
        port:lpcnetfreedv
    configure.args-append \
        -DLPCNET=ON
}

notes "
To enable codec 2020 you need to rebuild ${name} with lpcnet variant. Use
  sudo port install ${name} +lpcnet
"

# require valgrind for many tests
test.run            no
