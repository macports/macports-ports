# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           python 1.0

name                isrcsubmit
version             2.1.0
revision            0

categories-prepend  audio devel
license             GPL-3+
platforms           {darwin any}
supported_archs     noarch

description         Utility to extract ISRCs from audio CDs and submit them to MusicBrainz
long_description    isrcsubmit is a Python script to extract ISRCs from audio CDs \
                    and submit them to MusicBrainz.

homepage            https://jonnyjd.github.io/musicbrainz-isrcsubmit/

maintainers         nomaintainer

checksums           rmd160  c6d8c9b91fe60bce65fb487f748102d24e9d23ed \
                    sha256  e6ac5308c665fb38b508fa1cad3cf077edc9b4d4fb32916d2621c8b9af93d248 \
                    size    49777

patchfiles-append   isrcsubmit-shebang.patch \
                    setup-no-packages.patch \
                    get_real_mac_device-bytes.patch

python.default_version 313

depends_lib-append  port:py${python.version}-discid \
                    port:py${python.version}-musicbrainzngs \
                    port:py${python.version}-keyring

post-patch {
    # fix shebang
    reinplace -W ${worksrcpath} "s|@@PYTHON_BIN@@|${python.bin}|g" isrcsubmit.py
}

post-destroot {
    # remove .py suffix from installed executable
    move ${destroot}${prefix}/bin/isrcsubmit.py ${destroot}${prefix}/bin/isrcsubmit

    set dest_doc ${destroot}${prefix}/share/doc/${subport}
    xinstall -d ${dest_doc}
    xinstall -m 0644 -W ${worksrcpath} \
        AUTHORS COPYING README.rst \
        ${dest_doc}
}

test.run            yes
test.args           -s
