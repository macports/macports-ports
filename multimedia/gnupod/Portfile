# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0

name                gnupod
version             0.99.7
revision            2
categories          multimedia perl
maintainers         nomaintainer
platforms           darwin
license             GFDL-1.2
set perl-version    5.16

description         GNUpod is a collection of tools which allow you to \
                    use your iPod with UNIX-like operating systems.
long_description    ${description}

homepage            http://blinkenlights.ch/gnupod/gnupod.html
master_sites        http://www.blinkenlights.ch/gnupod-dist/stable
extract.suffix      .tgz

checksums           rmd160  7a7dc808d7d58382d3a15facb5038612c146bf66 \
                    sha256  52cfd91fe50a8f9800b15cf4e83d9a02ac806e5620f49f99c3c905a1b8574b4a

depends_lib         port:perl${perl-version} \
                    port:p${perl-version}-mp3-info \
                    port:p${perl-version}-digest-md5 \
                    port:p${perl-version}-xml-parser \
                    port:p${perl-version}-unicode-string \
                    port:p${perl-version}-libwww-perl \
                    port:p${perl-version}-digest-sha1 \
                    port:p${perl-version}-timedate \
                    port:lame

configure.perl      ${prefix}/bin/perl${perl-version}

configure.args    --infodir=${prefix}/share/info

post-destroot {
    xinstall -m 755 -d ${destroot}${prefix}/share/${name}
    xinstall -m 644 -W ${worksrcpath} doc/gnupodrc.example \
        doc/gnutunesdb.example doc/ipod.svg doc/mkspl.html \
        doc/gnupod.html ${destroot}${prefix}/share/${name}
}

# should also use timidity
variant flac description "Enable FLAC" {
    depends_lib-append  port:flac port:p${perl-version}-audio-flac-header
}

# should use Ogg::Vorbis::Header::PurePerl, won't work
variant vorbis description "Enable Ogg/Vorbis" {
    depends_lib-append  port:vorbis-tools port:p${perl-version}-libvorbis-perl
}

variant aac description "Enable AAC" {
    depends_lib-append  port:faac path:lib/libavcodec.dylib:ffmpeg
}

variant artwork description "Enable artwork support" {
    depends_lib-append  port:ImageMagick
}
