# $Id: Portfile,v 1.3 2004/04/28 08:13:15 blb Exp $

PortSystem		1.0
name			MPlayer
version			1.0pre4
categories		multimedia
maintainers		blb@pobox.com
description		The Unix movie player
long_description	\
	MPlayer can play most standard video formats out of the box and almost \
	all others with the help of external codecs.  MPlayer currently works \
	best from the command line, but visual feedback for many functions is \
	available from its onscreen status display (OSD), which is also used for \
	displaying subtitles. MPlayer also has a GUI with skin support and \
	several unofficial alternative graphical frontends are available.

platforms		darwin
use_bzip2		yes
homepage		http://www.mplayerhq.hu/
master_sites	http://www1.mplayerhq.hu/MPlayer/releases/ \
				http://www2.mplayerhq.hu/MPlayer/releases/ \
				http://ftp3.mplayerhq.hu/MPlayer/releases/ \
				http://ftp5.mplayerhq.hu/MPlayer/releases/
checksums		md5 83ebac0f05b192516a41fca2350ca01a

depends_lib		lib:libpng:libpng lib:libjpeg:jpeg
configure.args	--with-extraincdir=${prefix}/include \
				--with-extralibdir=${prefix}/lib \
				--mandir=${prefix}/share/man --disable-sdl --disable-x11 \
				--disable-freetype --disable-fontconfig --disable-inet6 \
				--disable-gif --enable-png --enable-jpeg --disable-liblzo \
				--disable-qtx --disable-vorbis --disable-arts --disable-esd \
				--disable-fribidi --disable-mad --disable-mencoder

variant quicktime {
	configure.args-delete	--disable-qtx
	configure.args-append	--enable-qtx
	patchfiles-append		patch-libmpcodecs_ad_qtaudio.c \
							patch-libmpcodecs_vd_qtvideo.c
}

variant x11 {
	ui_msg "Note, if you are running Mac OS X, you may find the sdl variant"
	ui_msg "a faster choice"
	depends_lib-append		lib:libX11.6:XFree86 lib:libfreetype:freetype \
							lib:libfontconfig:fontconfig
	configure.args-delete	--disable-x11 --disable-freetype \
							--disable-fontconfig
	configure.args-append	--enable-x11 --enable-freetype --enable-fontconfig
}

variant sdl {
	depends_lib-append		lib:libSDL:libsdl
	configure.args-delete	--disable-sdl
	configure.args-append	--enable-sdl
}

variant inet6 {
	configure.args-delete	--disable-inet6
	configure.args-append	--enable-inet6
}

# configure doesn't pick up the right -l flag if we --enable-gif, so
# we let it autodetect this
variant gif {
	depends_lib-append		lib:libungif:libungif
	configure.args-delete	--disable-gif
}

variant lzo {
	depends_lib-append		lib:liblzo:lzo
	configure.args-delete	--disable-liblzo
	configure.args-append	--enable-liblzo
}

variant vorbis {
	depends_lib-append		lib:libvorbis:libvorbis
	configure.args-delete	--disable-vorbis
	configure.args-append	--enable-vorbis
}

variant arts {
	depends_lib-append		lib:libartsc:arts
	configure.args-delete	--disable-arts
	configure.args-append	--enable-arts
}

variant esd {
	depends_lib-append		lib:libesd:esound
	configure.args-delete	--disable-esd
	configure.args-append	--enable-esd
}

variant fribidi {
	depends_lib-append		lib:libfribidi:fribidi
	configure.args-delete	--disable-fribidi
	configure.args-append	--enable-fribidi
}

variant mad {
	depends_lib-append		lib:libmad:libmad
	configure.args-delete	--disable-mad
	configure.args-append	--enable-mad
}

variant mencoder {
	depends_lib-append		lib:libmp3lame:lame
	configure.args-delete	--disable-mencoder
	configure.args-append	--enable-mencoder
	pre-configure {
		reinplace "s|^#define USE_MP3LIB|/\*#define USE_MP3LIB\*/|" \
			${worksrcpath}/configure
	}
}

variant man_bg		{ configure.args-append --language=bg }
variant man_cz		{ configure.args-append --language=cz }
variant man_de		{ configure.args-append --language=de }
variant man_dk		{ configure.args-append --language=dk }
variant man_el		{ configure.args-append --language=el }
variant man_en		{ configure.args-append --language=en }
variant man_es		{ configure.args-append --language=es }
variant man_fr		{ configure.args-append --language=fr }
variant man_hu		{ configure.args-append --language=hu }
variant man_it		{ configure.args-append --language=it }
variant man_ko		{ configure.args-append --language=ko }
variant man_mk		{ configure.args-append --language=mk }
variant man_nl		{ configure.args-append --language=nl }
variant man_no		{ configure.args-append --language=no }
variant man_pl		{ configure.args-append --language=pl }
variant man_ro		{ configure.args-append --language=ro }
variant man_ru		{ configure.args-append --language=ru }
variant man_sk		{ configure.args-append --language=sk }
variant man_tr		{ configure.args-append --language=tr }
variant man_uk		{ configure.args-append --language=uk }
variant man_pt_BR	{ configure.args-append --language=pt_BR }
variant man_zh_CN	{ configure.args-append --language=zh_CN }
variant man_zh_TW	{ configure.args-append --language=zh_TW }
variant man_all		{ configure.args-append --language=all }

# GUI variant needs additional download of a skin
#variant gui {
#	depends_lib-append		lib:libgtk.1:gtk
#	configure.args-append	--enable-gui
#}

post-destroot {
	cd ${worksrcpath}
	file mkdir ${destroot}/${prefix}/share/doc/${name}
	file copy DOCS/HTML DOCS/README DOCS/de DOCS/default.css \
		DOCS/hu DOCS/it DOCS/tech DOCS/zh \
		${destroot}/${prefix}/share/doc/${name}
}

