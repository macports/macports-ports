# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0

name                taskjuggler
version             2.4.1
homepage            http://www.taskjuggler.org/
categories          office project pim

description         A powerful project management tool.
long_description    TaskJuggler is a modern and powerful, Open Source \
                    project management tool.

maintainers         rene

platforms           darwin

master_sites        http://www.taskjuggler.org/download/
distname            ${name}-${version}
extract.suffix      tar.bz2
use_bzip2           yes
checksums           md5 18e0cec8b2ec69220ae7c9a790c16819 \
                    sha1 f690e57554488b85375ad96cd6a7635bd4ff6507 \
                    rmd160 e1648e818610776efd0f7f9241e987b92a5413ef

depends_lib         port:qt3 \
                    port:fontconfig \
                    port:jpeg \
                    port:libpng \
                    port:kdebase3 \
                    port:kdelibs3 \
                    port:kdepim3
depends_build       port:automake \
                    port:autoconf

configure.args      --prefix=${prefix} \
                    --enable-mac \
                    --disable-docs \
                    --without-arts \
                    --with-qt-dir=${prefix}/lib/qt3 \
                    --with-extra-includes=${prefix}/include \
                    --with-extra-libs=${prefix}/lib

patchfiles          patch-admin-libtool.m4.in.diff \
                    patch-Examples-FirstProject-AccountingSoftware.tjp.diff

build.args          DYLD_LIBRARY_PATH=${worksrcpath}/taskjuggler/.libs \
                    LDFLAGS=\"-dylib_file /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib:/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib\"

destroot.target     install
destroot.args       DESTDIR=${destroot}${prefix} \
                    DYLD_LIBRARY_PATH=${worksrcpath}/taskjuggler/.libs \
                    kde_locale=${destroot}/share/locale \
                    docprefix=${destroot}/share/doc

variant qt3mac description {use qt3mac instead of qt3} {
    configure.args-delete       --with-qt-dir=${prefix}/lib/qt3
    depends_lib-delete          port:qt3
    configure.args-append       --with-qt-dir=${prefix}/lib/qt3mac
    depends_lib-append          port:qt3-mac
}

variant nokde description {only build the command line version} {
    configure.args-append       --with-kde-support=no
    depends_lib-delete          port:kdebase3 \
                                port:kdelibs3 \
                                port:kdepim3
}

variant docs description {create docbook documentation} {
    configure.args-delete       --disable-docs
    depends_build-add           port:openjade \
                                port:docbook-xml-4.5
}

variant arts description {compile with arts support} {
    configure.args-delete       --without-arts
    depends_lib-add             port:arts
}

variant debug description {enable debug mode} {
    configure.args-append       --enable-debug=yes
}

