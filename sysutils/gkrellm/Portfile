# $Id: Portfile,v 1.2 2006/05/03 06:52:33 markd Exp $
PortSystem      1.0

name                    gkrellm
version                 2.2.10
categories              sysutils
maintainers             markd@macports.org

description             A GTK based system monitor
long_description        ${description}

homepage                http://members.dslextreme.com/users/billw/gkrellm/gkrellm.html

platforms               darwin
master_sites            http://members.dslextreme.com/users/billw/gkrellm/
checksums               md5 57ef0525c0997ac2e7720712811f5a84
use_bzip2		yes

depends_lib             port:gtk2

use_configure		no

build.type		gnu
build.env		CPPFLAGS="-L${prefix}/lib -I${prefix}/include" \
			CFLAGS=-I${prefix}/include \
			LDFLAGS=-L${prefix}/lib

build.target		darwin
destroot.target		install_darwin

set plugin_dir          ${prefix}/libexec/gkrellm2/plugins
set theme_dir		${prefix}/share/gkrellm2/themes

post-patch {
        reinplace "s|\$(PREFIX)|${prefix}|g" \
                "${worksrcpath}/Makefile"

        reinplace "s|/usr/local/share/gkrellm2/themes|${theme_dir}|g" \
                "${worksrcpath}/src/gkrellm.h"

	reinplace "s|/usr/share/gkrellm2/themes|${theme_dir}|g" \
                "${worksrcpath}/src/gkrellm.h"

        reinplace "s|/usr/local/lib/gkrellm2/plugins|${plugin_dir}|g" \
                "${worksrcpath}/src/gkrellm.h"

        reinplace "s|/usr/lib/gkrellm2/plugins|${plugin_dir}|g" \
                "${worksrcpath}/src/gkrellm.h"
}

post-destroot {
	xinstall -m 755 -d ${destroot}${theme_dir}
	xinstall -m 755 -d ${destroot}${plugin_dir}

	destroot.keepdirs \
                ${destroot}${theme_dir} \
		${destroot}${plugin_dir}
}

post-activate {
ui_msg "\n

After the first launch of GkrellM, the directory ~/.gkrellm2/
is created that contains the file user-config to keep your
settings, and also contains directories named themes/ and plugins/.
However, the plugins and themes directories for this port of
GkrellM are fixed at these locations:

${plugin_dir}
${theme_dir}
\n"
}
