# $Id$

PortSystem 1.0

name			createrepo
version			0.4.10
categories		sysutils
platforms		darwin
maintainers		afb@macports.org
description		generates common metadata for package repositories
long_description	createrepo generates the metadata necessary for an RPM package \
			repository. This repository format (repodata) is supported by \
			apt, red-carpet(zen), smart, up2date, Yast and yum.

homepage		http://linux.duke.edu/projects/metadata/
master_sites		${homepage}generate/
checksums		md5 733971b7aefd2597ad391feae01a6d15 \
				sha1 a09aade9703eead010ea8e633b9af8cc46710796 \
				rmd160 e6afab6df0afa5abba2fd20b517862e1153053bc
patchfiles		patch-createrepo patch-modifyrepo \
			patch-dumpMetadata.py patch-genpkgmetadata.py patch-readMetadata.py

depends_run		port:python24 port:rpm port:py-yum-metadata-parser
# this should be depends_test:
depends_build	port:py-checker

post-patch {
	reinplace "s|__PREFIX__|${prefix}|g" \
		${worksrcpath}/bin/createrepo ${worksrcpath}/bin/modifyrepo
	reinplace "s|__PYTHON__|${prefix}/bin/python2.4|g" \
		${worksrcpath}/dumpMetadata.py ${worksrcpath}/genpkgmetadata.py ${worksrcpath}/readMetadata.py
}

use_configure	no

build.args	prefix=${prefix}

destroot.args	prefix=${prefix} INSTALL="/usr/bin/install -p" INSTALL_MODULES="/usr/bin/install -m 755"

test.run		yes
test.target		check

livecheck.check	regex
# get the last modified tarball
livecheck.url	${master_sites}?C=M\;O=D
livecheck.regex	${name}-(\[0-9.\]+)${extract.suffix}
