# $Id: Portfile,v 1.9 2004/12/17 13:45:29 toby Exp $

PortSystem 1.0
name		yum
version		1.0.3
revision	2
platforms	darwin
categories	sysutils archivers
maintainers	darwinports@opendarwin.org
description	Automatic updater and package installer/remover for RPM
long_description	Yum is an automatic updater and package installer/remover for \
			rpm systems. It automatically computes dependencies and figures \
			out what things should occur to install packages. It makes it \
			easier to maintain groups of machines without having to manually \
			update each one using rpm.
homepage	http://linux.duke.edu/projects/yum/
master_sites	${homepage}download/1.0/
checksums	md5 0188c0edfa3f2d552a39898297a67af7

patchfiles	patch-archwork-py.diff		patch-bin-yum-arch.diff \
		patch-bin-yum.diff		patch-clientstuff-py.diff \
		patch-config-py.diff		patch-docs-yum-8.diff \
		patch-etc-yum-conf.diff		patch-etc-yum-cron.diff \
		patch-docs-yum-conf-5.diff	patch-etc-makefile-in.diff \
		patch-etc-yum-init.diff		patch-etc-yum-logrotate.diff \
		patch-iutil-py.diff		patch-makefile-in.diff \
		patch-translate-py.diff		patch-up2datetheft-py.diff \
		patch-yummain-py.diff 

depends_lib	lib:librpm:rpm	bin:${prefix}/bin/python2.3:python23

patch {
		foreach patch $patchfiles {
			system "cd '${workpath}/${distname}' && \
			sed -e 's#@@PREFIX@@#${prefix}#g' '${portpath}/${filesdir}/${patch}' | patch -p0"
		}
}

build.env	PYTHON="${prefix}/bin/python2.3"

post-destroot {
		system "mkdir -p '${destroot}${prefix}/var/cache/yum/base/headers'"
		system "mkdir -p '${destroot}${prefix}/var/cache/yum/base/packages'"
		system "mkdir -p '${destroot}${prefix}/var/log'"
		system "mkdir -p '${destroot}${prefix}/var/run'"
		system "touch '${destroot}${prefix}/var/cache/yum/base/headers/.turd'"
		system "touch '${destroot}${prefix}/var/cache/yum/base/packages/.turd'"
		system "touch '${destroot}${prefix}/var/log/.turd'"
		system "touch '${destroot}${prefix}/var/run/.turd'"
}
