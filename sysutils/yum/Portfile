# $Id: Portfile,v 1.2 2003/06/03 16:47:28 ranger Exp $

PortSystem 1.0
name		yum
version		1.0.1
platforms	darwin
revision	2
categories	sysutils archivers
maintainers	ranger@befunk.com
description	Automatic updater and package installer/remover for RPM

master_sites	http://linux.duke.edu/projects/yum/download/1.0/
checksums	md5 a4c831ef1cf8bc32eadc396919dc06fd

patchfiles	patch-archwork-py.diff		patch-bin-yum-arch.diff \
		patch-bin-yum.diff		patch-clientstuff-py.diff \
		patch-config-py.diff		patch-docs-yum-8.diff \
		patch-docs-yum-conf-5.diff	patch-etc-makefile-in.diff \
		patch-etc-yum-conf.diff		patch-etc-yum-cron.diff \
		patch-etc-yum-init.diff		patch-etc-yum-logrotate.diff \
		patch-iutil-py.diff		patch-makefile-in.diff \
		patch-translate-py.diff		patch-up2datetheft-py.diff \
		patch-yummain-py.diff

depends_lib	lib:librpm-4.0.4:rpm

patch {
		foreach patch $patchfiles {
			system "cd '${workpath}/${distname}' && \
			sed -e 's#/opt/local#${prefix}#g' '${portpath}/${filedir}/${patch}' | patch -p0"
		}
}

post-install {
		system "mkdir -p '${destroot}${prefix}/var/cache/yum/base/headers'"
		system "mkdir -p '${destroot}${prefix}/var/cache/yum/base/packages'"
		system "mkdir -p '${destroot}${prefix}/var/log'"
		system "mkdir -p '${destroot}${prefix}/var/run'"
		system "touch '${destroot}${prefix}/var/cache/yum/base/headers/.turd'"
		system "touch '${destroot}${prefix}/var/cache/yum/base/packages/.turd'"
		system "touch '${destroot}${prefix}/var/log/.turd'"
		system "touch '${destroot}${prefix}/var/run/.turd'"
}
