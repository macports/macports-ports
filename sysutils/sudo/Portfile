# $Id: Portfile,v 1.3 2005/01/26 00:12:40 landonf Exp $

PortSystem			1.0
name				sudo
version				1.6.8p6
categories			sysutils
maintainers			blb@pobox.com
description			Allow users to run programs as other users, eg, root
long_description \
	Sudo is a program designed to allow a sysadmin to give limited root \
	privileges to users and log root activity.  The basic philosophy is to \
	give as few privileges as possible but still allow people to get their \
	work done.

homepage			http://www.sudo.ws/sudo/
master_sites			${homepage}/dist/

platforms			darwin sunos freebsd
checksums			md5 fe952a370f479180a13bc50eb697e756

#patchfiles			patch-auth_pam.c patch-configure patch-config.h.in

configure.args		--infodir=${prefix}/share/info \
					--mandir=${prefix}/share/man \
					--sysconfdir=${prefix}/etc \
					--with-env-editor \
					--with-tty-tickets \
					--with-ignore-dot \
					--disable-log-wrap

pre-destroot {
	if { $env(USER) != "root" } {
		ui_msg "------------------------------------------------------------"
		ui_msg "Installing sudo as non-root doesn't really do anything"
		ui_msg "useful, so be sure to install sudo as root"
		ui_msg "------------------------------------------------------------"
	}
}

post-destroot {
	file rename ${destroot}${prefix}/etc/sudoers ${destroot}${prefix}/etc/sudoers.dist
}

post-install {
	ui_msg "------------------------------------------------------------"
	ui_msg "To complete installation, copy, as root, "
	ui_msg "${prefix}/etc/sudoers.dist to ${prefix}/etc/sudoers (keeping "
	ui_msg "the same permissions), and edit it as necessary (see the"
	ui_msg "sudoers manpage for information)."
	ui_msg "------------------------------------------------------------"
}

variant darwin {
	configure.args-append	--with-password-timeout=0 \
							--with-pam
}

variant sunos {
	configure.args-append	--with-pam
}

variant freebsd {
	configure.args-append	--with-pam \
				--with-logincap \
				--with-long-otp-prompt
}

variant insults {
	configure.args-append	--with-insults --with-all-insults
}

