# $Id$

PortSystem			1.0
name				sudo
version				1.6.8p12
categories			sysutils security
maintainers			nomaintainer@macports.org
description			Allow users to run programs as other users, eg, root
long_description \
	Sudo is a program designed to allow a sysadmin to give limited root \
	privileges to users and log root activity.  The basic philosophy is to \
	give as few privileges as possible but still allow people to get their \
	work done.

platforms			darwin sunos freebsd

homepage			http://www.sudo.ws/sudo/
master_sites		${homepage}dist/

checksums			md5 b29893c06192df6230dd5f340f3badf5

configure.args		--infodir=${prefix}/share/info \
					--mandir=${prefix}/share/man \
					--sysconfdir=${prefix}/etc \
					--with-env-editor \
					--with-tty-tickets \
					--with-ignore-dot \
					--disable-log-wrap

pre-destroot {
	if { $env(USER) != "root" } {
		ui_msg "------------------------------------------------------------"
		ui_msg "Installing sudo as non-root doesn't really do anything"
		ui_msg "useful, so be sure to install sudo as root"
		ui_msg "------------------------------------------------------------"
	}
}

post-destroot {
	file rename ${destroot}${prefix}/etc/sudoers ${destroot}${prefix}/etc/sudoers.dist
}

post-install {
	ui_msg "------------------------------------------------------------"
	ui_msg "To complete installation, copy, as root, "
	ui_msg "${prefix}/etc/sudoers.dist to ${prefix}/etc/sudoers (keeping "
	ui_msg "the same permissions), and edit it as necessary (see the"
	ui_msg "sudoers manpage for information)."
	ui_msg "------------------------------------------------------------"
}

variant darwin {
	configure.args-append	--with-password-timeout=0 \
							--with-pam
}

variant sunos {
	configure.args-append	--with-pam
}

variant freebsd {
	configure.args-append	--with-pam \
							--with-logincap \
							--with-long-otp-prompt
}

variant insults {
	configure.args-append	--with-insults --with-all-insults
}

