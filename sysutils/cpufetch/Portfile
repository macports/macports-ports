# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           github 1.0
PortGroup           makefile 1.0

# Switch back to standard setup with 1.04:
github.setup        Dr-Noob cpufetch 2fc4896429c4605b57e5b4c1095657c28cb3a0c3
version             1.03
revision            1
categories          sysutils
license             GPL-2
maintainers         {mps @Schamschula} openmaintainer
description         cpufetch is a command-line tool written in C that displays the CPU \
                    information in a clean and beautiful way
long_description    {*}${description}

checksums           rmd160  9b8a0a325d74edb36de0614199efed2d9ccdd1cb \
                    sha256  1f28cec97b5ab35e352ce64fa8d0261bd20c2a9e948eb0aed8069062fa021098 \
                    size    2770352

use_configure       no

# https://trac.macports.org/ticket/66630
# https://github.com/Dr-Noob/cpufetch/issues/167
platform powerpc {
    # Hack for Rosetta to build for ppc:
    if {${os.platform} eq "darwin" && ${os.major} == 10} {
        patchfiles-append \
                    patch-rosetta.diff
    }
    # clang: warning: not using the clang compiler for the 'powerpc' architecture
    compiler.blacklist-append clang
    # Fix for gcc-4.2
    post-patch {
        # cc1: error: unrecognized command line option "-Wno-language-extension-token"
        reinplace "s,-Wno-language-extension-token,," ${worksrcpath}/Makefile
    }
}

destroot {
    xinstall -m 0755 ${worksrcpath}/cpufetch    ${destroot}${prefix}/bin
    xinstall -m 0644 ${worksrcpath}/cpufetch.1  ${destroot}${prefix}/share/man/man1
}
