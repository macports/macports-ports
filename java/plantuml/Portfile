# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem              1.0
PortGroup               github 1.0

github.setup            plantuml plantuml 1.2018.1 v
github.tarball_from     releases
categories              java editors
platforms               darwin
supported_archs         noarch
license                 GPL-3+
maintainers             nomaintainer
description             PlantUML is a tool for generating UML diagrams from textual \
                        description.
long_description        ${description}

checksums               md5     800fe177ce518b36074d7fdff8a31db8 \
                        sha256  69c723e2f271ed28a77fd74f02eb1ab65c6e39a2bce477f08fa390ac96f26ead \
                        rmd160  2deed920d005366bc4135f63fdacd261b1aa32c2 \
                        size    4376445

depends_build           bin:ant:apache-ant
depends_lib             bin:java:kaffe

use_configure           no

build.cmd               ant
build.target            dist

set wrapper             plantuml.sh
set javadir             ${destroot}${prefix}/share/java
set jarname             ${name}.jar

post-extract {
    file copy ${filespath}/${wrapper} ${worksrcpath}
}

post-patch {
    reinplace "s|__PLANTUML_LAUNCHER_PATH__|${prefix}/share/java/${jarname}|g" \
        ${worksrcpath}/${wrapper}
}

destroot {
    xinstall -d -m 755 ${javadir}
    xinstall -m 755 ${worksrcpath}/${wrapper} ${destroot}${prefix}/bin
    xinstall -m 644 ${worksrcpath}/${jarname} ${javadir}
}
