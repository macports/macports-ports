# $Id$

PortSystem 1.0
name			java_memcached
version			1.6
categories		java
maintainers		blair
description		A high performance, distributed object caching system.

long_description	Memcached is a high-performance, distributed \
			memory object caching system, generic in nature, \
			but intended for use in speeding up dynamic web \
			applications by alleviating database load.  This \
			Port provides a native Java client.

homepage		http://www.whalin.com/memcached/

depends_lib		bin:java:kaffe \
			port:jakarta-log4j
depends_build		bin:ant:apache-ant

fetch.type		svn
svn.url			http://www.whalin.com/memcached/svn/java_memcached/tags/release_${version}/ ${distname}
svn.tag			774

use_configure		no

build.cmd		ant
build.args		-Dver=${version} -Dlog4j=1

build {
	cd ${worksrcpath}
	system "echo Running: ${build.cmd} ${build.args} jar"
	system "${build.cmd} ${build.args} jar"
	file copy java_memcached-${version}/java_memcached-${version}.jar ${name}.jar
	system "echo Running: ${build.cmd} ${build.args} javadoc"
	system "${build.cmd} ${build.args} javadoc"
	file rename java_memcached-${version}/javadocs javadocs
}

destroot {
	cd ${worksrcpath}

	set javadir ${destroot}${prefix}/share/java
	set docdir ${destroot}${prefix}/share/doc/${name}

	xinstall -d -m 755 ${javadir}
	xinstall -d -m 755 ${docdir}

	file copy ${name}.jar ${javadir}/
	file copy javadocs ${docdir}/

	foreach f [glob doc/*] {
		file copy ${f} ${docdir}/
	}
	file delete -force ${docdir}/CVS
}

variant built_in_logger {
	depends_lib-delete	port:jakarta-log4j
	build.args-delete	-Dlog4j=1
}
