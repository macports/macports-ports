# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
PortSystem          1.0
name                openjdk-java
categories          java devel
description         An Open-Source, Open Innovation, Open Standards implementation of the Java Platform, Standard Edition, and related projects.
homepage            openjdk.java.net 
license             GPL-2+CE
universal_variant   no
supported_archs     x86_64 arm64
version             17
set long_description_Openjdk-ga \
Production-ready open-source builds of the Java Development Kit

set long_description_Openjdk-ea \
Early-access, open-source builds

set long_description_Valhalla \
The goal of Project Valhalla is to explore and incubate advanced Java VM and Language feature candidates such as:
Value types,
Generic specialization,
Enhanced volatiles,
and possibly othe related topics, such as reified generics.

set long_description_Panama \
We are improving and enriching the connections between the Java virtual machine and well-defined but “foreign” (non-Java) APIs, including many interfaces commonly used by C programmers.
To this end, Project Panama will include most or all of these components:
native function calling from JVM
native data access from JVM or inside JVM heap
new data layouts in JVM heap
native metadata definition for JVM
header file API extraction tools (jextract)
native library management APIs
native-oriented interpreter and runtime “hooks”
class and method resolution “hooks”
native-oriented JIT optimizations
tooling or wrapper interposition for safety
exploratory work with difficult-to-integrate native libraries

set long_description_Loom \
Project Loom is to intended to explore, incubate and deliver Java VM features and APIs built on top of them for the purpose of supporting easy-to-use, high-throughput lightweight concurrency and new programming models on the Java platform. This is accomplished by the addition of the following constructs:
Virtual threads
Delimited continuations
Tail-call elimination

set long_description_GraalVM \
GraalVM is a high-performance JDK distribution designed to accelerate the execution of applications written in Java and other JVM languages along with support for JavaScript, Ruby, Python, and a number of other popular languages. GraalVM’s polyglot capabilities make it possible to mix multiple programming languages in a single application while eliminating foreign language call costs.

set long_description_Openjfx \
JavaFX is an open source, next generation client application platform for desktop, mobile and embedded systems built on Java. It is a collaborative effort by many individuals and companies with the goal of producing a modern, efficient, and fully featured toolkit for developing rich client applications.

set obsoleted_ports {
openjdk-java
}

if {${subport} eq "openjdk-java"} {
    # The openjdk-java port is not installable, but recommends users to install the latest subport
    replaced_by  openjdk-${version}
}

subport openjdk-8-graalvm-ce-amd64 {
version             20.0.0.2
description         openjdk 8 graalvm amd64 community edition build
long_description    ${long_description_GraalVM}
home_page           www.graalvm.org
license             GPL-2 GPL-2+CE BSD-3-Clause UPL
supported_archs     x86_64
master_sites        https://github.com/graalvm/graalvm-ce-builds/releases/download/vm-21.0.0.2/graalvm-ce-java8-darwin-amd64-21.0.0.2.tar.gz
worksrcdir          ${distname}/graalvm-ce-java8-20.0.0.2
}
subport openjdk-8-graalvm-ce {
version             20.0.0.2
description         openjdk 8 graalvm community edition build
long_description    ${long_description_GraalVM}
home_page           www.graalvm.org
license             GPL-2 GPL-2+CE BSD-3-Clause UPL
supported_archs     x86_64
set meta true
    if {${configure.build_arch} eq "x86_64"} {
        depends_run-append port:openjdk-8-graalvm-ce-amd64
    } elseif {${configure.build_arch} eq "arm64"} {
       known_fail yes
        pre-fetch {
            ui_error "openjdk-8-graalvm-ce is only supported on x86_64 architecture."
            return -code error
    }
}

subport openjdk-9/x64 {
version             9.0.4
description         openjdk 9 x64 build
long_description    ${long_description_Openjdk-ga}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     x86_64
master_sites        https://download.java.net/java/GA/jdk9/9.0.4/binaries/openjdk-9.0.4_osx-x64_bin.tar.gz
checksums           sha256  66415406716fc42cff36e2d74ae991d46c42b3cf317b0425c7bf67697c616716
worksrcdir          ${distname}/jdk-9.0.4.jdk
}
subport openjdk-9 {
version             9.0.4
description         openjdk 9 build
long_description    ${long_description_Openjdk-ga}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     x86_64
set meta true
    if {${configure.build_arch} eq "x86_64"} {
        depends_run-append port:openjdk-9/x64
    } elseif {${configure.build_arch} eq "arm64"} {
       known_fail yes
        pre-fetch {
            ui_error "openjdk-9 is only supported on x86_64 architecture."
            return -code error
    }
}

subport openjdk-10/x64 {
version             10.0.2
description         openjdk 10 x64 build
long_description    ${long_description_Openjdk-ga}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     x86_64
master_sites        https://download.java.net/java/GA/jdk10/10.0.2/19aef61b38124481863b1413dce1855f/13/openjdk-10.0.2_osx-x64_bin.tar.gz
checksums           sha256  77ea7675ee29b85aa7df138014790f91047bfdafbc997cb41a1030a0417356d7
worksrcdir          ${distname}/jdk-10.0.2.jdk
}

subport openjdk-10 {
version             10.0.2
description         openjdk 10 build
long_description    ${long_description_Openjdk-ga}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     x86_64
set meta true
    if {${configure.build_arch} eq "x86_64"} {
        depends_run-append port:openjdk-10/x64
    } elseif {${configure.build_arch} eq "arm64"} {
       known_fail yes
        pre-fetch {
            ui_error "openjdk-10 is only supported on x86_64 architecture."
            return -code error
    }
}

subport openjdk-11/x64 {
version             11.0.2
description         openjdk 11 x64 build
long_description    ${long_description_Openjdk-ga}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     x86_64
master_sites        https://download.java.net/java/GA/jdk11/9/GPL/openjdk-11.0.2_osx-x64_bin.tar.gz
checksums           sha256  f365750d4be6111be8a62feda24e265d97536712bc51783162982b8ad96a70ee
worksrcdir          ${distname}/jdk-11.0.2.jdk
}

subport openjfx-11-jmods/x64 {
version             11.0.2
description         openjfx11 
long_description    ${long_description_Openjfx}
home_page           openjfx.io
license             GPL-2+CE
supported_archs     x86_64
master_sites        https://download2.gluonhq.com/openjfx/11.0.2/openjfx-11.0.2_osx-x64_bin-jmods.zip
checksums           sha256  5910dd3d315bfc8760d9378994af3eb692f9212d4bd884d25d46bdc265a29255
worksrcdir          ${distname}/jdk.11.0.2.jdk/contents/home/jmods
}

subport openjdk-11 {
version             11.0.2
description         openjdk 11 build
long_description    ${long_description_Openjdk-ga}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     x86_64
set meta true
    if {${configure.build_arch} eq "x86_64"} {
        depends_run-append port:openjdk-11/x64 port:openjdk-11-jmods/x64 
    } elseif {${configure.build_arch} eq "arm64"} {
       known_fail yes
        pre-fetch {
            ui_error "openjdk-11 is only supported on x86_64 architecture."
            return -code error
    }
}

subport openjdk-11-graalvm-ce-amd64 {
version             21.3.0
description         openjdk 11 graalvm amd64 community edition build
long_description    ${long_description_GraalVM}
home_page           www.graalvm.org
license             GPL-2 GPL-2+CE BSD-3-Clause UPL
supported_archs     x86_64
master_sites        https://github.com/graalvm/graalvm-ce-builds/releases/download/vm-21.3.0/graalvm-ce-java17-darwin-amd64-21.3.0.tar.gz
worksrcdir          ${distname}/graalvm-ce-java11-21.3.0
}
subport openjdk-11-graalvm-ce {
version             21.3.0
description         openjdk 11 graalvm community edition build
long_description    ${long_description_GraalVM}
home_page           www.graalvm.org
license             GPL-2 GPL-2+CE BSD-3-Clause UPL
supported_archs     x86_64
set meta true
    if {${configure.build_arch} eq "x86_64"} {
        depends_run-append port:openjdk-11-graalvm-ce-amd64
    } elseif {${configure.build_arch} eq "arm64"} {
       known_fail yes
        pre-fetch {
            ui_error "openjdk-11-graalvm-ce is only supported on x86_64 architecture."
            return -code error
    }
}

subport openjdk-12/x64 {
version             12.0.2
description         openjdk 12 x64 build
long_description    ${long_description_Openjdk-ga}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     x86_64
master_sites        https://download.java.net/java/GA/jdk12.0.2/e482c34c86bd4bf8b56c0b35558996b9/10/GPL/openjdk-12.0.2_osx-x64_bin.tar.gz
checksums           sha256  675a739ab89b28a8db89510f87cb2ec3206ec6662fb4b4996264c16c72cdd2a1
worksrcdir          ${distname}/jdk-12.0.2.jdk
}

subport openjfx-12-jmods/x64 {
version             12.0.2
description         openjfx12 
long_description    ${long_description_Openjfx}
home_page           openjfx.io
license             GPL-2+CE
supported_archs     x86_64
master_sites        https://download2.gluonhq.com/openjfx/12.0.2/openjfx-12.0.2_osx-x64_bin-jmods.zip
checksums           sha256  be3aa5400c43d3f70fc938d0fb138e3cc9537c62a2af9be266293dcca8bd6558
worksrcdir          ${distname}/jdk.12.0.2.jdk/contents/home/jmods
}

subport openjdk-12 {
version             12.0.2
description         openjdk 12 build
long_description    ${long_description_Openjdk-ga}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     x86_64
set meta true
    if {${configure.build_arch} eq "x86_64"} {
        depends_run-append port:openjdk-12/x64 port:openjfx-12-jmods/x64
    } elseif {${configure.build_arch} eq "arm64"} {
       known_fail yes
        pre-fetch {
            ui_error "openjdk-12 is only supported on x86_64 architecture."
            return -code error
    }
}

subport openjdk-13/x64 {
version             13.0.2
description         openjdk 13 x64 build
long_description    ${long_description_Openjdk-ga}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     x86_64
master_sites        https://download.java.net/java/GA/jdk13.0.2/d4173c853231432d94f001e99d882ca7/8/GPL/openjdk-13.0.2_osx-x64_bin.tar.gz
checksums           sha256  08fd2db3a3ab6fb82bb9091a035f9ffe8ae56c31725f4e17d573e48c39ca10dd
worksrcdir          ${distname}/jdk-13.0.2.jdk
}

subport openjfx-13-jmods/x64 {
version             13.0.2
description         openjfx13
long_description    ${long_description_Openjfx}
home_page           openjfx.io
license             GPL-2+CE
supported_archs     x86_64
master_sites        https://download2.gluonhq.com/openjfx/13.0.2/openjfx-13.0.2_osx-x64_bin-jmods.zip
checksums           sha256  8c1bc1fbc983b2b08a19f3c306b10b0de3033a978fd08e86917ccbe080c88d0e
worksrcdir          ${distname}/jdk.13.0.2.jdk/contents/home/jmods
}

subport openjdk-13 {
version             13.0.2
description         openjdk 13 build
long_description    ${long_description_Openjdk-ga}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     x86_64
set meta true
    if {${configure.build_arch} eq "x86_64"} {
        depends_run-append port:openjdk-13/x64 port:openjfx-13-jmods/x64
    } elseif {${configure.build_arch} eq "arm64"} {
       known_fail yes
        pre-fetch {
            ui_error "openjdk-13 is only supported on x86_64 architecture."
            return -code error
    }
}

subport openjdk-14-Valhalla/x64 {
version             14
description         openjdk 14-Valhalla x64 build
long_description    ${long_description_Valhalla}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     x86_64
master_sites        https://download.java.net/java/early_access/valhalla/4/openjdk-14-valhalla+4-55_osx-x64_bin.tar.gz
checksums           sha256  6cb68d2835c0c0ae9c2c0823979a462c5b733f443c0d1fc3a064acbf3257bede
worksrcdir          ${distname}/jdk-14.jdk
}

subport openjdk-14-Valhalla {
version             14
description         openjdk 14-Valhalla build
long_description    ${long_description_Valhalla}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     x86_64
set meta true
    if {${configure.build_arch} eq "x86_64"} {
        depends_run-append port:openjdk-14-Valhalla/x64
    } elseif {${configure.build_arch} eq "arm64"} {
       known_fail yes
        pre-fetch {
            ui_error "openjdk-14-Valhalla is only supported on x86_64 architecture."
            return -code error
    }
}

subport openjdk-14/x64 {
version             14.0.2
description         openjdk 14 x64 build
long_description    ${long_description_Openjdk-ga}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     x86_64
master_sites        https://download.java.net/java/GA/jdk14.0.2/205943a0976c4ed48cb16f1043c5c647/12/GPL/openjdk-14.0.2_osx-x64_bin.tar.gz
checksums           sha256  386a96eeef63bf94b450809d69ceaa1c9e32a97230e0a120c1b41786b743ae84
worksrcdir          ${distname}/jdk-14.0.2.jdk
}

subport openjfx-14-jmods/x64 {
version             14.0.2.1
description         openjfx14
long_description    ${long_description_Openjfx}
home_page           openjfx.io
license             GPL-2+CE
supported_archs     x86_64
master_sites        https://download2.gluonhq.com/openjfx/14.0.2.1/openjfx-14.0.2.1_osx-x64_bin-jmods.zip
checksums           sha256  d9d8e93946b83c2ddc0e682cffff59ecade59bc783d22bb65a046f3f45a73cbc
worksrcdir          ${distname}/jdk.14.0.2.jdk/contents/home/jmods
}

subport openjdk-14 {
version             14.0.2
description         openjdk 14 build
long_description    ${long_description_Openjdk-ga}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     x86_64
set meta true
    if {${configure.build_arch} eq "x86_64"} {
        depends_run-append port:openjdk-14/x64 openjfx-14-jmods/x64
    } elseif {${configure.build_arch} eq "arm64"} {
       known_fail yes
        pre-fetch {
            ui_error "openjdk-14 is only supported on x86_64 architecture."
            return -code error
    }
}

subport openjdk-15/x64 {
version             15.0.2
description         openjdk 15 x64 build
long_description    ${long_description_Openjdk-ga}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     x86_64
master_sites        https://download.java.net/java/GA/jdk15.0.2/0d1cfde4252546c6931946de8db48ee2/7/GPL/openjdk-15.0.2_osx-x64_bin.tar.gz
checksums           sha256  578b17748f5a7d111474bc4c9b5a8a06b4a4aa1ba4a4bc3fef014e079ece7c74
worksrcdir          ${distname}/jdk-15.0.2.jdk
}

subport openjfx-15-jmods/x64 {
version             15.0.1
description         openjfx15
long_description    ${long_description_Openjfx}
home_page           openjfx.io
license             GPL-2+CE
supported_archs     x86_64
master_sites        https://download2.gluonhq.com/openjfx/15.0.1/openjfx-15.0.1_osx-x64_bin-jmods.zip
checksums           sha256  c66a77b21d6a5fdc4cfe114e5cbe11f4bc024c4471c7abd95b524eb77b1358e8
worksrcdir          ${distname}/jdk.15.0.2.jdk/contents/home/jmods
}

subport openjdk-15 {
version             15.0.2
description         openjdk 15 build
long_description    ${long_description_Openjdk-ga}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     x86_64
set meta true
    if {${configure.build_arch} eq "x86_64"} {
        depends_run-append port:openjdk-15/x64 port:openjfx-15-jmods/x64
    } elseif {${configure.build_arch} eq "arm64"} {
       known_fail yes
        pre-fetch {
            ui_error "openjdk-15 is only supported on x86_64 architecture."
            return -code error
    }
}

subport openjdk-16/x64 {
version             16.0.1
description         openjdk 16 x64 build
long_description    ${long_description_Openjdk-ga}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     x86_64
master_sites        https://download.java.net/java/GA/jdk16.0.1/7147401fd7354114ac51ef3e1328291f/9/GPL/openjdk-16.0.1_osx-x64_bin.tar.gz
checksums           sha256  6098f839954439d4916444757c542c1b8778a32461706812d41cc8bbefce7f2f
worksrcdir          ${distname}/jdk-16.0.1.jdk
}

subport openjfx-16-jmods/x64 {
version             16
description         openjfx16
long_description    ${long_description_Openjfx}
home_page           openjfx.io
license             GPL-2+CE
supported_archs     x86_64
master_sites        https://download2.gluonhq.com/openjfx/16/openjfx-16_osx-x64_bin-jmods.zip
checksums           sha256  054f850ed72a959f524ffa2adbbf7aa13292d85f1e09f414a754e6d40e43ecbc
worksrcdir          ${distname}/jdk.16.0.1.jdk/contents/home/jmods
}

subport openjdk-16 {
version             16.0.1
description         openjdk 16 build 
long_description    ${long_description_Openjdk-ga}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     x86_64
set meta true
    if {${configure.build_arch} eq "x86_64"} {
        depends_run-append port:openjdk-16/x64 port:openjfx-16-jmods/x64
    } elseif {${configure.build_arch} eq "arm64"} {
       known_fail yes
        pre-fetch {
            ui_error "openjdk-16 is only supported on x86_64 architecture."
            return -code error
    }
}

subport openjdk-16-graalvm-ce-amd64 {
version             21.2.0
description         openjdk 16 graalvm amd64 community edition build
long_description    ${long_description_GraalVM}
home_page           www.graalvm.org
license             GPL-2 GPL-2+CE BSD-3-Clause UPL
supported_archs     x86_64
master_sites        https://github.com/graalvm/graalvm-ce-builds/releases/download/vm-21.2.0/graalvm-ce-java16-darwin-amd64-21.2.0.tar.gz
worksrcdir          ${distname}/graalvm-ce-java16-21.2.0
}
subport openjdk-16-graalvm-ce {
version             21.2.0
description         openjdk 16 graalvm community edition build
long_description    ${long_description_GraalVM}
home_page           www.graalvm.org
license             GPL-2 GPL-2+CE BSD-3-Clause UPL
supported_archs     x86_64
set meta true
    if {${configure.build_arch} eq "x86_64"} {
        depends_run-append port:openjdk-16-graalvm-ce-amd64
    } elseif {${configure.build_arch} eq "arm64"} {
       known_fail yes
        pre-fetch {
            ui_error "openjdk-16-graalvm-ce is only supported on x86_64 architecture."
            return -code error
    }
}

subport openjdk-17-Panama/x64 {
version             17
description         openjdk 17-Panama x64 build
long_description    ${long_description_Panama}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     x86_64
master_sites        https://download.java.net/java/early_access/panama/3/openjdk-17-panama+3-167_macos-x64_bin.tar.gz
checksums           sha256  26e25400c4b4e4d55071fed54fc279fdd6e38d820368170eeea4fdc49d6f9103
worksrcdir          ${distname}/jdk-17.jdk
}

subport openjdk-17-Panama {
version             17
description         openjdk 17-Panama build 
long_description    ${long_description_Panama}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     x86_64
set meta true
    if {${configure.build_arch} eq "x86_64"} {
        depends_run-append port:openjdk-17-Panama/x64
    } elseif {${configure.build_arch} eq "arm64"} {
       known_fail yes
        pre-fetch {
            ui_error "openjdk-17-Panama is only supported on x86_64 architecture."
            return -code error
    }
}

subport openjdk-17/x64 {
version             17.0.1
description         openjdk 17 x64 build
long_description    ${long_description_Openjdk-ga}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     x86_64
master_sites        https://download.java.net/java/GA/jdk17.0.1/2a2082e5a09d4267845be086888add4f/12/GPL/openjdk-17.0.1_macos-x64_bin.tar.gz
checksums           sha256  6ccb35800e723cabe15af60e67099d1a07c111d2d3208aa75523614dde68bee1
worksrcdir          ${distname}/jdk-17.0.1.jdk
}

subport openjfx-17-jmods/x64 {
version             17.0.1
description         openjfx17
long_description    ${long_description_Openjfx}
home_page           openjfx.io
license             GPL-2+CE
supported_archs     x86_64
master_sites        https://download2.gluonhq.com/openjfx/17.0.1/openjfx-17.0.1_osx-x64_bin-jmods.zip
checksums           sha256  836f8c88235d2f38b0922b4b2949e35071e9e0a7c1d22a0bebc67b476885b56b
worksrcdir          ${distname}/jdk.17.0.1.jdk/contents/home/jmods
}

subport openjdk-17/AArch64 {
version             17.0.1
description         openjdk 17 AArch64 build
long_description    ${long_description_Openjdk-ga}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     arm64
master_sites        https://download.java.net/java/GA/jdk17.0.1/2a2082e5a09d4267845be086888add4f/12/GPL/openjdk-17.0.1_macos-aarch64_bin.tar.gz
checksums           sha256  45acad5647960ecde83dc1fb6dda72e5e274798660fa9acff0fb9cc8a37b5794
worksrcdir          ${distname}/jdk-17.0.1.jdk
}

subport openjfx-17-jmods/AArch64 {
version             17.0.1
description         openjfx17
long_description    ${long_description_Openjfx}
home_page           openjfx.io
license             GPL-2+CE
supported_archs     arm64
master_sites        https://download2.gluonhq.com/openjfx/17.0.1/openjfx-17.0.1_osx-aarch64_bin-jmods.zip
checksums           sha256  90c922bdf87686b81deadbffd5c75186f92851852df333b870bf61e98e04c190
worksrcdir          ${distname}/jdk.17.0.1.jdk/contents/home/jmods
}

subport openjdk-17 {
version             17.0.1
description         openjdk 17 build 
long_description    ${long_description_Openjdk-ga}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     x86_64 arm64
set meta true
    if {${configure.build_arch} eq "x86_64"} {
        depends_run-append port:openjdk-17/x64 port:openjfx-17-jmods/x64
    } elseif {${configure.build_arch} eq "arm64"} {
        depends_run-append port:openjdk-17/AArch64 port:openjfx-17-jmods/AArch64
    }
}

subport openjdk-17-graalvm-ce-amd64 {
version             21.3.0
description         openjdk 17 graalvm amd64 community edition build
long_description    ${long_description_GraalVM}
home_page           www.graalvm.org
license             GPL-2 GPL-2+CE BSD-3-Clause UPL
supported_archs     x86_64
master_sites        https://github.com/graalvm/graalvm-ce-builds/releases/download/vm-21.3.0/graalvm-ce-java17-darwin-amd64-21.3.0.tar.gz
worksrcdir          ${distname}/graalvm-ce-java17-21.3.0
}
subport openjdk-17-graalvm-ce {
version             21.3.0
description         openjdk 17 graalvm community edition build
long_description    ${long_description_GraalVM}
home_page           www.graalvm.org
license             GPL-2 GPL-2+CE BSD-3-Clause UPL
supported_archs     x86_64
set meta true
    if {${configure.build_arch} eq "x86_64"} {
        depends_run-append port:openjdk-17-graalvm-ce-amd64
    } elseif {${configure.build_arch} eq "arm64"} {
       known_fail yes
        pre-fetch {
            ui_error "openjdk-17-graalvm-ce is only supported on x86_64 architecture."
            return -code error
    }
}


subport openjdk-18/x64 {
version             18
description         openjdk 18 x64 build
long_description    ${long_description_Openjdk-ea}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     x86_64
master_sites        https://download.java.net/java/early_access/jdk18/30/GPL/openjdk-18-ea+30_macos-x64_bin.tar.gz
checksums           sha256  d733f8b715a746b0c4c4c5c363fc08aed02b88bd14efb0b81b2cdf2cb80a3880
worksrcdir          ${distname}/jdk-18.jdk
}

subport openjfx-18-jmods/x64 {
version             18
description         openjfx18
long_description    ${long_description_Openjfx}
home_page           openjfx.io
license             GPL-2+CE
supported_archs     x86_64
master_sites        https://download2.gluonhq.com/openjfx/18/openjfx-18-ea+9_osx-x64_bin-jmods.zip
checksums           sha256  65600b9b50f9d73329d26fc2174b2fa1a67ac9c4a75dacf140ada44682f0cf04
worksrcdir          ${distname}/jdk.18.jdk/contents/home/jmods
}

subport openjdk-18/AArch64 {
version             18
description         openjdk 18 AArch64 build
long_description    ${long_description_Openjdk-ea}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     arm64
master_sites        https://download.java.net/java/early_access/jdk18/30/GPL/openjdk-18-ea+30_macos-aarch64_bin.tar.gz
checksums           sha256  2d1c87d8ab4e8686eae3908a1d03f9b40ce3eef610628c5923205664cb3bf671
worksrcdir          ${distname}/jdk-18.jdk
}

subport openjfx-18-jmods/AArch64 {
version             18
description         openjfx18
long_description    ${long_description_Openjfx}
home_page           openjfx.io
license             GPL-2+CE
supported_archs     arm64
master_sites        https://download2.gluonhq.com/openjfx/18/openjfx-18-ea+9_osx-aarch64_bin-jmods.zip
checksums           sha256  4f3a449d3ea0f37b7354dd2f856dc6c3a684525546ff4da96dbadacf162ac8b1
worksrcdir          ${distname}/jdk.18.jdk/contents/home/jmods
}

subport openjdk-18 {
version             18
description         openjdk 18 build 
long_description    ${long_description_Openjdk-ga}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     x86_64 arm64
set meta true
    if {${configure.build_arch} eq "x86_64"} {
        depends_run-append port:openjdk-18/x64 port:openjfx-18-jmods/x64
    } elseif {${configure.build_arch} eq "arm64"} {
        depends_run-append port:openjdk-18/AArch64 port:openjfx-18-jmods/AArch64
    }
}


subport openjdk-19-Loom/x64 {
version             19
description         openjdk 19-Loom x64 build
long_description    ${long_description_Loom}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     x86_64
master_sites        https://download.java.net/java/early_access/loom/1/openjdk-19-loom+1-11_macos-x64_bin.tar.gz
checksums           sha256  720cc057597f1b2108eea8fdc121873a351eaafd335df806e2c2230e4b408424
worksrcdir          ${distname}/jdk-19.jdk
}

subport openjdk-19-Loom/AArch64 {
version             19
description         openjdk 19-Loom AArch64 build
long_description    ${long_description_Loom}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     arm64
master_sites        https://download.java.net/java/early_access/loom/1/openjdk-19-loom+1-11_macos-aarch64_bin.tar.gz
checksums           sha256  d049e3363d919f94d127709234a845c5b44af254c1080a3266b59f5936f27c88
worksrcdir          ${distname}/jdk-19.jdk
}

subport openjdk-19-Loom {
version             19
description         openjdk 19-Loom build 
long_description    ${long_description_Loom}
home_page           jdk.java.net
license             GPL-2+CE
supported_archs     x86_64 arm64
set meta true
    if {${configure.build_arch} eq "x86_64"} {
        depends_run-append port:openjdk-19-Loom/x64
    } elseif {${configure.build_arch} eq "arm64"} {
        depends_run-append port:openjdk-19-Loom/AArch64
    }
}
 if {${os.platform} eq "darwin"} {
    # https://trac.macports.org/wiki/PortfileRecipes#compare-osx-darwin-version
    if {[string match *-8-graalvm-ce ${subport}] && ${os.major} < 13}  {
        known_fail yes
        pre-fetch {
            ui_error "${name} ${version} is only supported on Mac OS X 10.9 Mavericks or later."
            return -code error
            }
    } elseif {[string match *-9 ${subport}] && ${os.major} < 14}  {
        known_fail yes
        pre-fetch {
            ui_error "${name} ${version} is only supported on Mac OS X 10.10 Yosemite or later."
            return -code error
            }

    } elseif {[string match *-10 ${subport}] && ${os.major} < 14}  {
        known_fail yes
        pre-fetch {
            ui_error "${name} ${version} is only supported on Mac OS X 10.10 Yosemite or later."
            return -code error
            }
    } elseif {[string match *-11 ${subport}] && ${os.major} < 15}  {
        known_fail yes
        pre-fetch {
            ui_error "${name} ${version} is only supported on Mac OS X 10.11 El Capitan or later."
            return -code error
            }
    } elseif {[string match *-11-graalvm-ce ${subport}] && ${os.major} < 15}  {
        known_fail yes
        pre-fetch {
            ui_error "${name} ${version} is only supported on Mac OS X 10.11 El Capitan or later."
            return -code error
            }
    } elseif {[string match *-12 ${subport}] && ${os.major} < 16}  {
        known_fail yes
        pre-fetch {
            ui_error "${name} ${version} is only supported on Mac OS X 10.12 Sierra or later."
            return -code error
            }
    } elseif {[string match *-13 ${subport}] && ${os.major} < 17}  {
        known_fail yes
        pre-fetch {
            ui_error "${name} ${version} is only supported on Mac OS X 10.13 High Sierra or later."
            return -code error
            }
    } elseif {[string match *-14-Valhalla ${subport}] && ${os.major} < 17}  {
        known_fail yes
        pre-fetch {
            ui_error "${name} ${version} is only supported on Mac OS X 10.13 High Sierra or later."
            return -code error
            }
    } elseif {[string match *-14 ${subport}] && ${os.major} < 17}  {
        known_fail yes
        pre-fetch {
            ui_error "${name} ${version} is only supported on Mac OS X 10.13 High Sierra or later."
            return -code error
            }
    } elseif {[string match *-15 ${subport}] && ${os.major} < 17}  {
        known_fail yes
        pre-fetch {
            ui_error "${name} ${version} is only supported on Mac OS X 10.13 High Sierra or later."
            return -code error
            }
    } elseif {[string match *-16 ${subport}] && ${os.major} < 17}  {
        known_fail yes
        pre-fetch {
            ui_error "${name} ${version} is only supported on Mac OS X 10.13 High Sierra or later."
            return -code error
            }
    } elseif {[string match *-16-graalvm-ce ${subport}] && ${os.major} < 17}  {
        known_fail yes
        pre-fetch {
            ui_error "${name} ${version} is only supported on Mac OS X 10.13 High Sierra or later."
            return -code error
            }
    } elseif {[string match *-17-Panama ${subport}] && ${os.major} < 18}  {
        known_fail yes
        pre-fetch {
            ui_error "${name} ${version} is only supported on Mac OS X 10.14 Mojave or later."
            return -code error
            }
   } elseif {[string match *-17 ${subport}] && ${os.major} < 18}  {
        known_fail yes
        pre-fetch {
            ui_error "${name} ${version} is only supported on Mac OS X 10.14 Mojave or later."
            return -code error
            }
   } elseif {[string match *-17-graalvm-ce ${subport}] && ${os.major} < 18}  {
        known_fail yes
        pre-fetch {
            ui_error "${name} ${version} is only supported on Mac OS X 10.14 Mojave or later."
            return -code error
            }
}

{
    test.run    yes
    test.cmd    Contents/Home/bin/java
    test.target
    test.args   -version

  # macOS Java tools expect to find Java virtual machines under /Library/Java/JavaVirtualMachines, which is not under ${prefix}.
    destroot.violate_mtree yes

 set target /Library/Java/JavaVirtualMachines/${subport}
 set destroot_target ${destroot}${target}

 destroot {
     xinstall -m 755 -d ${destroot_target}
     xinstall -m 755 ${worksrcpath}/README ${destroot}${prefix}/share/doc/${name}
     copy ${worksrcpath}/Contents ${destroot_target}
 }

 if {[string match openjdk-* ${subport}]} {
         notes "
     If you have more than one JDK installed you can make ${subport} the default
     by adding the following line to your shell profile:
         export JAVA_HOME=${target}/Contents/Home
     "
 }
}
