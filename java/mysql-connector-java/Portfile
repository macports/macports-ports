# $Id$

PortSystem 1.0

name				mysql-connector-java
version				5.1.10
set branch          [join [lrange [split ${version} .] 0 1] .]

categories			java
maintainers			jberry openmaintainer
platforms			darwin

description			MySQL Official JDBC connector for MySQL database.
long_description	MySQL Connector/J is a native Java driver that converts JDBC \
					(Java Database Connectivity) calls into the network protocol \
					used by the MySQL database. It lets developers working with \
					the Java programming language easily build programs and applets \
					that interact with MySQL and connect all corporate data, even \
					in a heterogeneous environment. MySQL Connector/J is a Type IV \
					JDBC driver and has a complete JDBC feature set that supports \
					the capabilities of MySQL.
homepage			http://dev.mysql.com/doc/refman/${branch}/en/connector-j.html

master_sites		http://ftp.plusline.de/mysql/Downloads/Connector-J/
checksums           md5     f9da616de868ddd1acf1428334f3313d \
                    sha1    32938f3004c70a657a7481496bc3813b85df20de \
                    rmd160  ef5b6cf4cceaac0c6d32858920c362bab6004bc1

patchfiles			patch-build.xml

depends_build		bin:ant:apache-ant
depends_lib			bin:java:kaffe \
					port:junit \
					port:jakarta-log4j


set javaLibs		${prefix}/share/java

use_configure		no

build.cmd			ant
build.target		dist
build.args			-Djunit.jar=${javaLibs}/junit.jar \
					-Dlog4j.jar=${javaLibs}/jakarta-log4j.jar					

destroot {
	xinstall -m 755 -d ${destroot}${prefix}/share/java \
		${destroot}${prefix}/share/doc
	xinstall -m 644 ${worksrcpath}/build/${distname}/${distname}-bin.jar \
		${destroot}${prefix}/share/java/${name}-5.0.jar
	file copy ${worksrcpath}/docs ${destroot}${prefix}/share/doc/${name}
}

platform darwin 10 {
	post-patch {
		reinplace -E {/name="compile"/s/compile-testsuite, //} \
			${worksrcpath}/build.xml
	}

	patchfiles-append patch-JDK-1.6.diff
}

livecheck.type  regex
livecheck.url   http://dev.mysql.com/downloads/connector/j/${branch}.html
livecheck.regex "${name}-(\\d+\\.\\d+(\\.\\d+)?).tar.gz"
