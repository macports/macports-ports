# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0

name                Openjdk-Boot
version             17
revision            0
categories          java devel 
platforms           darwin
supported_archs     noarch
license             GPL-2
maintainers         nomaintainer openmaintainer
description         Open Source, Open Innovation, Open Standards implementation of the Java Platform, Standard Edition, and related projects.
long_description    boot jdk for Update builds of Openjdk, Open Source, Open Innovation, Open Standards implementation of the Java Platform, Standard Edition, and related projects provided by build group
homepage            openjdk.java.net
use_xcode           no
use_configure    no

set long_description_openjdk-ga \
    "Production-ready open-source builds of the openjdk, \
    Open Source, Open Innovation, Open Standards \
    implementation of the Java Platform, Standard Edition, and related projects."

set long_description_openjdk-adoption \
    "Java™ is the world's leading programming language and platform. \
    AdoptOpenJDK uses infrastructure, build and test scripts \
    to produce prebuilt binaries from OpenJDK™ class libraries and a choice of OpenJDK"

set obsoleted_ports {
    Openjdk-Boot
    Openjdk12u-boot
    Openjdk14u-boot
    Openjdk16u-boot
}

if {${subport} eq "Openjdk-boot"} {
    # The openjdk-boot port is not installable, but recommends users to install the latest Boot JDK subport
    replaced_by         openjdk${version}u-boot
}

subport openjdk8u-boot-adoption {
    version             8u202
    set build           b08
    description         AdoptOpenJDK build of jdk 8
    long_description    ${long_description_openjdk-adoption}
    homepage            https://adoptopenjdk.net/
    supported_archs     x86_64
    master_sites        https://github.com/AdoptOpenJDK/openjdk8-binaries/releases/download/jdk8u202-b08/
    
    checksums           rmd160  b7891a7828ad11f619d75ec019488fb92bfccceb \
                        sha256  059f7c18faa6722aa636bbd79bcdff3aee6a6da5b34940b072ea6e3af85bbe1d \
                        size    101955075

    distname            OpenJDK8U-jdk_x64_mac_hotspot_8u202b08
    worksrcdir          jdk${version}-${build}
    use_xcode           no
    use_configure    no
}


subport openjdk11u-boot {
    version             11.0.2
    set build           9
    description         openjdk 11 builds
    long_description    ${long_description_openjdk-ga}
    homepage            jdk.java.net
    supported_archs     x86_64
    master_sites        https://download.java.net/java/GA/jdk11/${build}/GPL/
        
    checksums           rmd160  e20276958ef069ed748d881ef1eaac7dea6e121d \
                        sha256  f365750d4be6111be8a62feda24e265d97536712bc51783162982b8ad96a70ee \
                        size    182670822

    distname            openjdk-11.0.2_osx-x64_bin
    worksrcdir          jdk-11.0.2.jdk
    use_xcode           no
    use_configure    no
}

subport openjdk12u-boot {
    version             12.0.2
    homepage            jdk.java.net
    replaced_by         openjdk-13u-boot
}

subport Openjdk13u-boot {
    version             13.0.2
    set build           8
    description         openjdk 13 builds
    long_description    ${long_description_openjdk-ga}
    homepage            jdk.java.net
    supported_archs     x86_64
    master_sites        https://download.java.net/java/GA/jdk${version}/d4173c853231432d94f001e99d882ca7/${build}/GPL/
        
    checksums           rmd160  c2e64b7097507ac8143f7413202747e4dc71c260 \
                        sha256  08fd2db3a3ab6fb82bb9091a035f9ffe8ae56c31725f4e17d573e48c39ca10dd \
                        size    189969691

    distname            openjdk-13.0.2_osx-x64_bin
    worksrcdir          jdk-13.0.2.jdk
    use_xcode           no
    use_configure    no
}

subport Openjdk14u-boot {
    version             14.0.2
    homepage            jdk.java.net
    replaced_by         openjdk-15u-boot
}

subport Openjdk15u-boot {
    version             15.0.2
    set build           7
    description         openjdk 15 builds
    long_description    ${long_description_openjdk-ga}
    homepage            jdk.java.net
    supported_archs     x86_64
    master_sites        https://download.java.net/java/GA/jdk${version}/0d1cfde4252546c6931946de8db48ee2/${build}/GPL/
        
    checksums           rmd160  42a09647ae7a4a8f56da6ccf2c4401a3db8a9aa9 \
                        sha256  578b17748f5a7d111474bc4c9b5a8a06b4a4aa1ba4a4bc3fef014e079ece7c74 \
                        size    192067136

    distname            openjdk-15.0.2_osx-x64_bin
    worksrcdir          jdk-15.0.2.jdk
    use_xcode           no
    use_configure    no
}

subport Openjdk16u-boot {
    version             16.0.2
    homepage            jdk.java.net
    replaced_by         openjdk17-oracle
}

build {}

if {[string match *-adoption ${subport}]} {
    # macOS Java tools expect to find Java virtual machines under /Library/Java/JavaVirtualMachines, which is not under ${prefix}.
    destroot.violate_mtree yes

    set target /Library/Java/JavaVirtualMachines/
    set destroot_target ${destroot}${target}

    destroot {
        xinstall -m 755 -d ${destroot_target}
        copy ${worksrcpath} ${destroot_target}
    }

    notes "
        If you have more than one JDK installed you can make ${subport} the default by adding the following line to your shell profile:
        export JAVA_HOME=${destroot_target}/jdk-${version}-${build}.jdk/Contents/Home
    "
} elseif {[string match *-boot ${subport}]} {
    # macOS Java tools expect to find Java virtual machines under /Library/Java/JavaVirtualMachines, which is not under ${prefix}.
    destroot.violate_mtree yes

    set target /Library/Java/JavaVirtualMachines/
    set destroot_target ${destroot}${target}

    destroot {
        xinstall -m 755 -d ${destroot_target}
        copy ${worksrcpath} ${destroot_target}
    }

    notes "
        If you have more than one JDK installed you can make ${subport} the default by adding the following line to your shell profile:
        export JAVA_HOME=${destroot_target}/jdk-${version}.jdk/Contents/Home
    "
}   
