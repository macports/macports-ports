# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0

name                mecab-java
version             0.98
revision            2
epoch               1
categories          java textproc japanese
platforms           darwin
maintainers         hum openmaintainer
license             GPL-2 LGPL-2.1 BSD

description         a Java module for MeCab
long_description    ${name} is ${description}.

homepage            http://mecab.sourceforge.net/
master_sites        sourceforge:mecab/mecab-win32/${version}
dist_subdir         mecab
checksums           rmd160  50606cb61adab2b495963a2e79ae09899a9683ae \
                    sha256  5f19050f8c3f50756f8cd54288c3b3e11c19d01e2940d4821af0a90a4e4940ba

depends_lib         port:mecab-utf8

patchfiles          patch-Makefile.diff \
                    patch-test.java.diff

post-patch {
    reinplace "s|@java_library_path@|${prefix}/lib|g" ${worksrcpath}/test.java
}

use_configure       no

variant universal   {}

build.args          CXX="${configure.cxx}" \
                    CXXFLAGS="${configure.cxxflags} [get_canonical_archflags cxx]"

test.run            yes

destroot    {
    xinstall -m 755 -d \
        ${destroot}${prefix}/share/java \
        ${destroot}${prefix}/share/doc/${name}
    xinstall -m 644 -W ${worksrcpath} \
        AUTHORS BSD COPYING GPL LGPL bindings.html test.java \
        ${destroot}${prefix}/share/doc/${name}
    xinstall -m 644 ${worksrcpath}/MeCab.jar \
        ${destroot}${prefix}/share/java/mecab.jar
    xinstall -m 644 ${worksrcpath}/lib${name}.dylib \
        ${destroot}${prefix}/lib
}

livecheck.type      regex
livecheck.url       http://sourceforge.net/projects/mecab/files/mecab-java
livecheck.regex     ${name}\\/(\[0-9.\]+)
