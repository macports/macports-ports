# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           github 1.0
PortGroup           cargo 1.0

github.setup        BurntSushi ripgrep 11.0.2
categories          textproc
platforms           darwin
maintainers         {raimue @raimue} \
                    openmaintainer
license             MIT

description         fast command line search tool
long_description    ripgrep is a command line search tool that combines the \
                    usability of The Silver Searcher (an ack clone) with the \
                    raw speed of GNU grep.

cargo.crates \
    aho-corasick                  0.7.4    36b7aa1ccb7d7ea3f437cf025a2ab1c47cc6c1bc9fc84918ff449def12f5e282  \
    atty                          0.2.13   1803c647a3ec87095e7ae7acfca019e98de5ec9a7d01343f611cf3152ed71a90  \
    base64                        0.10.1   0b25d992356d2eb0ed82172f5248873db5560c4721f564b13cb5193bda5e668e  \
    bitflags                      1.1.0    3d155346769a6855b86399e9bc3814ab343cd3d62c7e985113d46a0ec3c281fd  \
    bstr                          0.2.6    e0a692f1c740e7e821ca71a22cf99b9b2322dfa94d10f71443befb1797b3946a  \
    bytecount                     0.5.1    be0fdd54b507df8f22012890aadd099979befdba27713c767993f8380112ca7c  \
    byteorder                     1.3.2    a7c3dd8985a7111efc5c80b44e23ecdd8c007de8ade3b96595387e812b957cf5  \
    c2-chacha                     0.2.2    7d64d04786e0f528460fc884753cf8dddcc466be308f6026f8e355c41a0e4101  \
    cc                            1.0.38   ce400c638d48ee0e9ab75aef7997609ec57367ccfe1463f21bf53c3eca67bf46  \
    cfg-if                        0.1.9    b486ce3ccf7ffd79fdeb678eac06a9e6c09fc88d33836340becb8fffe87c5e33  \
    clap                          2.33.0   5067f5bb2d80ef5d68b4c87db81601f0b75bca627bc2ef76b141d7b846a3c6d9  \
    crossbeam-channel             0.3.9    c8ec7fcd21571dc78f96cc96243cab8d8f035247c3efd16c687be154c3fa9efa  \
    crossbeam-utils               0.6.6    04973fa96e96579258a5091af6003abde64af786b860f18622b82e026cca60e6  \
    encoding_rs                   0.8.17   4155785c79f2f6701f185eb2e6b4caf0555ec03477cb4c70db67b465311620ed  \
    encoding_rs_io                0.1.6    9619ee7a2bf4e777e020b95c1439abaf008f8ea8041b78a0552c4f1bcf4df32c  \
    fnv                           1.0.6    2fad85553e09a6f881f739c29f0b00b0f01357c743266d478b68951ce23285f3  \
    fs_extra                      1.1.0    5f2a4a2034423744d2cc7ca2068453168dcdb82c438419e639a26bd87839c674  \
    getrandom                     0.1.7    cd8e190892c840661957ba9f32dacfb3eb405e657f9f9f60485605f0bb37d6f8  \
    glob                          0.3.0    9b919933a397b79c37e33b77bb2aa3dc8eb6e165ad809e58ff75bc7db2e34574  \
    itoa                          0.4.4    501266b7edd0174f8530248f87f99c88fbe60ca4ef3dd486835b8d8d53136f7f  \
    jemalloc-sys                  0.3.2    0d3b9f3f5c9b31aa0f5ed3260385ac205db665baa41d49bb8338008ae94ede45  \
    jemallocator                  0.3.2    43ae63fcfc45e99ab3d1b29a46782ad679e98436c3169d15a167a1108a724b69  \
    lazy_static                   1.3.0    bc5729f27f159ddd61f4df6228e827e86643d4d3e7c32183cb30a1c08f604a14  \
    libc                          0.2.60   d44e80633f007889c7eff624b709ab43c92d708caad982295768a7b13ca3b5eb  \
    log                           0.4.8    14b6052be84e6b71ab17edffc2eeabf5c2c3ae1fdb464aae35ac50c67a44e1f7  \
    memchr                        2.2.1    88579771288728879b57485cc7d6b07d648c9f0141eb955f8ab7f9d45394468e  \
    memmap                        0.7.0    6585fd95e7bb50d6cc31e20d4cf9afb4e2ba16c5846fc76793f11218da9c475b  \
    num_cpus                      1.10.1   bcef43580c035376c0705c42792c294b66974abbfd2789b511784023f71f3273  \
    packed_simd                   0.3.3    a85ea9fc0d4ac0deb6fe7911d38786b32fc11119afd9e9d38b84ff691ce64220  \
    pcre2                         0.2.1    603da5e101220b9b306bf28e4f1f8703458ce2f64d2787b374e1a19494317180  \
    pcre2-sys                     0.2.2    876c72d05059d23a84bd9fcdc3b1d31c50ea7fe00fe1522b4e68cd3608db8d5b  \
    pkg-config                    0.3.15   a7c1d2cfa5a714db3b5f24f0915e74fcdf91d09d496ba61329705dda7774d2af  \
    ppv-lite86                    0.2.5    e3cbf9f658cdb5000fcf6f362b8ea2ba154b9f146a61c7a20d647034c6b6561b  \
    proc-macro2                   0.4.30   cf3d2011ab5c909338f7887f4fc896d35932e29146c12c8d01da6b22a80ba759  \
    quote                         0.6.13   6ce23b6b870e8f94f81fb0a363d65d86675884b34a09043c81e5562f11c1f8e1  \
    rand                          0.7.0    d47eab0e83d9693d40f825f86948aa16eff6750ead4bdffc4ab95b8b3a7f052c  \
    rand_chacha                   0.2.1    03a2a90da8c7523f554344f921aa97283eadf6ac484a6d2a7d0212fa7f8d6853  \
    rand_core                     0.5.0    615e683324e75af5d43d8f7a39ffe3ee4a9dc42c5c701167a71dc59c3a493aca  \
    rand_hc                       0.2.0    ca3129af7b92a17112d59ad498c6f81eaf463253766b90396d39ea7a39d6613c  \
    redox_syscall                 0.1.56   2439c63f3f6139d1b57529d16bc3b8bb855230c8efcc5d3a896c8bea7c3b1e84  \
    regex                         1.2.0    6b23da8dfd98a84bd7e08700190a5d9f7d2d38abd4369dd1dae651bc40bfd2cc  \
    regex-automata                0.1.8    92b73c2a1770c255c240eaa4ee600df1704a38dc3feaa6e949e7fcd4f8dc09f9  \
    regex-syntax                  0.6.10   cd5485bf1523a9ed51c4964273f22f63f24e31632adb5dad134f488f86a3875c  \
    remove_dir_all                0.5.2    4a83fa3702a688b9359eccba92d153ac33fd2e8462f9e0e3fdf155239ea7792e  \
    ryu                           1.0.0    c92464b447c0ee8c4fb3824ecc8383b81717b9f1e74ba2e72540aef7b9f82997  \
    same-file                     1.0.5    585e8ddcedc187886a30fa705c47985c3fa88d06624095856b36ca0b82ff4421  \
    serde                         1.0.98   7fe5626ac617da2f2d9c48af5515a21d5a480dbd151e01bb1c355e26a3e68113  \
    serde_derive                  1.0.98   01e69e1b8a631f245467ee275b8c757b818653c6d704cdbcaeb56b56767b529c  \
    serde_json                    1.0.40   051c49229f282f7c6f3813f8286cc1e3323e8051823fce42c7ea80fe13521704  \
    strsim                        0.8.0    8ea5119cdb4c55b55d432abb513a0429384878c15dde60cc77b1c99de1a95a6a  \
    syn                           0.15.42  eadc09306ca51a40555dd6fc2b415538e9e18bc9f870e47b1a524a79fe2dcf5e  \
    tempfile                      3.1.0    7a6e24d9338a0a5be79593e2fa15a648add6138caa803e2d5bc782c371732ca9  \
    termcolor                     1.0.5    96d6098003bde162e4277c70665bd87c326f5a0c3f3fbfb285787fa482d54e6e  \
    textwrap                      0.11.0   d326610f408c7a4eb6f51c37c330e496b08506c9457c9d34287ecc38809fb060  \
    thread_local                  0.3.6    c6b53e329000edc2b34dbe8545fd20e55a333362d0a321909685a19bd28c3f1b  \
    ucd-util                      0.1.5    fa9b3b49edd3468c0e6565d85783f51af95212b6fa3986a5500954f00b460874  \
    unicode-width                 0.1.5    882386231c45df4700b275c7ff55b6f3698780a650026380e72dabe76fa46526  \
    unicode-xid                   0.1.0    fc72304796d0818e357ead4e000d19c9c174ab23dc11093ac919054d20a6a7fc  \
    utf8-ranges                   1.0.3    9d50aa7650df78abf942826607c62468ce18d9019673d4a2ebe1865dbb96ffde  \
    walkdir                       2.2.9    9658c94fa8b940eab2250bd5a457f9c48b748420d71293b165c8cdbe2f55f71e  \
    winapi                        0.3.7    f10e386af2b13e47c89e7236a7a14a086791a2b88ebad6df9bf42040195cf770  \
    winapi-i686-pc-windows-gnu    0.4.0    ac3b87c63620426dd9b991e5ce0329eff545bccbbb34f3be09ff6fb6ab51b7b6  \
    winapi-util                   0.1.2    7168bab6e1daee33b4557efd0e95d5ca70a03706d39fa5f3fe7a236f584b03c9  \
    winapi-x86_64-pc-windows-gnu  0.4.0    712e227841d057c1ee1cd2fb22fa7e5a5461ae8e48fa2ca79ec42cfc1931183f  \
    wincolor                      1.0.1    561ed901ae465d6185fa7864d63fbd5720d0ef718366c9a4dc83cf6170d7e9ba

checksums-append    ${distname}${extract.suffix} \
                    rmd160  866a968b33787a18efecfdfb5305d9a7a16569bf \
                    sha256  ef846618e0e8b8ed2d4aaa6394ddc04765253007fe54beec6923b765fa1fabb5 \
                    size    461941

depends_build-append \
                    port:asciidoc \
                    port:docbook-xsl-nons

destroot {
    xinstall -m 755 ${worksrcpath}/target/[cargo.rust_platform]/release/rg ${destroot}${prefix}/bin/
    ln -s rg ${destroot}${prefix}/bin/ripgrep

    set outpath [glob ${worksrcpath}/target/[cargo.rust_platform]/release/build/ripgrep-*]/out/
    xinstall -m 644 ${outpath}/rg.1 ${destroot}${prefix}/share/man/man1/
    xinstall -d -m 755 ${destroot}${prefix}/share/bash-completion/completions
    xinstall -m 644 ${outpath}/rg.bash ${destroot}${prefix}/share/bash-completion/completions/rg
    xinstall -d -m 755 ${destroot}${prefix}/share/fish/completions
    xinstall -m 644 ${outpath}/rg.fish ${destroot}${prefix}/share/fish/completions/
    xinstall -d -m 755 ${destroot}${prefix}/share/zsh/site-functions
    xinstall -m 644 ${worksrcpath}/complete/_rg ${destroot}${prefix}/share/zsh/site-functions/
}

variant pcre {
    build.args-append       --features 'pcre2'
    depends_lib-append      port:pcre2
}
