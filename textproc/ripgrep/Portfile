# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           github 1.0
PortGroup           cargo 1.0

github.setup        BurntSushi ripgrep 14.0.3
github.tarball_from archive
revision            0
categories          textproc
platforms           darwin
maintainers         {raimue @raimue} \
                    openmaintainer
license             MIT

description         fast command line search tool
long_description    ripgrep is a command line search tool that combines the \
                    usability of The Silver Searcher (an ack clone) with the \
                    raw speed of GNU grep.

cargo.crates \
    aho-corasick                                1.1.2  b2969dcb958b36655471fc61f7e416fa76033bdd4bfed0678d8fee1e2d07a1f0 \
    anyhow                                     1.0.75  a4668cab20f66d8d020e1fbc0ebe47217433c1b6c8f2040faf858554e394ace6 \
    autocfg                                     1.1.0  d468802bab17cbc0cc575e9b053f41e72aa36bfa6b7f55e3529ffa43161b97fa \
    bstr                                        1.8.0  542f33a8835a0884b006a0c3df3dadd99c0c3f296ed26c2fdc8028e01ad6230c \
    cc                                         1.0.83  f1174fb0b6ec23863f8b971027804a42614e347eafb0a95bf0b12cdae21fc4d0 \
    cfg-if                                      1.0.0  baf1de4339761588bc0619e3cbc0120ee582ebb74b53b4efbf79117bd2da40fd \
    crossbeam-channel                           0.5.8  a33c2bf77f2df06183c3aa30d1e96c0695a313d4f9c453cc3762a6db39f99200 \
    crossbeam-deque                             0.8.3  ce6fd6f855243022dcecf8702fef0c297d4338e226845fe067f6341ad9fa0cef \
    crossbeam-epoch                            0.9.15  ae211234986c545741a7dc064309f67ee1e5ad243d0e48335adc0484d960bcc7 \
    crossbeam-utils                            0.8.16  5a22b2d63d4d1dc0b7f1b6b2747dd0088008a9be28b6ddf0b1e7d335e3037294 \
    encoding_rs                                0.8.33  7268b386296a025e474d5140678f75d6de9493ae55a5d709eeb9dd08149945e1 \
    encoding_rs_io                              0.1.7  1cc3c5651fb62ab8aa3103998dade57efdd028544bd300516baa31840c252a83 \
    glob                                        0.3.1  d2fabcfbdc87f4758337ca535fb41a6d701b65693ce38287d856d1674551ec9b \
    itoa                                        1.0.9  af150ab688ff2122fcef229be89cb50dd66af9e01a4ff320cc137eecc9bacc38 \
    jemalloc-sys                  0.5.4+5.3.0-patched  ac6c1946e1cea1788cbfde01c993b52a10e2da07f4bac608228d1bed20bfebf2 \
    jemallocator                                0.5.4  a0de374a9f8e63150e6f5e8a60cc14c668226d7a347d8aee1a45766e3c4dd3bc \
    jobserver                                  0.1.27  8c37f63953c4c63420ed5fd3d6d398c719489b9f872b9fa683262f8edd363c7d \
    lexopt                                      0.3.0  baff4b617f7df3d896f97fe922b64817f6cd9a756bb81d40f8883f2f66dcb401 \
    libc                                      0.2.150  89d92a4743f9a61002fae18374ed11e7973f530cb3a3255fb354818118b2203c \
    libm                                        0.2.8  4ec2a862134d2a7d32d7983ddcdd1c4923530833c9f2ea1a44fc5fa473989058 \
    log                                        0.4.20  b5e6163cb8c49088c2c36f57875e58ccd8c87c7427f7fbd50ea6710b2f3f2e8f \
    memchr                                      2.6.4  f665ee40bc4a3c5590afb1e9677db74a508659dfd71e126420da8274909a0167 \
    memmap2                                     0.9.0  deaba38d7abf1d4cca21cc89e932e542ba2b9258664d2a9ef0e61512039c9375 \
    memoffset                                   0.9.0  5a634b1c61a95585bd15607c6ab0c4e5b226e695ff2800ba0cdccddf208c406c \
    num-traits                                 0.2.17  39e3200413f237f41ab11ad6d161bc7239c84dcb631773ccd7de3dfe4b5c267c \
    packed_simd                                 0.3.9  1f9f08af0c877571712e2e3e686ad79efad9657dbf0f7c3c8ba943ff6c38932d \
    pcre2                                       0.2.6  4c9d53a8ea5fc3d3568d3de4bebc12606fd0eb8234c602576f1f1ee4880488a7 \
    pcre2-sys                                   0.2.7  8f8f5556f23cf2c0b481949fdfc19a7cd9b27ddcb00ef3477b0f4935cbdaedf2 \
    pkg-config                                 0.3.27  26072860ba924cbfa98ea39c8c19b4dd6a4a25423dbdf219c1eca91aa0cf6964 \
    proc-macro2                                1.0.70  39278fbbf5fb4f646ce651690877f89d1c5811a3d4acb27700c1cb3cdb78fd3b \
    quote                                      1.0.33  5267fca4496028628a95160fc423a33e8b2e6af8a5302579e322e4b520293cae \
    regex                                      1.10.2  380b951a9c5e80ddfd6136919eef32310721aa4aacd4889a8d39124b026ab343 \
    regex-automata                              0.4.3  5f804c7828047e88b2d32e2d7fe5a105da8ee3264f01902f796c8e067dc2483f \
    regex-syntax                                0.8.2  c08c74e62047bb2de4ff487b251e4a92e24f48745648451635cec7d591162d9f \
    ryu                                        1.0.15  1ad4cc8da4ef723ed60bced201181d83791ad433213d8c24efffda1eec85d741 \
    same-file                                   1.0.6  93fc1dc3aaa9bfed95e02e6eadabb4baf7e3078b0bd1b4d7b6b0b68378900502 \
    scopeguard                                  1.2.0  94143f37725109f92c262ed2cf5e59bce7498c01bcc1502d7b9afe439a4e9f49 \
    serde                                     1.0.193  25dd9975e68d0cb5aa1120c288333fc98731bd1dd12f561e468ea4728c042b89 \
    serde_derive                              1.0.193  43576ca501357b9b071ac53cdc7da8ef0cbd9493d8df094cd821777ea6e894d3 \
    serde_json                                1.0.108  3d1c7e3eac408d115102c4c24ad393e0821bb3a5df4d506a80f85f7a742a526b \
    syn                                        2.0.39  23e78b90f2fcf45d3e842032ce32e3f2d1545ba6636271dcbf24fa306d87be7a \
    termcolor                                   1.4.0  ff1bc3d3f05aff0403e8ac0d92ced918ec05b666a43f83297ccef5bea8a3d449 \
    textwrap                                   0.16.0  222a222a5bfe1bba4a77b45ec488a741b3cb8872e5e499451fd7d0129c9c7c3d \
    unicode-ident                              1.0.12  3354b9ac3fae1ff6755cb6db53683adb661634f67557942dea4facebec0fee4b \
    walkdir                                     2.4.0  d71d857dc86794ca4c280d616f7da00d2dbfd8cd788846559a6813e6aa4b54ee \
    winapi                                      0.3.9  5c839a674fcd7a98952e593242ea400abe93992746761e38641405d28b00f419 \
    winapi-i686-pc-windows-gnu                  0.4.0  ac3b87c63620426dd9b991e5ce0329eff545bccbbb34f3be09ff6fb6ab51b7b6 \
    winapi-util                                 0.1.6  f29e6f9198ba0d26b4c9f07dbe6f9ed633e1f3d5b8b414090084349e46a52596 \
    winapi-x86_64-pc-windows-gnu                0.4.0  712e227841d057c1ee1cd2fb22fa7e5a5461ae8e48fa2ca79ec42cfc1931183f

checksums-append    ${distname}${extract.suffix} \
                    rmd160  01824c542a12b8c192ea49a68b9c1c92c359a8c9 \
                    sha256  f5794364ddfda1e0411ab6cad6dd63abe3a6b421d658d9fee017540ea4c31a0e \
                    size    583882

depends_build-append \
                    port:asciidoc \
                    port:docbook-xsl-nons

destroot {
    xinstall -m 755 ${worksrcpath}/target/[cargo.rust_platform]/release/rg ${destroot}${prefix}/bin/
    ln -s rg ${destroot}${prefix}/bin/ripgrep

    set outpath [glob ${worksrcpath}/target/[cargo.rust_platform]/release/build/ripgrep-*]/out/
    xinstall -m 644 ${outpath}/rg.1 ${destroot}${prefix}/share/man/man1/
    xinstall -d -m 755 ${destroot}${prefix}/share/bash-completion/completions
    xinstall -m 644 ${outpath}/rg.bash ${destroot}${prefix}/share/bash-completion/completions/rg
    xinstall -d -m 755 ${destroot}${prefix}/share/fish/vendor_completions.d
    xinstall -m 644 ${outpath}/rg.fish ${destroot}${prefix}/share/fish/vendor_completions.d/
    xinstall -d -m 755 ${destroot}${prefix}/share/zsh/site-functions
    xinstall -m 644 ${worksrcpath}/complete/_rg ${destroot}${prefix}/share/zsh/site-functions/
}

variant pcre {
    build.args-append       --features 'pcre2'
    depends_lib-append      port:pcre2
}
