# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           github 1.0
PortGroup           cargo 1.0

github.setup        BurntSushi ripgrep 11.0.1
categories          textproc
platforms           darwin
maintainers         {raimue @raimue} \
                    openmaintainer
license             MIT

description         fast command line search tool
long_description    ripgrep is a command line search tool that combines the \
                    usability of The Silver Searcher (an ack clone) with the \
                    raw speed of GNU grep.

cargo.crates \
    aho-corasick                 0.7.3 e6f484ae0c99fec2e858eb6134949117399f222608d84cadb3f58c1f97c2364c \
    atty                         0.2.11 9a7d5b8723950951411ee34d271d99dddcc2035a16ab25310ea2c8cfd4369652 \
    autocfg                      0.1.2 a6d640bee2da49f60a4068a7fae53acde8982514ab7bae8b8cea9e88cbcfd799 \
    base64                       0.10.1 0b25d992356d2eb0ed82172f5248873db5560c4721f564b13cb5193bda5e668e \
    bitflags                     1.0.4 228047a76f468627ca71776ecdebd732a3423081fcf5125585bcd7c49886ce12 \
    bstr                         0.1.2 6c8203ca06c502958719dae5f653a79e0cc6ba808ed02beffbf27d09610f2143 \
    bytecount                    0.5.1 be0fdd54b507df8f22012890aadd099979befdba27713c767993f8380112ca7c \
    byteorder                    1.3.1 a019b10a2a7cdeb292db131fc8113e57ea2a908f6e7894b0c3c671893b65dbeb \
    cc                           1.0.35 5e5f3fee5eeb60324c2781f1e41286bdee933850fff9b3c672587fed5ec58c83 \
    cfg-if                       0.1.7 11d43355396e872eefb45ce6342e4374ed7bc2b3a502d1b28e36d6e23c05d1f4 \
    clap                         2.33.0 5067f5bb2d80ef5d68b4c87db81601f0b75bca627bc2ef76b141d7b846a3c6d9 \
    cloudabi                     0.0.3 ddfc5b9aa5d4507acaf872de71051dfd0e309860e88966e1051e462a077aac4f \
    crossbeam-channel            0.3.8 0f0ed1a4de2235cabda8558ff5840bffb97fcb64c97827f354a451307df5f72b \
    crossbeam-utils              0.6.5 f8306fcef4a7b563b76b7dd949ca48f52bc1141aa067d2ea09565f3e2652aa5c \
    encoding_rs                  0.8.17 4155785c79f2f6701f185eb2e6b4caf0555ec03477cb4c70db67b465311620ed \
    encoding_rs_io               0.1.6 9619ee7a2bf4e777e020b95c1439abaf008f8ea8041b78a0552c4f1bcf4df32c \
    fnv                          1.0.6 2fad85553e09a6f881f739c29f0b00b0f01357c743266d478b68951ce23285f3 \
    fuchsia-cprng                0.1.1 a06f77d526c1a601b7c4cdd98f54b5eaabffc14d5f2f0296febdc7f357c6d3ba \
    glob                         0.3.0 9b919933a397b79c37e33b77bb2aa3dc8eb6e165ad809e58ff75bc7db2e34574 \
    itoa                         0.4.3 1306f3464951f30e30d12373d31c79fbd52d236e5e896fd92f96ec7babbbe60b \
    lazy_static                  1.3.0 bc5729f27f159ddd61f4df6228e827e86643d4d3e7c32183cb30a1c08f604a14 \
    libc                         0.2.51 bedcc7a809076656486ffe045abeeac163da1b558e963a31e29fbfbeba916917 \
    log                          0.4.6 c84ec4b527950aa83a329754b01dbe3f58361d1c5efacd1f6d68c494d08a17c6 \
    memchr                       2.2.0 2efc7bc57c883d4a4d6e3246905283d8dae951bb3bd32f49d6ef297f546e1c39 \
    memmap                       0.7.0 6585fd95e7bb50d6cc31e20d4cf9afb4e2ba16c5846fc76793f11218da9c475b \
    num_cpus                     1.10.0 1a23f0ed30a54abaa0c7e83b1d2d87ada7c3c23078d1d87815af3e3b6385fbba \
    packed_simd                  0.3.3 a85ea9fc0d4ac0deb6fe7911d38786b32fc11119afd9e9d38b84ff691ce64220 \
    pcre2                        0.2.0 a08c8195dd1d8a2a1b5e2af94bf0c4c3c195c2359930442a016bf123196f7155 \
    pcre2-sys                    0.2.0 1e0092a7eae1c569cf7dbec61eef956516df93eb4afda8f600ccb16980aca849 \
    pkg-config                   0.3.14 676e8eb2b1b4c9043511a9b7bea0915320d7e502b0a079fb03f9635a5252b18c \
    proc-macro2                  0.4.27 4d317f9caece796be1980837fd5cb3dfec5613ebdb04ad0956deea83ce168915 \
    quote                        0.6.12 faf4799c5d274f3868a4aae320a0a182cbd2baee377b378f080e16a23e9d80db \
    rand                         0.6.5 6d71dacdc3c88c1fde3885a3be3fbab9f35724e6ce99467f7d9c5026132184ca \
    rand_chacha                  0.1.1 556d3a1ca6600bfcbab7c7c91ccb085ac7fbbcd70e008a98742e7847f4f7bcef \
    rand_core                    0.3.1 7a6fdeb83b075e8266dcc8762c22776f6877a63111121f5f8c7411e5be7eed4b \
    rand_core                    0.4.0 d0e7a549d590831370895ab7ba4ea0c1b6b011d106b5ff2da6eee112615e6dc0 \
    rand_hc                      0.1.0 7b40677c7be09ae76218dc623efbf7b18e34bced3f38883af07bb75630a21bc4 \
    rand_isaac                   0.1.1 ded997c9d5f13925be2a6fd7e66bf1872597f759fd9dd93513dd7e92e5a5ee08 \
    rand_jitter                  0.1.3 7b9ea758282efe12823e0d952ddb269d2e1897227e464919a554f2a03ef1b832 \
    rand_os                      0.1.3 7b75f676a1e053fc562eafbb47838d67c84801e38fc1ba459e8f180deabd5071 \
    rand_pcg                     0.1.2 abf9b09b01790cfe0364f52bf32995ea3c39f4d2dd011eac241d2914146d0b44 \
    rand_xorshift                0.1.1 cbf7e9e623549b0e21f6e97cf8ecf247c1a8fd2e8a992ae265314300b2455d5c \
    rdrand                       0.4.0 678054eb77286b51581ba43620cc911abf02758c91f93f479767aed0f90458b2 \
    redox_syscall                0.1.54 12229c14a0f65c4f1cb046a3b52047cdd9da1f4b30f8a39c5063c8bae515e252 \
    redox_termios                0.1.1 7e891cfe48e9100a70a3b6eb652fef28920c117d366339687bd5576160db0f76 \
    regex                        1.1.6 8f0a0bcab2fd7d1d7c54fa9eae6f43eddeb9ce2e7352f8518a814a4f65d60c58 \
    regex-automata               0.1.6 a25a7daa2eea48550e9946133d6cc9621020d29cc7069089617234bf8b6a8693 \
    regex-syntax                 0.6.6 dcfd8681eebe297b81d98498869d4aae052137651ad7b96822f09ceb690d0a96 \
    remove_dir_all               0.5.1 3488ba1b9a2084d38645c4c08276a1752dcbf2c7130d74f1569681ad5d2799c5 \
    ryu                          0.2.7 eb9e9b8cde282a9fe6a42dd4681319bfb63f121b8a8ee9439c6f4107e58a46f7 \
    same-file                    1.0.4 8f20c4be53a8a1ff4c1f1b2bd14570d2f634628709752f0702ecdd2b3f9a5267 \
    serde                        1.0.90 aa5f7c20820475babd2c077c3ab5f8c77a31c15e16ea38687b4c02d3e48680f4 \
    serde_derive                 1.0.90 58fc82bec244f168b23d1963b45c8bf5726e9a15a9d146a067f9081aeed2de79 \
    serde_json                   1.0.39 5a23aa71d4a4d43fdbfaac00eff68ba8a06a51759a89ac3304323e800c4dd40d \
    smallvec                     0.6.9 c4488ae950c49d403731982257768f48fada354a5203fe81f9bb6f43ca9002be \
    strsim                       0.8.0 8ea5119cdb4c55b55d432abb513a0429384878c15dde60cc77b1c99de1a95a6a \
    syn                          0.15.31 d2b4cfac95805274c6afdb12d8f770fa2d27c045953e7b630a81801953699a9a \
    tempfile                     3.0.7 b86c784c88d98c801132806dadd3819ed29d8600836c4088e855cdf3e178ed8a \
    termcolor                    1.0.4 4096add70612622289f2fdcdbd5086dc81c1e2675e6ae58d6c4f62a16c6d7f2f \
    termion                      1.5.1 689a3bdfaab439fd92bc87df5c4c78417d3cbe537487274e9b0b2dce76e92096 \
    textwrap                     0.11.0 d326610f408c7a4eb6f51c37c330e496b08506c9457c9d34287ecc38809fb060 \
    thread_local                 0.3.6 c6b53e329000edc2b34dbe8545fd20e55a333362d0a321909685a19bd28c3f1b \
    ucd-util                     0.1.3 535c204ee4d8434478593480b8f86ab45ec9aae0e83c568ca81abf0fd0e88f86 \
    unicode-width                0.1.5 882386231c45df4700b275c7ff55b6f3698780a650026380e72dabe76fa46526 \
    unicode-xid                  0.1.0 fc72304796d0818e357ead4e000d19c9c174ab23dc11093ac919054d20a6a7fc \
    utf8-ranges                  1.0.2 796f7e48bef87609f7ade7e06495a87d5cd06c7866e6a5cbfceffc558a243737 \
    walkdir                      2.2.7 9d9d7ed3431229a144296213105a390676cc49c9b6a72bd19f3176c98e129fa1 \
    winapi                       0.3.7 f10e386af2b13e47c89e7236a7a14a086791a2b88ebad6df9bf42040195cf770 \
    winapi-i686-pc-windows-gnu   0.4.0 ac3b87c63620426dd9b991e5ce0329eff545bccbbb34f3be09ff6fb6ab51b7b6 \
    winapi-util                  0.1.2 7168bab6e1daee33b4557efd0e95d5ca70a03706d39fa5f3fe7a236f584b03c9 \
    winapi-x86_64-pc-windows-gnu 0.4.0 712e227841d057c1ee1cd2fb22fa7e5a5461ae8e48fa2ca79ec42cfc1931183f \
    wincolor                     1.0.1 561ed901ae465d6185fa7864d63fbd5720d0ef718366c9a4dc83cf6170d7e9ba

checksums-append    ${distname}${extract.suffix} \
                    rmd160  967d9aca3e79566bb429b809c526a118b95bc476 \
                    sha256  9a94ebc7226d104a9fb88816383c3dc58baed688d0e23349033c9211169a72bd \
                    size    460260 \

depends_build-append \
                    port:asciidoc \
                    port:docbook-xsl-nons

destroot {
    xinstall -m 755 ${worksrcpath}/target/[cargo.rust_platform]/release/rg ${destroot}${prefix}/bin/
    ln -s rg ${destroot}${prefix}/bin/ripgrep

    set outpath [glob ${worksrcpath}/target/[cargo.rust_platform]/release/build/ripgrep-*]/out/
    xinstall -m 644 ${outpath}/rg.1 ${destroot}${prefix}/share/man/man1/
    xinstall -d -m 755 ${destroot}${prefix}/share/bash-completion/completions
    xinstall -m 644 ${outpath}/rg.bash ${destroot}${prefix}/share/bash-completion/completions/rg
    xinstall -d -m 755 ${destroot}${prefix}/share/fish/completions
    xinstall -m 644 ${outpath}/rg.fish ${destroot}${prefix}/share/fish/completions/
    xinstall -d -m 755 ${destroot}${prefix}/share/zsh/site-functions
    xinstall -m 644 ${worksrcpath}/complete/_rg ${destroot}${prefix}/share/zsh/site-functions/
}

variant pcre {
    build.args-append       --features 'pcre2'
    depends_lib-append      port:pcre2
}
