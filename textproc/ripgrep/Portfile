# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           github 1.0
PortGroup           cargo 1.0

github.setup        BurntSushi ripgrep 12.1.1
categories          textproc
platforms           darwin
maintainers         {raimue @raimue} \
                    openmaintainer
license             MIT

description         fast command line search tool
long_description    ripgrep is a command line search tool that combines the \
                    usability of The Silver Searcher (an ack clone) with the \
                    raw speed of GNU grep.

cargo.crates \
    aho-corasick                  0.7.10   8716408b8bc624ed7f65d223ddb9ac2d044c0547b6fa4b0d554f3a9540496ada  \
    atty                          0.2.14   d9b39be18770d11421cdb1b9947a45dd3f37e93092cbf377614828a319d5fee8  \
    autocfg                       1.0.0    f8aac770f1885fd7e387acedd76065302551364496e46b3dd00860b2f8359b9d  \
    base64                        0.12.1   53d1ccbaf7d9ec9537465a97bf19edc1a4e158ecb49fc16178202238c569cc42  \
    bitflags                      1.2.1    cf1de2fe8c75bc145a2f577add951f8134889b4795d47466a54a5c846d691693  \
    bstr                          0.2.13   31accafdb70df7871592c058eca3985b71104e15ac32f64706022c58867da931  \
    bytecount                     0.6.0    b0017894339f586ccb943b01b9555de56770c11cda818e7e3d8bd93f4ed7f46e  \
    byteorder                     1.3.4    08c48aae112d48ed9f069b33538ea9e3e90aa263cfa3d1c24309612b1f7472de  \
    cc                            1.0.54   7bbb73db36c1246e9034e307d0fba23f9a2e251faa47ade70c1bd252220c8311  \
    cfg-if                        0.1.10   4785bdd1c96b2a846b2bd7cc02e86b6b3dbf14e7e53446c4f54c92a361040822  \
    clap                          2.33.1   bdfa80d47f954d53a35a64987ca1422f495b8d6483c0fe9f7117b36c2a792129  \
    crossbeam-channel             0.4.2    cced8691919c02aac3cb0a1bc2e9b73d89e832bf9a06fc579d4e71b68a2da061  \
    crossbeam-utils               0.7.2    c3c7c73a2d1e9fc0886a08b93e98eb643461230d5f1925e4036204d5f2e261a8  \
    encoding_rs                   0.8.23   e8ac63f94732332f44fe654443c46f6375d1939684c17b0afb6cb56b0456e171  \
    encoding_rs_io                0.1.7    1cc3c5651fb62ab8aa3103998dade57efdd028544bd300516baa31840c252a83  \
    fnv                           1.0.7    3f9eec918d3f24069decb9af1554cad7c880e2da24a9afd88aca000531ab82c1  \
    fs_extra                      1.1.0    5f2a4a2034423744d2cc7ca2068453168dcdb82c438419e639a26bd87839c674  \
    glob                          0.3.0    9b919933a397b79c37e33b77bb2aa3dc8eb6e165ad809e58ff75bc7db2e34574  \
    hermit-abi                    0.1.13   91780f809e750b0a89f5544be56617ff6b1227ee485bcb06ebe10cdf89bd3b71  \
    itoa                          0.4.5    b8b7a7c0c47db5545ed3fef7468ee7bb5b74691498139e4b3f6a20685dc6dd8e  \
    jemalloc-sys                  0.3.2    0d3b9f3f5c9b31aa0f5ed3260385ac205db665baa41d49bb8338008ae94ede45  \
    jemallocator                  0.3.2    43ae63fcfc45e99ab3d1b29a46782ad679e98436c3169d15a167a1108a724b69  \
    lazy_static                   1.4.0    e2abad23fbc42b3700f2f279844dc832adb2b2eb069b2df918f455c4e18cc646  \
    libc                          0.2.71   9457b06509d27052635f90d6466700c65095fdf75409b3fbdd903e988b886f49  \
    log                           0.4.8    14b6052be84e6b71ab17edffc2eeabf5c2c3ae1fdb464aae35ac50c67a44e1f7  \
    maybe-uninit                  2.0.0    60302e4db3a61da70c0cb7991976248362f30319e88850c487b9b95bbf059e00  \
    memchr                        2.3.3    3728d817d99e5ac407411fa471ff9800a778d88a24685968b36824eaf4bee400  \
    memmap                        0.7.0    6585fd95e7bb50d6cc31e20d4cf9afb4e2ba16c5846fc76793f11218da9c475b  \
    num_cpus                      1.13.0   05499f3756671c15885fee9034446956fff3f243d6077b91e5767df161f766b3  \
    packed_simd                   0.3.3    a85ea9fc0d4ac0deb6fe7911d38786b32fc11119afd9e9d38b84ff691ce64220  \
    pcre2                         0.2.3    85b30f2f69903b439dd9dc9e824119b82a55bf113b29af8d70948a03c1b11ab1  \
    pcre2-sys                     0.2.2    876c72d05059d23a84bd9fcdc3b1d31c50ea7fe00fe1522b4e68cd3608db8d5b  \
    pkg-config                    0.3.17   05da548ad6865900e60eaba7f589cc0783590a92e940c26953ff81ddbab2d677  \
    proc-macro2                   1.0.17   1502d12e458c49a4c9cbff560d0fe0060c252bc29799ed94ca2ed4bb665a0101  \
    quote                         1.0.6    54a21852a652ad6f610c9510194f398ff6f8692e334fd1145fed931f7fbe44ea  \
    regex                         1.3.9    9c3780fcf44b193bc4d09f36d2a3c87b251da4a046c87795a0d35f4f927ad8e6  \
    regex-automata                0.1.9    ae1ded71d66a4a97f5e961fd0cb25a5f366a42a41570d16a763a69c092c26ae4  \
    regex-syntax                  0.6.18   26412eb97c6b088a6997e05f69403a802a92d520de2f8e63c2b65f9e0f47c4e8  \
    ryu                           1.0.4    ed3d612bc64430efeb3f7ee6ef26d590dce0c43249217bddc62112540c7941e1  \
    same-file                     1.0.6    93fc1dc3aaa9bfed95e02e6eadabb4baf7e3078b0bd1b4d7b6b0b68378900502  \
    serde                         1.0.110  99e7b308464d16b56eba9964e4972a3eee817760ab60d88c3f86e1fecb08204c  \
    serde_derive                  1.0.110  818fbf6bfa9a42d3bfcaca148547aa00c7b915bec71d1757aa2d44ca68771984  \
    serde_json                    1.0.53   993948e75b189211a9b31a7528f950c6adc21f9720b6438ff80a7fa2f864cea2  \
    strsim                        0.8.0    8ea5119cdb4c55b55d432abb513a0429384878c15dde60cc77b1c99de1a95a6a  \
    syn                           1.0.27   ef781e621ee763a2a40721a8861ec519cb76966aee03bb5d00adb6a31dc1c1de  \
    termcolor                     1.1.0    bb6bfa289a4d7c5766392812c0a1f4c1ba45afa1ad47803c11e1f407d846d75f  \
    textwrap                      0.11.0   d326610f408c7a4eb6f51c37c330e496b08506c9457c9d34287ecc38809fb060  \
    thread_local                  1.0.1    d40c6d1b69745a6ec6fb1ca717914848da4b44ae29d9b3080cbee91d72a69b14  \
    unicode-width                 0.1.7    caaa9d531767d1ff2150b9332433f32a24622147e5ebb1f26409d5da67afd479  \
    unicode-xid                   0.2.0    826e7639553986605ec5979c7dd957c7895e93eabed50ab2ffa7f6128a75097c  \
    walkdir                       2.3.1    777182bc735b6424e1a57516d35ed72cb8019d85c8c9bf536dccb3445c1a2f7d  \
    winapi                        0.3.8    8093091eeb260906a183e6ae1abdba2ef5ef2257a21801128899c3fc699229c6  \
    winapi-i686-pc-windows-gnu    0.4.0    ac3b87c63620426dd9b991e5ce0329eff545bccbbb34f3be09ff6fb6ab51b7b6  \
    winapi-util                   0.1.5    70ec6ce85bb158151cae5e5c87f95a8e97d2c0c4b001223f33a334e3ce5de178  \
    winapi-x86_64-pc-windows-gnu  0.4.0    712e227841d057c1ee1cd2fb22fa7e5a5461ae8e48fa2ca79ec42cfc1931183f

checksums-append    ${distname}${extract.suffix} \
                    rmd160  a1acb9fd8f3c59533538e846976f1f59f95aa0c2 \
                    sha256  d3a4b97f5dfa0da3351eef751e6541abd6f07793e7e54fff30ef06461bcfb05a \
                    size    480716

depends_build-append \
                    port:asciidoc \
                    port:docbook-xsl-nons

destroot {
    xinstall -m 755 ${worksrcpath}/target/[cargo.rust_platform]/release/rg ${destroot}${prefix}/bin/
    ln -s rg ${destroot}${prefix}/bin/ripgrep

    set outpath [glob ${worksrcpath}/target/[cargo.rust_platform]/release/build/ripgrep-*]/out/
    xinstall -m 644 ${outpath}/rg.1 ${destroot}${prefix}/share/man/man1/
    xinstall -d -m 755 ${destroot}${prefix}/share/bash-completion/completions
    xinstall -m 644 ${outpath}/rg.bash ${destroot}${prefix}/share/bash-completion/completions/rg
    xinstall -d -m 755 ${destroot}${prefix}/share/fish/completions
    xinstall -m 644 ${outpath}/rg.fish ${destroot}${prefix}/share/fish/completions/
    xinstall -d -m 755 ${destroot}${prefix}/share/zsh/site-functions
    xinstall -m 644 ${worksrcpath}/complete/_rg ${destroot}${prefix}/share/zsh/site-functions/
}

variant pcre {
    build.args-append       --features 'pcre2'
    depends_lib-append      port:pcre2
}
