# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           github 1.0
PortGroup           cargo 1.0

github.setup        BurntSushi ripgrep 0.10.0
categories          textproc
platforms           darwin
maintainers         {raimue @raimue} \
                    openmaintainer
license             MIT

description         fast command line search tool
long_description    ripgrep is a command line search tool that combines the \
                    usability of The Silver Searcher (an ack clone) with the \
                    raw speed of GNU grep.

cargo.crates \
    aho-corasick                 0.6.8  68f56c7353e5a9547cbd76ed90f7bb5ffc3ba09d4ea9bd1d8c06c8b1142eeb5a \
    arrayvec                     0.4.7  a1e964f9e24d588183fcb43503abda40d288c8657dfc27311516ce2f05675aef \
    atty                         0.2.11  9a7d5b8723950951411ee34d271d99dddcc2035a16ab25310ea2c8cfd4369652 \
    base64                       0.9.2  85415d2594767338a74a30c1d370b2f3262ec1b4ed2d7bba5b3faf4de40467d9 \
    bitflags                     1.0.4  228047a76f468627ca71776ecdebd732a3423081fcf5125585bcd7c49886ce12 \
    bytecount                    0.3.2  f861d9ce359f56dbcb6e0c2a1cb84e52ad732cadb57b806adeb3c7668caccbd8 \
    byteorder                    1.2.6  90492c5858dd7d2e78691cfb89f90d273a2800fc11d98f60786e5d87e2f83781 \
    cc                           1.0.24  70f2a88c2e69ceee91c209d8ef25b81fc1a65f42c7f14dfd59d1fed189e514d1 \
    cfg-if                       0.1.5  0c4e7bb64a8ebb0d856483e1e682ea3422f883c5f5615a90d51a2c82fe87fdd3 \
    clap                         2.32.0  b957d88f4b6a63b9d70d5f454ac8011819c6efa7727858f458ab71c756ce2d3e \
    cloudabi                     0.0.3  ddfc5b9aa5d4507acaf872de71051dfd0e309860e88966e1051e462a077aac4f \
    crossbeam-channel            0.2.4  6c0a94250b0278d7fc5a894c3d276b11ea164edc8bf8feb10ca1ea517b44a649 \
    crossbeam-epoch              0.5.2  30fecfcac6abfef8771151f8be4abc9e4edc112c2bcb233314cafde2680536e9 \
    crossbeam-utils              0.5.0  677d453a17e8bd2b913fa38e8b9cf04bcdbb5be790aa294f2389661d72036015 \
    encoding_rs                  0.8.6  2a91912d6f37c6a8fef8a2316a862542d036f13c923ad518b5aca7bcaac7544c \
    encoding_rs_io               0.1.2  f222ff554d6e172f3569a2d7d0fd8061d54215984ef67b24ce031c1fcbf2c9b3 \
    fnv                          1.0.6  2fad85553e09a6f881f739c29f0b00b0f01357c743266d478b68951ce23285f3 \
    fuchsia-zircon               0.3.3  2e9763c69ebaae630ba35f74888db465e49e259ba1bc0eda7d06f4a067615d82 \
    fuchsia-zircon-sys           0.3.3  3dcaa9ae7725d12cdb85b3ad99a434db70b468c09ded17e012d86b5c1010f7a7 \
    glob                         0.2.11  8be18de09a56b60ed0edf84bc9df007e30040691af7acd1c41874faac5895bfb \
    itoa                         0.4.2  5adb58558dcd1d786b5f0bd15f3226ee23486e24b7b58304b60f64dc68e62606 \
    lazy_static                  1.1.0  ca488b89a5657b0a2ecd45b95609b3e848cf1755da332a0da46e2b2b1cb371a7 \
    libc                         0.2.43  76e3a3ef172f1a0b9a9ff0dd1491ae5e6c948b94479a3021819ba7d860c8645d \
    lock_api                     0.1.3  949826a5ccf18c1b3a7c3d57692778d21768b79e46eb9dd07bfc4c2160036c54 \
    log                          0.4.5  d4fcce5fa49cc693c312001daf1d13411c4a5283796bac1084299ea3e567113f \
    memchr                       2.0.2  a3b4142ab8738a78c51896f704f83c11df047ff1bda9a92a661aa6361552d93d \
    memmap                       0.6.2  e2ffa2c986de11a9df78620c01eeaaf27d94d3ff02bf81bfcca953102dd0c6ff \
    memoffset                    0.2.1  0f9dc261e2b62d7a622bf416ea3c5245cdd5d9a7fcc428c0d06804dfce1775b3 \
    nodrop                       0.1.12  9a2228dca57108069a5262f2ed8bd2e82496d2e074a06d1ccc7ce1687b6ae0a2 \
    num_cpus                     1.8.0  c51a3322e4bca9d212ad9a158a02abc6934d005490c054a2778df73a70aa0a30 \
    owning_ref                   0.3.3  cdf84f41639e037b484f93433aa3897863b561ed65c6e59c7073d7c561710f37 \
    parking_lot                  0.6.4  f0802bff09003b291ba756dc7e79313e51cc31667e94afbe847def490424cde5 \
    parking_lot_core             0.3.0  06a2b6aae052309c2fd2161ef58f5067bc17bb758377a0de9d4b279d603fdd8a \
    pcre2                        0.1.0  0c16ec0e30c17f938a2da8ff970ad9a4100166d0538898dcc035b55c393cab54 \
    pcre2-sys                    0.1.1  a9027f9474e4e13d3b965538aafcaebe48c803488ad76b3c97ef061a8324695f \
    pkg-config                   0.3.14  676e8eb2b1b4c9043511a9b7bea0915320d7e502b0a079fb03f9635a5252b18c \
    proc-macro2                  0.4.18  afa4d377067cc02eb5e0b491d3f7cfbe145ad4da778535bfb13c444413dd35b9 \
    quote                        0.6.8  dd636425967c33af890042c483632d33fa7a18f19ad1d7ea72e8998c6ef8dea5 \
    rand                         0.4.3  8356f47b32624fef5b3301c1be97e5944ecdd595409cc5da11d05f211db6cfbd \
    rand                         0.5.5  e464cd887e869cddcae8792a4ee31d23c7edd516700695608f5b98c67ee0131c \
    rand_core                    0.2.1  edecf0f94da5551fc9b492093e30b041a891657db7940ee221f9d2f66e82eef2 \
    redox_syscall                0.1.40  c214e91d3ecf43e9a4e41e578973adeb14b474f2bee858742d127af75a0112b1 \
    redox_termios                0.1.1  7e891cfe48e9100a70a3b6eb652fef28920c117d366339687bd5576160db0f76 \
    regex                        1.0.5  2069749032ea3ec200ca51e4a31df41759190a88edca0d2d86ee8bedf7073341 \
    regex-syntax                 0.6.2  747ba3b235651f6e2f67dfa8bcdcd073ddb7c243cb21c442fc12395dfcac212d \
    remove_dir_all               0.5.1  3488ba1b9a2084d38645c4c08276a1752dcbf2c7130d74f1569681ad5d2799c5 \
    ryu                          0.2.6  7153dd96dade874ab973e098cb62fcdbb89a03682e46b144fd09550998d4a4a7 \
    safemem                      0.2.0  e27a8b19b835f7aea908818e871f5cc3a5a186550c30773be987e155e8163d8f \
    same-file                    1.0.3  10f7794e2fda7f594866840e95f5c5962e886e228e68b6505885811a94dd728c \
    scopeguard                   0.3.3  94258f53601af11e6a49f722422f6e3425c52b06245a5cf9bc09908b174f5e27 \
    serde                        1.0.77  c6e67977d7523ce4d9284ed58918af99392de8edb6192c44afefcf634654ab7f \
    serde_derive                 1.0.77  5569c52faae3e21b9abae2cc5cfbb56ed008bfcac480ad62bc241b828f0b0aee \
    serde_json                   1.0.27  59790990c5115d16027f00913e2e66de23a51f70422e549d2ad68c8c5f268f1c \
    simd                         0.2.2  ed3686dd9418ebcc3a26a0c0ae56deab0681e53fe899af91f5bbcee667ebffb1 \
    smallvec                     0.6.5  153ffa32fd170e9944f7e0838edf824a754ec4c1fc64746fcc9fe1f8fa602e5d \
    stable_deref_trait           1.1.1  dba1a27d3efae4351c8051072d619e3ade2820635c3958d826bfea39d59b54c8 \
    strsim                       0.7.0  bb4f380125926a99e52bc279241539c018323fab05ad6368b56f93d9369ff550 \
    syn                          0.15.1  85fb2f7f9b7a4c8df2c913a852de570efdb40f0d2edd39c8245ad573f5c7fbcc \
    tempdir                      0.3.7  15f2b5fb00ccdf689e0149d1b1b3c03fead81c2b37735d812fa8bddbbf41b6d8 \
    termcolor                    1.0.3  ff3bac0e465b59f194e7037ed404b0326e56ff234d767edc4c5cc9cd49e7a2c7 \
    termion                      1.5.1  689a3bdfaab439fd92bc87df5c4c78417d3cbe537487274e9b0b2dce76e92096 \
    textwrap                     0.10.0  307686869c93e71f94da64286f9a9524c0f308a9e1c87a583de8e9c9039ad3f6 \
    thread_local                 0.3.6  c6b53e329000edc2b34dbe8545fd20e55a333362d0a321909685a19bd28c3f1b \
    ucd-util                     0.1.1  fd2be2d6639d0f8fe6cdda291ad456e23629558d466e2789d2c3e9892bda285d \
    unicode-width                0.1.5  882386231c45df4700b275c7ff55b6f3698780a650026380e72dabe76fa46526 \
    unicode-xid                  0.1.0  fc72304796d0818e357ead4e000d19c9c174ab23dc11093ac919054d20a6a7fc \
    unreachable                  1.0.0  382810877fe448991dfc7f0dd6e3ae5d58088fd0ea5e35189655f84e6814fa56 \
    utf8-ranges                  1.0.1  fd70f467df6810094968e2fce0ee1bd0e87157aceb026a8c083bcf5e25b9efe4 \
    version_check                0.1.4  7716c242968ee87e5542f8021178248f267f295a5c4803beae8b8b7fd9bc6051 \
    void                         1.0.2  6a02e4885ed3bc0f2de90ea6dd45ebcbb66dacffe03547fadbb0eeae2770887d \
    walkdir                      2.2.5  af464bc7be7b785c7ac72e266a6b67c4c9070155606f51655a650a6686204e35 \
    winapi                       0.3.5  773ef9dcc5f24b7d850d0ff101e542ff24c3b090a9768e03ff889fdef41f00fd \
    winapi-i686-pc-windows-gnu   0.4.0  ac3b87c63620426dd9b991e5ce0329eff545bccbbb34f3be09ff6fb6ab51b7b6 \
    winapi-util                  0.1.1  afc5508759c5bf4285e61feb862b6083c8480aec864fa17a81fdec6f69b461ab \
    winapi-x86_64-pc-windows-gnu 0.4.0  712e227841d057c1ee1cd2fb22fa7e5a5461ae8e48fa2ca79ec42cfc1931183f \
    wincolor                     1.0.1  561ed901ae465d6185fa7864d63fbd5720d0ef718366c9a4dc83cf6170d7e9ba

checksums-append    ${distname}${extract.suffix} \
                    rmd160  516f501789426944c5629991094afe5e560041bf \
                    sha256  41c28b6ca616f6842a2c632b565df1523a55f74db245663da2ad92258b773413 \
                    size    428374

depends_build-append \
                    port:asciidoc \
                    port:docbook-xsl-nons

destroot {
    xinstall -m 755 ${worksrcpath}/target/[cargo.rust_platform]/release/rg ${destroot}${prefix}/bin/
    ln -s rg ${destroot}${prefix}/bin/ripgrep

    set outpath [glob ${worksrcpath}/target/[cargo.rust_platform]/release/build/ripgrep-*]/out/
    xinstall -m 644 ${outpath}/rg.1 ${destroot}${prefix}/share/man/man1/
    xinstall -d -m 755 ${destroot}${prefix}/share/bash-completion/completions
    xinstall -m 644 ${outpath}/rg.bash ${destroot}${prefix}/share/bash-completion/completions/rg
    xinstall -d -m 755 ${destroot}${prefix}/share/fish/completions
    xinstall -m 644 ${outpath}/rg.fish ${destroot}${prefix}/share/fish/completions/
    xinstall -d -m 755 ${destroot}${prefix}/share/zsh/site-functions
    xinstall -m 644 ${worksrcpath}/complete/_rg ${destroot}${prefix}/share/zsh/site-functions/
}

variant pcre {
    build.args-append       --features 'pcre2'
    depends_lib-append      port:pcre2
}
