# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

# Use legacysupport for provide the definition of AT_FDCWD for 10.9 and earlier.
# See https://trac.macports.org/ticket/65265
PortSystem          1.0
PortGroup           legacysupport 1.1

# <fnctl.h> for identifier 'AT_FDCWD'
# See https://trac.macports.org/ticket/65265
# <time.h> for identifier 'CLOCK_THREAD_CPUTIME_ID'
# See https://trac.macports.org/ticket/73288
legacysupport.newest_darwin_requires_legacy 15

name                lowdown
categories          textproc
version             2.0.4
revision            0
license             BSD

description         simple markdown translator
long_description    lowdown is a Markdown translator producing HTML5, \
                    roff documents in the ms and man formats, LaTeX, \
                    gemini ("gemtext"), OpenDocument, and ANSI/UTF8 \
                    terminal output. The open source C source code \
                    has no dependencies.

homepage            https://kristaps.bsd.lv/lowdown
master_sites        ${homepage}/snapshots
maintainers         {judaew @judaew} openmaintainer

checksums           rmd160 9c1347a51cfc0d7cc493f8899f5b31f19c2603bd \
                    sha256 37412340bc3d87dc53f2be1a161bcd8da3c1ac974f5be305b5781a56e2d02595 \
                    size   319401

depends_build-append \
                    port:bmake

configure.universal_args
configure.pre_args  PREFIX=${prefix}
configure.args      MANDIR=${prefix}/share/man
if { ${os.platform} eq "darwin" && ${os.major} <= 14  } {
    configure.args-append LINKER_SOFLAG=-dynamiclib \
                    LINKER_SONAME=-install_name \
                    LINKER_SOSUFFIX=dylib
}

build.cmd           bmake
build.args          LDFLAGS="${configure.ldflags}"

# The install target installs only binaries but does not install the library
# and pkg-config pc file.
destroot.target-append  install_lib_common install_shared
