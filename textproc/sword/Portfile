# $Id$
PortSystem		1.0

name			sword
version			1.5.7a
revision		1
categories		textproc
maintainers		nomaintainer
description		cross-platform API/library for Bible software
long_description	The SWORD Project is an open source, cross-platform \
					(Linux, Windows, Solaris, etc.) API/library for \
					Bible software with a constantly growing list of \
					front-ends (GUI, textmode, web-based, etc.) and a \
					library of over 200 text modules.
homepage		http://www.crosswire.org/${name}/index.jsp
master_sites	http://www.crosswire.org/ftpmirror/pub/${name}/source/v1.5/
checksums		md5 e77801ac7abb7a940eb8a75d725e346f
platforms		darwin

depends_build	port:autoconf \
				port:automake \
				port:libtool \
				port:pkgconfig
depends_lib		port:curl \
				port:openssl \
				port:zlib

worksrcdir		${name}-[strsed ${version} {s/a$//}]

patchfiles		patch-autogen.sh \
				patch-configure.ac \
				patch-untgz.c

pre-configure {
    system "cd ${worksrcpath} && ./autogen.sh"
}
configure.args	--with-zlib --with-conf --with-curl \
				--without-icu --without-lucene

post-destroot {
	xinstall -d -m 0755 ${destroot}${prefix}/share/${name}/mods.d
	xinstall -m 0644 ${worksrcpath}/samples/mods.d/globals.conf ${destroot}${prefix}/share/${name}/mods.d

	xinstall -d -m 0755 ${destroot}${prefix}/share/${name}/modules
	system "touch ${destroot}${prefix}/share/${name}/modules/.turd"

	xinstall -d -m 0755 ${destroot}${prefix}/share/doc/${name}
	xinstall -m 0644 -W ${worksrcpath} README INSTALL LICENSE ${destroot}${prefix}/share/doc/${name}
	foreach dir [exec find ${worksrcpath}/samples -type d] {
		xinstall -d -m 0755 ${destroot}${prefix}/share/doc/${name}/${dir}
	}
	foreach file [exec find ${worksrcpath}/samples -type f] {
		xinstall -m 0644 ${file} ${destroot}${prefix}/share/doc/${name}/${file}
	}
}

livecheck.check	regex
livecheck.url	http://www.crosswire.org/sword/software/swordapi.jsp
livecheck.regex {SWORD Engine / API v([0-9\.]+)}
