# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0

name                expat
version             2.2.4
categories          textproc devel
platforms           darwin freebsd
maintainers         {ryandesign @ryandesign} openmaintainer
license             MIT

description         XML 1.0 parser written in C

long_description    Expat is an XML parser library written in C. It is a \
                    stream-oriented parser in which an application \
                    registers handlers for things the parser might find \
                    in the XML document (like start tags).

homepage            http://www.libexpat.org/
master_sites        sourceforge:project/${name}/${name}/${version}
use_bzip2           yes

checksums           rmd160  fefe2400056c494a4d2c15e07f55d8119b411a7a \
                    sha256  03ad85db965f8ab2d27328abcf0bc5571af6ec0a414874b2066ee3fdd372019e

post-configure {
    reinplace "s|CC -dynamiclib|CC -dynamiclib [get_canonical_archflags]|g" ${worksrcpath}/libtool
}

use_parallel_build  yes

test.run            yes
test.target         check

post-destroot {
    set docdir ${destroot}${prefix}/share/doc/${name}
    set examplesdir ${destroot}${prefix}/share/examples/${name}
    xinstall -m 0755 -d ${examplesdir} ${docdir}/html
    
    xinstall -m 0644 -W ${worksrcpath} COPYING Changes README.md ${docdir}
    xinstall -m 0644 {*}[glob ${worksrcpath}/doc/*] ${docdir}/html
    
    xinstall -m 0644 -W ${worksrcpath}/examples elements.c outline.c \
        ${examplesdir}
}

livecheck.regex     /${name}-(\[0-9.\]+)${extract.suffix}
