# $Id$

PortSystem          1.0

name                minivmac
version             2.8.2
revision            1
categories          emulators aqua
maintainers         ryandesign@macports.org
homepage            http://minivmac.sourceforge.net/
master_sites        sourceforge
use_configure       no
worksrcdir          projects/bgcmachs
build.target
platforms           darwin

description \
	Mini vMac is a minimalistic Mac Plus emulator.

long_description \
	Mini vMac is a minor spin off of the program vMac. Its \
	goal is to provide the simplest usable emulation of a \
	Macintosh, instead of the fastest or most usable \
	emulation.  Mini vMac emulates a Mac Plus, a Macintosh \
	computer sold between 1986 and 1990.

distfiles \
	${distname}.prj.tgz \
	${distname}.src.tgz

checksums \
	${distname}.prj.tgz \
		md5 cfd3c6b60080d2184d6895b84c616fbf \
		sha1 8aa54b5708e280d1ed0c1f68aca8a38965cad4e2 \
		rmd160 d0e8d7734109b12caaf909efea231fe2a3a55979 \
	${distname}.src.tgz \
		md5 ff6e67f654f09098ffbb8f26a5a7ae20 \
		sha1 6cdc4b514f3b45869a9fd2c5ee528499e772ad5e \
		rmd160 dc7a827fc1821014b2ac0f9b5cd025e1133d83ef

post-extract {
	reinplace "s|maintained by unknown|maintained by MacPorts|" \
		${worksrcpath}/config/Info.plist
	reinplace "s|#define kMaintainerName \"unknown\"|#define kMaintainerName \"MacPorts\"|" \
		${worksrcpath}/config/CNFGGLOB.h
}

destroot {
	xinstall -m 755 -d ${destroot}/Applications/MacPorts
	file copy ${worksrcpath}/minivmac.app \
		${destroot}/Applications/MacPorts/Mini\ vMac.app
}

if { ![variant_isset mac128k] && ![variant_isset mac512k] && ![variant_isset mac512ke] && ![variant_isset macse] } {
	default_variants +macplus
}

variant mac128k conflicts mac512k mac512ke macplus macse {
	patchfiles-append patch-CNFGGLOB.h-mac128k.diff
}

variant mac512k conflicts mac128k mac512ke macplus macse {
	patchfiles-append patch-CNFGGLOB.h-mac512k.diff
}

variant mac512ke conflicts mac128k mac512k macplus macse {
	patchfiles-append patch-CNFGGLOB.h-mac512ke.diff
}

variant macplus conflicts mac128k mac512k mac512ke macse {
	# Mac Plus emulation is the default so we don't need to do anything here
}

variant macse conflicts mac128k mac512k mac512ke macplus {
	patchfiles-append patch-CNFGGLOB.h-macse.diff
}
