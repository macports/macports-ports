--- Makefile	2025-10-28 19:40:51
+++ Makefile.new	2025-11-12 03:02:36
@@ -84,14 +84,14 @@
 
 LIBRARY_RELEASE_Linux = target/release/$(KRUN_BINARY_Linux)
 LIBRARY_DEBUG_Linux = target/debug/$(KRUN_BINARY_Linux)
-LIBRARY_RELEASE_Darwin = target/release/$(KRUN_BINARY_Darwin)
+LIBRARY_RELEASE_Darwin = target/$(CARGO_BUILD_TARGET)/release/$(KRUN_BINARY_Darwin)
 LIBRARY_DEBUG_Darwin = target/debug/$(KRUN_BINARY_Darwin)
 
 LIBDIR_Linux = lib64
 LIBDIR_Darwin = lib
 
 ifeq ($(PREFIX),)
-    PREFIX := /usr/local
+    PREFIX := @@DEFAULT_PREFIX@@
 endif
 
 .PHONY: install clean test test-prefix $(LIBRARY_RELEASE_$(OS)) $(LIBRARY_DEBUG_$(OS)) libkrun.pc
@@ -118,12 +118,12 @@
 	mv target/release/libkrun.so target/release/$(KRUN_BASE_$(OS))
 endif
 ifeq ($(OS),Darwin)
 ifeq ($(EFI),1)
-	install_name_tool -id $(PREFIX)/$(LIBDIR_$(OS))/$(KRUN_SONAME_$(OS)) target/release/libkrun.dylib
+	install_name_tool -id $(PREFIX)/$(LIBDIR_$(OS))/$(KRUN_SONAME_$(OS)) target/$(CARGO_BUILD_TARGET)/release/libkrun.dylib
 endif
-	mv target/release/libkrun.dylib target/release/$(KRUN_BASE_$(OS))
+	mv target/$(CARGO_BUILD_TARGET)/release/libkrun.dylib target/$(CARGO_BUILD_TARGET)/release/$(KRUN_BASE_$(OS))
 endif
-	cp target/release/$(KRUN_BASE_$(OS)) $(LIBRARY_RELEASE_$(OS))
+	cp target/$(CARGO_BUILD_TARGET)/release/$(KRUN_BASE_$(OS)) $(LIBRARY_RELEASE_$(OS))
 
 $(LIBRARY_DEBUG_$(OS)): $(INIT_BINARY)
 	cargo build $(FEATURE_FLAGS)
