# $Id: Portfile,v 1.3 2005/07/24 19:01:08 mww Exp $

PortSystem 1.0

name			otcl
version			2002-06-23
categories		lang
maintainers		benwill at socrates.berkeley.edu
description		MIT Object Tcl
long_description	OTcl, short for MIT Object Tcl, is an extension to \
			Tcl/Tk for object-oriented programming. 
homepage		http://otcl-tclcl.sourceforge.net/otcl/
master_sites		http://otcl-tclcl.sourceforge.net/tarballs/:otcl \
			sourceforge:tcl:tcl
set tclmaj		8.4
set tclmin		9
set tclv		${tclmaj}.${tclmin}
dist_subdir		tcltk
distfiles		${name}-current.tar.gz:otcl \
			tcl${tclv}-src.tar.gz:tcl
checksums		${name}-current.tar.gz md5 950865d4860a5b911d244ea538ddb1ba \
                        tcl${tclv}-src.tar.gz md5 7e01b409925e4eb59ad44a4c12b9c681

depends_build		port:autoconf \
			port:automake

depends_lib		port:tcl \
			port:tk

patchfiles		conf_configure.in.fns.patch

pre-configure		{
			cd ${worksrcpath}
			system "${prefix}/bin/aclocal && ${prefix}/bin/autoconf"
}

configure.args		--with-tcl=${prefix} --with-tcl-ver=${tclmaj} \
			--with-tk=${prefix} --with-tk-ver=${tclmaj} \
			--prefix=${prefix} \
			CPPFLAGS='-I/usr/X11R6/include -I${workpath}/tcl${tclv}/generic/' \
			CFLAGS='-I/usr/X11R6/include -I${workpath}/tcl${tclv}/generic/' \
			LDFLAGS='-L/usr/X11R6/lib' \
			CC=gcc-3.3 \
			CXX=g++-3.3

post-configure          {
                        reinplace "s|-lXext|-L/usr/X11R6/lib -lXext|g" \
                                ${worksrcpath}/Makefile
}

build.target		all

destroot		{
			cd ${worksrcpath}
			xinstall -m 0755 owish otclsh ${destroot}${prefix}/bin
			xinstall -m 0644 libotcl.a ${destroot}${prefix}/lib
			xinstall -m 0644 otcl.h ${destroot}${prefix}/include
}
