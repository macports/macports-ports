--- libsanitizer/sanitizer_common/sanitizer_mac.cc.orig	2019-05-12 11:27:25.000000000 -0700
+++ libsanitizer/sanitizer_common/sanitizer_mac.cc	2019-05-12 13:08:51.000000000 -0700
@@ -1077,9 +1077,22 @@
 bool GetRandom(void *buffer, uptr length, bool blocking) {
   if (!buffer || !length || length > 256)
     return false;
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= 1070
   // arc4random never fails.
   arc4random_buf(buffer, length);
   return true;
+#else
+  // Up to 256 bytes, a read off /dev/urandom will not be interrupted.
+  // blocking is moot here, O_NONBLOCK has no effect when opening /dev/urandom.
+  uptr fd = internal_open("/dev/urandom", O_RDONLY);
+  if (internal_iserror(fd))
+    return false;
+  uptr res = internal_read(fd, buffer, length);
+  if (internal_iserror(res))
+    return false;
+  internal_close(fd);
+  return true;
+#endif
 }
 
 u32 GetNumberOfCPUs() {
