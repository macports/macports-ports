# $Id: Portfile,v 1.13 2005/07/27 18:48:31 gwright Exp $

PortSystem 1.0
name		clisp
version		2.33.2
revision	3
categories	lang
maintainers	gwright@opendarwin.org
platforms	darwin
description	The Clisp Common Lisp Implementation
long_description	\
		CLISP is a Common Lisp implementation by Bruno Haible, \
		formerly of Karlsruhe University, and Michael Stoll, \
		formerly of Munich University, both in Germany. \
		It mostly supports the Lisp described in the \
		ANSI Common Lisp standard. \
		CLISP includes an interpreter, a compiler, almost all \
		of CLOS, a foreign language interface and a socket interface. \
		An X11 interface is available through CLX and Garnet. \
		Command line editing is provided by readline.

homepage	http://clisp.cons.org/
master_sites	gnu:clisp/release/2.33.2 \
		sourceforge

depends_lib	lib:libintl.3:gettext	\
		port:readline		\
		port:gettext

checksums	md5 e1e3b43bca46085e29d7f9daca782a47

patchfiles	patch-src-stream.d

build.dir	${workpath}/${worksrcdir}/src

configure.env	CPPFLAGS=-I${prefix}/include	\
		LDFLAGS=-L${prefix}/lib

post-configure	{ cd ${build.dir}
		  system "./makemake --prefix=${prefix}		\
				     --with-unicode		\
				     --with-readline		\
				     --with-dynamic-ffi		\
				     --with-export-syscalls	\
				     --with-gettext  > Makefile && \
				     make config.lisp"
		}

build		{ system "ulimit -s 8192 &&	\
			  cd ${build.dir} &&	\
			  make &&		\
			  make check"
		}

pre-destroot	{ cd ${build.dir} }


