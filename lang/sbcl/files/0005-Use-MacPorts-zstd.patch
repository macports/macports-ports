From 4a8c4ed98b62317b2e216ee21f67703a89b33634 Mon Sep 17 00:00:00 2001
From: "Kirill A. Korinsky" <kirill@korins.ky>
Date: Tue, 6 Jun 2023 10:20:33 +0200
Subject: [PATCH] Use MacPorts zstd

---
 src/runtime/Config.arm64-darwin  | 4 +++-
 src/runtime/Config.x86-64-darwin | 4 +++-
 2 files changed, 6 insertions(+), 2 deletions(-)

diff --git src/runtime/Config.arm64-darwin src/runtime/Config.arm64-darwin
index 0d3ed389a..d66bd6099 100644
--- src/runtime/Config.arm64-darwin
+++ src/runtime/Config.arm64-darwin
@@ -18,7 +18,9 @@ ifdef LISP_FEATURE_SB_THREAD
   OS_LIBS += -lpthread
 endif
 ifdef LISP_FEATURE_SB_CORE_COMPRESSION
-  OS_LIBS += -lzstd
+  OS_LIBS += -L@@PREFIX@@/lib -lzstd
+  DEPEND_FLAGS += -I@@PREFIX@@/include
+  CFLAGS += -I@@PREFIX@@/include
 endif
 ifdef LISP_FEATURE_SB_LINKABLE_RUNTIME
   LIBSBCL = libsbcl.a
diff --git src/runtime/Config.x86-64-darwin src/runtime/Config.x86-64-darwin
index 2d9e7a669..5a4181f10 100644
--- src/runtime/Config.x86-64-darwin
+++ src/runtime/Config.x86-64-darwin
@@ -29,7 +29,9 @@ ifdef LISP_FEATURE_SB_THREAD
   OS_LIBS += -lpthread
 endif
 ifdef LISP_FEATURE_SB_CORE_COMPRESSION
-  OS_LIBS += -lzstd
+  OS_LIBS += -L@@PREFIX@@/lib -lzstd
+  DEPEND_FLAGS += -I@@PREFIX@@/include
+  CFLAGS += -I@@PREFIX@@/include
 endif
 ifdef LISP_FEATURE_SB_LINKABLE_RUNTIME
   LIBSBCL = libsbcl.a
-- 
2.41.0

