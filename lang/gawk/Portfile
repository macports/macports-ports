# $Id$

PortSystem 1.0
name            gawk
version         3.1.5
revision        2
categories      lang
maintainers     marius@caos.aamu.edu
platforms       darwin
master_sites    gnu
homepage        http://www.gnu.org/software/gawk/
checksums       md5 5703f72d0eea1d463f735aad8222655f
description     The GNU awk utility.
use_bzip2       yes

long_description \
    The awk utility interprets a special-purpose programming language   \
    that makes it possible to handle simple data-reformatting jobs with \
    just a few lines of code. It is a free, extended version of awk. 

patchfiles      patch-dfa.c patch-hard-locale.h

depends_lib     port:libiconv \
                port:gettext

configure.args  --with-libiconv-prefix=${prefix} \
                --infodir=${prefix}/share/info \
                --mandir=${prefix}/share/man

configure.env   CFLAGS="-I${prefix}/include -L${prefix}/lib"

if {[llength [info commands configure.universal_ldflags-append]] > 0} {
    configure.universal_cflags-append -I${prefix}/include -L${prefix}/lib
} else {
    variant universal {
        return -code error "You need to be running MacPorts 1.5.0 or higher to \
        use this variant (universal)."
    }
}

test.run        yes
test.target     check

post-destroot {
    delete ${destroot}${prefix}/bin/awk \
}

platform darwin 6 {
depends_lib-append      lib:libdl:dlcompat
}
