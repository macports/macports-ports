--- a/acinclude.m4.orig	2021-07-23 02:37:06.000000000 +0100
+++ b/acinclude.m4	2021-07-23 02:44:05.000000000 +0100
@@ -1213,14 +1213,14 @@
 #include <unistd.h>
 #include <errno.h>
 $1
-    main() {
+    int main() {
     int fd = open("conftest_in", O_WRONLY|O_CREAT, 0600);
 
-    if (fd < 0) exit(1);
-    if (pwrite(fd, "text", 4, 0) != 4) exit(1);
+    if (fd < 0) return 1;
+    if (pwrite(fd, "text", 4, 0) != 4) return 1;
     /* Linux glibc breakage until 2.2.5 */
-    if (pwrite(fd, "text", 4, -1) != -1 || errno != EINVAL) exit(1);
-    exit(0);
+    if (pwrite(fd, "text", 4, -1) != -1 || errno != EINVAL) return 1;
+    return 0;
     }
 
   ],[
@@ -1243,14 +1243,14 @@
 #include <unistd.h>
 #include <errno.h>
 $1
-    main() {
+    int main() {
     char buf[3]; 
     int fd = open("conftest_in", O_RDONLY);
-    if (fd < 0) exit(1);
-    if (pread(fd, buf, 2, 0) != 2) exit(1);
+    if (fd < 0) return 1;
+    if (pread(fd, buf, 2, 0) != 2) return 1;
     /* Linux glibc breakage until 2.2.5 */
-    if (pread(fd, buf, 2, -1) != -1 || errno != EINVAL) exit(1);
-    exit(0);
+    if (pread(fd, buf, 2, -1) != -1 || errno != EINVAL) return 1;
+    return 0;
     }
   ],[
     ac_cv_pread=yes
@@ -1356,17 +1356,20 @@
 #define PATH_MAX 1024
 #endif
 
-main() {
+int main() {
   DIR *dir;
   char entry[sizeof(struct dirent)+PATH_MAX];
   struct dirent *pentry = (struct dirent *) &entry;
 
   dir = opendir("/");
   if (!dir) 
-    exit(1);
-  if (readdir_r(dir, (struct dirent *) entry, &pentry) == 0)
-    exit(0);
-  exit(1);
+    return 1;
+  if (readdir_r(dir, (struct dirent *) entry, &pentry) == 0) {
+    close(dir);
+    return 0;
+  }
+  close(dir);
+  return 1;
 }
     ],[
       ac_cv_what_readdir_r=POSIX
@@ -1696,6 +1699,7 @@
   AC_CACHE_VAL(_cv_have_broken_glibc_fopen_append,[
   AC_TRY_RUN([
 #include <stdio.h>
+#include <unistd.h>
 int main(int argc, char *argv[])
 {
   FILE *fp;
@@ -1705,7 +1709,7 @@
   fp = fopen(filename, "w");
   if (fp == NULL) {
     perror("fopen");
-    exit(2);
+    return 2;
   }
   fputs("foobar", fp);
   fclose(fp);
@@ -1779,13 +1783,13 @@
 
 cookie_io_functions_t funcs = {reader, writer, seeker, closer};
 
-main() {
+int main() {
   struct cookiedata g = { 0 };
   FILE *fp = fopencookie(&g, "r", funcs);
 
   if (fp && fseek(fp, 8192, SEEK_SET) == 0 && g.pos == 8192)
-    exit(0);
-  exit(1);
+    return 0;
+  return 1;
 }
 
 ], [
--- a/configure.orig	2021-07-23 02:37:06.000000000 +0100
+++ b/configure	2021-07-23 03:08:12.000000000 +0100
@@ -8631,7 +8631,7 @@
   else
     { echo "configure: error: Could not find a pike in $PHP_CAUDIUM/bin/" 1>&2; exit 1; }
   fi
-  if $PIKE -e 'float v; int rel;sscanf(version(), "Pike v%f release %d", v, rel);v += rel/10000.0; if(v < 7.0268) exit(1); exit(0);'; then
+  if $PIKE -e 'float v; int rel;sscanf(version(), "Pike v%f release %d", v, rel);v += rel/10000.0; if(v < 7.0268) return 1; return 0;'; then
     PIKE_MODULE_DIR=`$PIKE --show-paths 2>&1| grep '^Module' | sed -e 's/.*: //'`
     PIKE_INCLUDE_DIR=`echo $PIKE_MODULE_DIR | sed -e 's,lib/pike/modules,include/pike,' -e 's,lib/modules,include/pike,' `
     if test -z "$PIKE_INCLUDE_DIR" || test -z "$PIKE_MODULE_DIR"; then
@@ -12983,7 +12983,7 @@
     { echo "configure: error: Could not find a pike in $PHP_ROXEN/bin/" 1>&2; exit 1; }
   fi
 
-  if $PIKE -e 'float v; catch(v = __VERSION__ + (__BUILD__/10000.0)); if(v < 0.7079) exit(1); exit(0);'; then
+  if $PIKE -e 'float v; catch(v = __VERSION__ + (__BUILD__/10000.0)); if(v < 0.7079) return 1; return 0;'; then
     PIKE_MODULE_DIR=`$PIKE --show-paths 2>&1| grep '^Module' | sed -e 's/.*: //'`
     PIKE_INCLUDE_DIR=`echo $PIKE_MODULE_DIR | sed -e 's,lib/pike/modules,include/pike,' -e 's,lib/modules,include/pike,'`
     if test -z "$PIKE_INCLUDE_DIR" || test -z "$PIKE_MODULE_DIR"; then
@@ -16954,8 +16954,8 @@
 #define TOUPPER(c) (ISLOWER(c) ? 'A' + ((c) - 'a') : (c))
 #define XOR(e, f) (((e) && !(f)) || (!(e) && (f)))
 int main () { int i; for (i = 0; i < 256; i++)
-if (XOR (islower (i), ISLOWER (i)) || toupper (i) != TOUPPER (i)) exit(2);
-exit (0); }
+if (XOR (islower (i), ISLOWER (i)) || toupper (i) != TOUPPER (i)) return 2;
+return 0; }
 
 EOF
 if { (eval echo configure:16962: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -17305,13 +17305,13 @@
 
 cookie_io_functions_t funcs = {reader, writer, seeker, closer};
 
-main() {
+int main() {
   struct cookiedata g = { 0 };
   FILE *fp = fopencookie(&g, "r", funcs);
 
   if (fp && fseek(fp, 8192, SEEK_SET) == 0 && g.pos == 8192)
-    exit(0);
-  exit(1);
+    return 0;
+  return 1;
 }
 
 
@@ -17432,6 +17432,7 @@
 #include "confdefs.h"
 
 #include <stdio.h>
+#include <unistd.h>
 int main(int argc, char *argv[])
 {
   FILE *fp;
@@ -17441,7 +17442,7 @@
   fp = fopen(filename, "w");
   if (fp == NULL) {
     perror("fopen");
-    exit(2);
+    return 2;
   }
   fputs("foobar", fp);
   fclose(fp);
@@ -17887,12 +17888,12 @@
 #line 17888 "configure"
 #include "confdefs.h"
 #include <stdio.h>
-main()
+int main()
 {
   FILE *f=fopen("conftestval", "w");
-  if (!f) exit(1);
+  if (!f) return 1;
   fprintf(f, "%d\n", sizeof(size_t));
-  exit(0);
+  return 0;
 }
 EOF
 if { (eval echo configure:17899: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -17926,12 +17927,12 @@
 #line 17927 "configure"
 #include "confdefs.h"
 #include <stdio.h>
-main()
+int main()
 {
   FILE *f=fopen("conftestval", "w");
-  if (!f) exit(1);
+  if (!f) return 1;
   fprintf(f, "%d\n", sizeof(long long));
-  exit(0);
+  return 0;
 }
 EOF
 if { (eval echo configure:17938: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -17965,12 +17966,12 @@
 #line 17966 "configure"
 #include "confdefs.h"
 #include <stdio.h>
-main()
+int main()
 {
   FILE *f=fopen("conftestval", "w");
-  if (!f) exit(1);
+  if (!f) return 1;
   fprintf(f, "%d\n", sizeof(long long int));
-  exit(0);
+  return 0;
 }
 EOF
 if { (eval echo configure:17977: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -18004,12 +18005,12 @@
 #line 18005 "configure"
 #include "confdefs.h"
 #include <stdio.h>
-main()
+int main()
 {
   FILE *f=fopen("conftestval", "w");
-  if (!f) exit(1);
+  if (!f) return 1;
   fprintf(f, "%d\n", sizeof(long));
-  exit(0);
+  return 0;
 }
 EOF
 if { (eval echo configure:18016: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -18043,12 +18044,12 @@
 #line 18044 "configure"
 #include "confdefs.h"
 #include <stdio.h>
-main()
+int main()
 {
   FILE *f=fopen("conftestval", "w");
-  if (!f) exit(1);
+  if (!f) return 1;
   fprintf(f, "%d\n", sizeof(int));
-  exit(0);
+  return 0;
 }
 EOF
 if { (eval echo configure:18055: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -19000,6 +19001,7 @@
 #line 19001 "configure"
 #include "confdefs.h"
 
+#include <string.h>
 #include <netdb.h>
 #include <sys/types.h>
 #ifndef AF_INET
@@ -19012,11 +19014,11 @@
   hints.ai_flags = AI_NUMERICHOST;
 
   if (getaddrinfo("127.0.0.1", 0, &hints, &ai) < 0) {
-    exit(1);
+    return 1;
   }
 
   if (ai == 0) {
-    exit(1);
+    return 1;
   }
 
   pai = ai;
@@ -19024,16 +19026,16 @@
   while (pai) {
     if (pai->ai_family != AF_INET) {
       /* 127.0.0.1/NUMERICHOST should only resolve ONE way */
-      exit(1);
+      return 1;
     }
     if (pai->ai_addr->sa_family != AF_INET) {
       /* 127.0.0.1/NUMERICHOST should only resolve ONE way */
-      exit(1);
+      return 1;
     }
     pai = pai->ai_next;
   }
   freeaddrinfo(ai);
-  exit(0);
+  return 0;
 }
   
 EOF
@@ -19171,9 +19173,9 @@
 #include "confdefs.h"
 #include <sys/types.h>
 #include <sys/stat.h>
-main() {
+int main() {
 struct stat s, t;
-exit(!(stat ("conftestdata", &s) == 0 && utime("conftestdata", (long *)0) == 0
+return (int)(!(stat ("conftestdata", &s) == 0 && utime("conftestdata", (long *)0) == 0
 && stat("conftestdata", &t) == 0 && t.st_mtime >= s.st_mtime
 && t.st_mtime - s.st_mtime < 120));
 }
@@ -19409,9 +19411,9 @@
   else
     return (&dummy > addr) ? 1 : -1;
 }
-main ()
+int main ()
 {
-  exit (find_stack_direction() < 0);
+  return (int)(find_stack_direction() < 0);
 }
 EOF
 if { (eval echo configure:19418: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -19655,17 +19657,18 @@
 #define PATH_MAX 1024
 #endif
 
-main() {
+int main() {
   DIR *dir;
   char entry[sizeof(struct dirent)+PATH_MAX];
   struct dirent *pentry = (struct dirent *) &entry;
 
   dir = opendir("/");
   if (!dir) 
-    exit(1);
-  if (readdir_r(dir, (struct dirent *) entry, &pentry) == 0)
-    exit(0);
-  exit(1);
+    return 1;
+  if (readdir_r(dir, (struct dirent *) entry, &pentry) == 0) {
+    return 0;
+  }
+  return 1;
 }
     
 EOF
@@ -20706,12 +20709,12 @@
 #line 20707 "configure"
 #include "confdefs.h"
 #include <stdio.h>
-main()
+int main()
 {
   FILE *f=fopen("conftestval", "w");
-  if (!f) exit(1);
+  if (!f) return 1;
   fprintf(f, "%d\n", sizeof(long));
-  exit(0);
+  return 0;
 }
 EOF
 if { (eval echo configure:20718: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -20745,12 +20748,12 @@
 #line 20746 "configure"
 #include "confdefs.h"
 #include <stdio.h>
-main()
+int main()
 {
   FILE *f=fopen("conftestval", "w");
-  if (!f) exit(1);
+  if (!f) return 1;
   fprintf(f, "%d\n", sizeof(int));
-  exit(0);
+  return 0;
 }
 EOF
 if { (eval echo configure:20757: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -47074,12 +47077,12 @@
 #line 47075 "configure"
 #include "confdefs.h"
 #include <stdio.h>
-main()
+int main()
 {
   FILE *f=fopen("conftestval", "w");
-  if (!f) exit(1);
+  if (!f) return 1;
   fprintf(f, "%d\n", sizeof(short));
-  exit(0);
+  return 0;
 }
 EOF
 if { (eval echo configure:47086: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -47113,12 +47116,12 @@
 #line 47114 "configure"
 #include "confdefs.h"
 #include <stdio.h>
-main()
+int main()
 {
   FILE *f=fopen("conftestval", "w");
-  if (!f) exit(1);
+  if (!f) return 1;
   fprintf(f, "%d\n", sizeof(int));
-  exit(0);
+  return 0;
 }
 EOF
 if { (eval echo configure:47125: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -47152,12 +47155,12 @@
 #line 47153 "configure"
 #include "confdefs.h"
 #include <stdio.h>
-main()
+int main()
 {
   FILE *f=fopen("conftestval", "w");
-  if (!f) exit(1);
+  if (!f) return 1;
   fprintf(f, "%d\n", sizeof(long));
-  exit(0);
+  return 0;
 }
 EOF
 if { (eval echo configure:47164: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -47191,12 +47194,12 @@
 #line 47192 "configure"
 #include "confdefs.h"
 #include <stdio.h>
-main()
+int main()
 {
   FILE *f=fopen("conftestval", "w");
-  if (!f) exit(1);
+  if (!f) return 1;
   fprintf(f, "%d\n", sizeof(long long));
-  exit(0);
+  return 0;
 }
 EOF
 if { (eval echo configure:47203: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -53536,8 +53539,8 @@
 #define TOUPPER(c) (ISLOWER(c) ? 'A' + ((c) - 'a') : (c))
 #define XOR(e, f) (((e) && !(f)) || (!(e) && (f)))
 int main () { int i; for (i = 0; i < 256; i++)
-if (XOR (islower (i), ISLOWER (i)) || toupper (i) != TOUPPER (i)) exit(2);
-exit (0); }
+if (XOR (islower (i), ISLOWER (i)) || toupper (i) != TOUPPER (i)) return 2;
+return 0; }
 
 EOF
 if { (eval echo configure:53544: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -57026,12 +57029,12 @@
 #line 57027 "configure"
 #include "confdefs.h"
 #include <stdio.h>
-main()
+int main()
 {
   FILE *f=fopen("conftestval", "w");
-  if (!f) exit(1);
+  if (!f) return 1;
   fprintf(f, "%d\n", sizeof(int));
-  exit(0);
+  return 0;
 }
 EOF
 if { (eval echo configure:57038: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -57065,12 +57068,12 @@
 #line 57066 "configure"
 #include "confdefs.h"
 #include <stdio.h>
-main()
+int main()
 {
   FILE *f=fopen("conftestval", "w");
-  if (!f) exit(1);
+  if (!f) return 1;
   fprintf(f, "%d\n", sizeof(short));
-  exit(0);
+  return 0;
 }
 EOF
 if { (eval echo configure:57077: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -57104,12 +57107,12 @@
 #line 57105 "configure"
 #include "confdefs.h"
 #include <stdio.h>
-main()
+int main()
 {
   FILE *f=fopen("conftestval", "w");
-  if (!f) exit(1);
+  if (!f) return 1;
   fprintf(f, "%d\n", sizeof(long));
-  exit(0);
+  return 0;
 }
 EOF
 if { (eval echo configure:57116: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -57451,7 +57454,7 @@
 }
 main ()
 {
-  exit (find_stack_direction() < 0);
+  return (int)(find_stack_direction() < 0);
 }
 EOF
 if { (eval echo configure:57458: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -57487,10 +57490,10 @@
 #line 57488 "configure"
 #include "confdefs.h"
 
-main()
+int main()
 {
   char c0 = 0x40, c1 = 0x80, c2 = 0x81;
-  exit(memcmp(&c0, &c2, 1) < 0 && memcmp(&c1, &c2, 1) < 0 ? 0 : 1);
+  return (int)(memcmp(&c0, &c2, 1) < 0 && memcmp(&c1, &c2, 1) < 0 ? 0 : 1);
 }
 
 EOF
@@ -62881,12 +62884,12 @@
 #line 62882 "configure"
 #include "confdefs.h"
 #include <stdio.h>
-main()
+int main()
 {
   FILE *f=fopen("conftestval", "w");
-  if (!f) exit(1);
+  if (!f) return 1;
   fprintf(f, "%d\n", sizeof(long int));
-  exit(0);
+  return 0;
 }
 EOF
 if { (eval echo configure:62893: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -70715,12 +70718,12 @@
 #line 70716 "configure"
 #include "confdefs.h"
 #include <stdio.h>
-main()
+int main()
 {
   FILE *f=fopen("conftestval", "w");
-  if (!f) exit(1);
+  if (!f) return 1;
   fprintf(f, "%d\n", sizeof(long int));
-  exit(0);
+  return 0;
 }
 EOF
 if { (eval echo configure:70727: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -70917,12 +70920,12 @@
 #line 70918 "configure"
 #include "confdefs.h"
 #include <stdio.h>
-main()
+int main()
 {
   FILE *f=fopen("conftestval", "w");
-  if (!f) exit(1);
+  if (!f) return 1;
   fprintf(f, "%d\n", sizeof(long int));
-  exit(0);
+  return 0;
 }
 EOF
 if { (eval echo configure:70929: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -82472,14 +82475,14 @@
 #include <unistd.h>
 #include <errno.h>
 
-    main() {
+    int main() {
     int fd = open("conftest_in", O_WRONLY|O_CREAT, 0600);
 
-    if (fd < 0) exit(1);
-    if (pwrite(fd, "text", 4, 0) != 4) exit(1);
+    if (fd < 0) return 1;
+    if (pwrite(fd, "text", 4, 0) != 4) return 1;
     /* Linux glibc breakage until 2.2.5 */
-    if (pwrite(fd, "text", 4, -1) != -1 || errno != EINVAL) exit(1);
-    exit(0);
+    if (pwrite(fd, "text", 4, -1) != -1 || errno != EINVAL) return 1;
+    return 0;
     }
 
   
@@ -82518,14 +82521,14 @@
 #include <unistd.h>
 #include <errno.h>
 ssize_t pwrite(int, void *, size_t, off64_t);
-    main() {
+    int main() {
     int fd = open("conftest_in", O_WRONLY|O_CREAT, 0600);
 
-    if (fd < 0) exit(1);
-    if (pwrite(fd, "text", 4, 0) != 4) exit(1);
+    if (fd < 0) return 1;
+    if (pwrite(fd, "text", 4, 0) != 4) return 1;
     /* Linux glibc breakage until 2.2.5 */
-    if (pwrite(fd, "text", 4, -1) != -1 || errno != EINVAL) exit(1);
-    exit(0);
+    if (pwrite(fd, "text", 4, -1) != -1 || errno != EINVAL) return 1;
+    return 0;
     }
 
   
@@ -82593,14 +82596,14 @@
 #include <unistd.h>
 #include <errno.h>
 
-    main() {
+    int main() {
     char buf[3]; 
     int fd = open("conftest_in", O_RDONLY);
-    if (fd < 0) exit(1);
-    if (pread(fd, buf, 2, 0) != 2) exit(1);
+    if (fd < 0) return 1;
+    if (pread(fd, buf, 2, 0) != 2) return 1;
     /* Linux glibc breakage until 2.2.5 */
-    if (pread(fd, buf, 2, -1) != -1 || errno != EINVAL) exit(1);
-    exit(0);
+    if (pread(fd, buf, 2, -1) != -1 || errno != EINVAL) return 1;
+    return 0;
     }
   
 EOF
@@ -82640,14 +82643,14 @@
 #include <unistd.h>
 #include <errno.h>
 ssize_t pread(int, void *, size_t, off64_t);
-    main() {
+    int main() {
     char buf[3]; 
     int fd = open("conftest_in", O_RDONLY);
-    if (fd < 0) exit(1);
-    if (pread(fd, buf, 2, 0) != 2) exit(1);
+    if (fd < 0) return 1;
+    if (pread(fd, buf, 2, 0) != 2) return 1;
     /* Linux glibc breakage until 2.2.5 */
-    if (pread(fd, buf, 2, -1) != -1 || errno != EINVAL) exit(1);
-    exit(0);
+    if (pread(fd, buf, 2, -1) != -1 || errno != EINVAL) return 1;
+    return 0;
     }
   
 EOF
@@ -88473,12 +88476,12 @@
 #line 88474 "configure"
 #include "confdefs.h"
 #include <stdio.h>
-main()
+int main()
 {
   FILE *f=fopen("conftestval", "w");
-  if (!f) exit(1);
+  if (!f) return 1;
   fprintf(f, "%d\n", sizeof(char *));
-  exit(0);
+  return 0;
 }
 EOF
 if { (eval echo configure:88485: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -88656,6 +88659,8 @@
 
 #include <stdio.h>
 #include <stdlib.h>
+#include <string.h>
+#include <unistd.h>
 
 int main(int argc, char **argv)
 {
@@ -88685,7 +88690,7 @@
 	fclose(fp);
 	unlink(filename);
 
-	exit(result);
+	return result;
 }
 
 EOF
@@ -88779,6 +88784,8 @@
 #line 88780 "configure"
 #include "confdefs.h"
 
+#include <string.h>
+
 #if HAVE_UNISTD_H
 #include <unistd.h>
 #endif
@@ -88787,11 +88794,11 @@
 #include <crypt.h>
 #endif
 
-main() {
+int main() {
 #if HAVE_CRYPT
-    exit (strcmp((char *)crypt("rasmuslerdorf","rl"),"rl.3StKT.4T8M"));
+    return strcmp((char *)crypt("rasmuslerdorf","rl"),"rl.3StKT.4T8M");
 #else
-	exit(0);
+	return 0;
 #endif
 }
 EOF
@@ -88830,6 +88837,8 @@
 #line 88831 "configure"
 #include "confdefs.h"
 
+#include <string.h>
+
 #if HAVE_UNISTD_H
 #include <unistd.h>
 #endif
@@ -88838,11 +88847,11 @@
 #include <crypt.h>
 #endif
 
-main() {
+int main() {
 #if HAVE_CRYPT
-  exit (strcmp((char *)crypt("rasmuslerdorf","_J9..rasm"),"_J9..rasmBYk8r9AiWNc"));
+  return strcmp((char *)crypt("rasmuslerdorf","_J9..rasm"),"_J9..rasmBYk8r9AiWNc");
 #else
-  exit(0);
+  return 0;
 #endif
 }
 EOF
@@ -88881,6 +88890,8 @@
 #line 88882 "configure"
 #include "confdefs.h"
 
+#include <string.h>
+
 #if HAVE_UNISTD_H
 #include <unistd.h>
 #endif
@@ -88889,7 +88900,7 @@
 #include <crypt.h>
 #endif
 
-main() {
+int main() {
 #if HAVE_CRYPT
     char salt[15], answer[40];
 
@@ -88900,9 +88911,9 @@
     salt[12]='\0';
     strcpy(answer,salt);
     strcat(answer,"rISCgZzpwk3UhDidwXvin0");
-    exit (strcmp((char *)crypt("rasmuslerdorf",salt),answer));
+    return strcmp((char *)crypt("rasmuslerdorf",salt),answer);
 #else
-	exit(0);
+	return 0;
 #endif
 }
 EOF
@@ -88941,6 +88952,8 @@
 #line 88942 "configure"
 #include "confdefs.h"
 
+#include <string.h>
+
 #if HAVE_UNISTD_H
 #include <unistd.h>
 #endif
@@ -88949,7 +88962,7 @@
 #include <crypt.h>
 #endif
 
-main() {
+int main() {
 #if HAVE_CRYPT
     char salt[30], answer[70];
     
@@ -88957,9 +88970,9 @@
     strcat(salt,"rasmuslerd............");
     strcpy(answer,salt);
     strcpy(&answer[29],"nIdrcHdxcUxWomQX9j6kvERCFjTg7Ra");
-    exit (strcmp((char *)crypt("rasmuslerdorf",salt),answer));
+    return strcmp((char *)crypt("rasmuslerdorf",salt),answer);
 #else
-	exit(0);
+	return 0;
 #endif
 }
 EOF
@@ -88998,6 +89011,8 @@
 #line 88999 "configure"
 #include "confdefs.h"
 
+#include <string.h>
+
 #if HAVE_UNISTD_H
 #include <unistd.h>
 #endif
@@ -89006,16 +89021,16 @@
 #include <crypt.h>
 #endif
 
-main() {
+int main() {
 #if HAVE_CRYPT
     char salt[30], answer[80];
     
     salt[0]='$'; salt[1]='6'; salt[2]='$'; salt[3]='$'; salt[4]='b'; salt[5]='a'; salt[6]='r'; salt[7]='\0';
     strcpy(answer, salt);
     strcpy(&answer[29],"$6$$QMXjqd7rHQZPQ1yHsXkQqC1FBzDiVfTHXL.LaeDAeVV.IzMaV9VU4MQ8kPuZa2SOP1A0RPm772EaFYjpEJtdu.");
-    exit (strcmp((char *)crypt("foo",salt),answer));
+    return strcmp((char *)crypt("foo",salt),answer);
 #else
-	exit(0);
+	return 0;
 #endif
 }
 EOF
@@ -89054,6 +89069,8 @@
 #line 89055 "configure"
 #include "confdefs.h"
 
+#include <string.h>
+
 #if HAVE_UNISTD_H
 #include <unistd.h>
 #endif
@@ -89062,16 +89079,16 @@
 #include <crypt.h>
 #endif
 
-main() {
+int main() {
 #if HAVE_CRYPT
     char salt[30], answer[80];
     salt[0]='$'; salt[1]='5'; salt[2]='$'; salt[3]='$'; salt[4]='s'; salt[5]='a'; salt[6]='l'; salt[7]='t';  salt[8]='s'; salt[9]='t'; salt[10]='r'; salt[11]='i'; salt[12]='n'; salt[13]='g'; salt[14]='\0';    
     strcat(salt,"");
     strcpy(answer, salt);
     strcpy(&answer[29], "$5$saltstring$5B8vYYiY.CVt1RlTTf8KbXBH3hsxY/GNooZaBBGWEc5");
-    exit (strcmp((char *)crypt("foo",salt),answer));
+    return strcmp((char *)crypt("foo",salt),answer);
 #else
-	exit(0);
+	return 0;
 #endif
 }
 EOF
@@ -89401,7 +89418,7 @@
   cat > conftest.$ac_ext <<EOF
 #line 89403 "configure"
 #include "confdefs.h"
-main() { exit (fnmatch ("a*", "abc", 0) != 0); }
+main() { return (int)(fnmatch ("a*", "abc", 0) != 0); }
 EOF
 if { (eval echo configure:89407: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
@@ -93438,12 +93455,12 @@
 #line 93439 "configure"
 #include "confdefs.h"
 #include <stdio.h>
-main()
+int main()
 {
   FILE *f=fopen("conftestval", "w");
-  if (!f) exit(1);
+  if (!f) return 1;
   fprintf(f, "%d\n", sizeof(long int));
-  exit(0);
+  return 0;
 }
 EOF
 if { (eval echo configure:93450: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -101264,8 +101281,8 @@
 #define TOUPPER(c) (ISLOWER(c) ? 'A' + ((c) - 'a') : (c))
 #define XOR(e, f) (((e) && !(f)) || (!(e) && (f)))
 int main () { int i; for (i = 0; i < 256; i++)
-if (XOR (islower (i), ISLOWER (i)) || toupper (i) != TOUPPER (i)) exit(2);
-exit (0); }
+if (XOR (islower (i), ISLOWER (i)) || toupper (i) != TOUPPER (i)) return 2;
+return 0; }
 
 EOF
 if { (eval echo configure:101272: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -101348,12 +101365,12 @@
 #line 101349 "configure"
 #include "confdefs.h"
 #include <stdio.h>
-main()
+int main()
 {
   FILE *f=fopen("conftestval", "w");
-  if (!f) exit(1);
+  if (!f) return 1;
   fprintf(f, "%d\n", sizeof(char));
-  exit(0);
+  return 0;
 }
 EOF
 if { (eval echo configure:101360: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -101388,12 +101405,12 @@
 #line 101389 "configure"
 #include "confdefs.h"
 #include <stdio.h>
-main()
+int main()
 {
   FILE *f=fopen("conftestval", "w");
-  if (!f) exit(1);
+  if (!f) return 1;
   fprintf(f, "%d\n", sizeof(int));
-  exit(0);
+  return 0;
 }
 EOF
 if { (eval echo configure:101400: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -101427,12 +101444,12 @@
 #line 101428 "configure"
 #include "confdefs.h"
 #include <stdio.h>
-main()
+int main()
 {
   FILE *f=fopen("conftestval", "w");
-  if (!f) exit(1);
+  if (!f) return 1;
   fprintf(f, "%d\n", sizeof(long));
-  exit(0);
+  return 0;
 }
 EOF
 if { (eval echo configure:101439: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -101466,12 +101483,12 @@
 #line 101467 "configure"
 #include "confdefs.h"
 #include <stdio.h>
-main()
+int main()
 {
   FILE *f=fopen("conftestval", "w");
-  if (!f) exit(1);
+  if (!f) return 1;
   fprintf(f, "%d\n", sizeof(long long));
-  exit(0);
+  return 0;
 }
 EOF
 if { (eval echo configure:101478: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -105642,10 +105659,10 @@
 #line 105643 "configure"
 #include "confdefs.h"
 
-main()
+int main()
 {
   char c0 = 0x40, c1 = 0x80, c2 = 0x81;
-  exit(memcmp(&c0, &c2, 1) < 0 && memcmp(&c1, &c2, 1) < 0 ? 0 : 1);
+  return (int)(memcmp(&c0, &c2, 1) < 0 && memcmp(&c1, &c2, 1) < 0 ? 0 : 1);
 }
 
 EOF
@@ -105876,7 +105893,7 @@
 }
 main ()
 {
-  exit (find_stack_direction() < 0);
+  return (int)(find_stack_direction() < 0);
 }
 EOF
 if { (eval echo configure:105883: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
@@ -105970,7 +105987,8 @@
   cat > conftest.$ac_ext <<EOF
 #line 105972 "configure"
 #include "confdefs.h"
-main() {char buf[20];exit(sprintf(buf,"testing 123")!=11); }
+#include <stdio.h>
+int main() {char buf[20]; return sprintf(buf,"testing 123")!=11; }
 EOF
 if { (eval echo configure:105976: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
@@ -106340,16 +106358,16 @@
 		double d = (double) LONG_MIN * LONG_MIN + 2e9;
 
 		if ((long) d == 2e9 && (long) -d == -2e9) {
-			exit(0);
+			return 0;
 		}
 	} else if (sizeof(long) == 8) {
 		double correct = 18e18 - ((double) LONG_MIN * -2); /* Subtract ULONG_MAX + 1 */
 
 		if ((long) 18e18 == correct) { /* On 64-bit, only check between LONG_MAX and ULONG_MAX */
-			exit(0);
+			return 0;
 		}
 	}
-	exit(1);
+	return 1;
 }
 
 EOF
@@ -106465,10 +106483,6 @@
 #  endif
 #endif
 
-#ifdef __cplusplus
-extern "C" void exit (int);
-#endif
-
 void fnord() { int i=42;}
 int main ()
 {
@@ -106484,7 +106498,7 @@
   else
     puts (dlerror ());
 
-    exit (status);
+    return status;
 }
 EOF
   if { (eval echo configure:106491: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -106754,7 +106768,7 @@
   fprintf(fp, "%d %d\n", ZEND_MM_ALIGNMENT, zeros);  
   fclose(fp);
 
-  exit(0);
+  return 0;
 }
 
 EOF
@@ -106866,6 +106880,7 @@
 #include <sys/mman.h>
 #include <stdlib.h>
 #include <stdio.h>
+#include <unistd.h>
 #ifndef MAP_ANON
 # ifdef MAP_ANONYMOUS
 #  define MAP_ANON MAP_ANONYMOUS
@@ -112370,10 +112385,6 @@
 #  endif
 #endif
 
-#ifdef __cplusplus
-extern "C" void exit (int);
-#endif
-
 void fnord() { int i=42;}
 int main ()
 {
@@ -112389,7 +112400,7 @@
   else
     puts (dlerror ());
 
-    exit (status);
+    return status;
 }
 EOF
   if { (eval echo configure:112396: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -112466,10 +112477,6 @@
 #  endif
 #endif
 
-#ifdef __cplusplus
-extern "C" void exit (int);
-#endif
-
 void fnord() { int i=42;}
 int main ()
 {
@@ -112485,7 +112492,7 @@
   else
     puts (dlerror ());
 
-    exit (status);
+    return status;
 }
 EOF
   if { (eval echo configure:112492: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} 2>/dev/null; then
