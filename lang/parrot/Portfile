# $Id$

PortSystem              1.0

name			parrot
version			0.5.2
categories		lang devel
maintainers		bfulgham coleda.com:will
description		Open source virtual machine (for Perl6 et al.)
long_description	\
 	Parrot is the new interpreter being designed from scratch to support \
	the upcoming Perl 6 language.  It is being designed as a standalone \
	virtual machine that can be used to execute bytecode-compiled \
	dynamic languages such as Perl 6, Perl 5, Python, Tcl, etc.

platforms		darwin
homepage		http://www.parrotcode.org/
master_sites		http://www.cpan.org/authors/id/R/RG/RGRJR/

checksums		md5 0a87f7e5437315f67c0848c5cb2b6d0b

depends_build		bin:perl:perl5.8
depends_lib			port:gmp port:icu

configure.cmd		perl Configure.pl
configure.pre_args	--prefix=${prefix}/lib/parrot
# build static to avoid runtime lib issues for now
configure.args		--optimize --parrot_is_shared=0

# install target is temporarily disabled as it might conflict with development
# users of a port should have no such trouble, however.
destroot.target         reallyinstall

build.type		gnu
build.target

test.run		yes
test.target		test

destroot.destdir	 PREFIX=${destroot}${prefix}/lib/parrot

post-destroot {
	set bindir	${destroot}${prefix}/bin
	set docdir      ${destroot}${prefix}/share/doc/${name}
	system "cd ${bindir} && ln -sf ${prefix}/lib/parrot/bin/parrot"

	xinstall -m 755 -d ${docdir}
}

platform darwin 8 {
	configure.args-append --cc=/usr/bin/gcc-4.0 --link=/usr/bin/gcc-4.0 \
		--ld=/usr/bin/gcc-4.0 --cxx=/usr/bin/g++-4.0
}
