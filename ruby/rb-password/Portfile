# $Id: Portfile,v 1.4 2004/09/08 00:38:52 rshaw Exp $
PortSystem		1.0
PortGroup		ruby 1.0

ruby.setup		{password ruby-password} 0.5.2 extconf.rb {README doc example}
revision		1
maintainers		rshaw@opendarwin.org
description		password manipulation methods for Ruby
long_description	Ruby/Password comprises a set of useful methods for \
					creating, verifying and manipulating passwords. It \
					includes an interface to CrackLib, a library \
					commonly used for checking password strength.  The \
					target audience for this library is system \
					administrators who need to write Ruby programs that \
					prompt for, generate, verify and encrypt passwords. 
categories-append	sysutils
homepage		http://www.caliban.org/ruby/
master_sites	http://www.caliban.org/files/ruby/
checksums		md5 6a33fb9dd039f07fe2b81a0d8eed7f6f
platforms		darwin

depends_lib-append		lib:libcrack.2:cracklib \
				lib:XXX:rb-termios

patchfiles		patch-tc_password.rb
post-patch {
	cd ${worksrcpath}
	reinplace "s|^#!.*ruby|#!${ruby.bin}|" example/example.rb example/pwgen
	reinplace "s|/usr/local|${prefix}|g" extconf.rb
	reinplace "s|pw_dict|cracklib/&|g" extconf.rb
}

post-build {
	system "cd ${worksrcpath} && ${ruby.rdoc} -x CVS rbcrack.c"
}

test.run		yes
test.cmd		${ruby.bin} test/tc_password.rb

