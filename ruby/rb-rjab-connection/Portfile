# $Id: Portfile,v 1.3 2004/04/02 08:05:37 rshaw Exp $
PortSystem 1.0

name			rb-rjab-connection
version			0.1.1
revision		1
categories		ruby
maintainers		jdputsch@comcast.net
description		Library allowing Ruby apps to talk to a Jabber IM system. 
long_description	rjab-connection is a pure ruby port of D.J. Adams' \
                    Net::Jabber::Connection perl module using REXML as \
                    the stream parser. This release supports Zero-k, \
                    Digest, and Plaintext authentication, so it is safe to \
                    use across untrusted networks. The API is very \
                    low-level, but easy enough to understand. Account \
                    creation is not supported _yet_.
homepage		http://www.sourceforge.net/projects/rjab
platforms		darwin
master_sites	sourceforge:rjab
dist_subdir		ruby
distfiles		rjab-connection-0.1.1.tar.gz
worksrcdir		rjab-connection
checksums		md5 8a13d7fa0fb12c06d6b6bf13e718a220

set ruby ${prefix}/bin/ruby

patchfiles      patch-conn_connection.rb \
                patch-node.rb \
                patch-ns.rb \
                patch-rjab_connection.rb \
                patch-xmllistener.rb \
                patch-test-tc_Connection.rb \
                patch-test-tc_Node.rb \
                patch-test-tc_all.rb

depends_build	path:${ruby}:ruby

configure {
	cd ${worksrcpath}
	reinplace "s|site_ruby|vendor_ruby|" install.rb
	reinplace "s|\$:|'${destroot}'+&|" install.rb 
}

build			{}

test.run        yes
test.dir        ${worksrcpath}/tests
test.cmd        ${ruby} -I../lib tc_all.rb
test.target

destroot.cmd	${ruby} install.rb
destroot.target
destroot.destdir

post-destroot {
	system "rm -rf ${destroot}${prefix}/lib/ruby/vendor_ruby/1.8/rjab/rexml"
}
