# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           compiler_blacklist_versions 1.0
PortGroup           cmake 1.1
PortGroup           qt4 1.0

name                scribus
epoch               1
version             1.4.7
revision            2
categories          print
license             GPL-2+
platforms           darwin
maintainers         nomaintainer

description         qt4-based WYSIWYG desktop publishing application

long_description    Scribus is an open source desktop publishing program. It \
                    provides true WYSIWYG editing, excellent PDF export \
                    facilities, and a wide range of other input and output \
                    options.

homepage            http://www.scribus.net/
master_sites        sourceforge:project/scribus/scribus/${version}
use_xz              yes

checksums           rmd160  e748a7d180b53f1716dfa0e876b61fdab5fecbff \
                    sha256  42d335b4a59c26c8ae1e3f601676baa3c42b035b8cde326d195f7a30078e5fec \
                    size    72763748

# Builds forever with llvm-gcc-4.2. https://trac.macports.org/ticket/30835
# blacklist compilers with known problems on older systems
compiler.blacklist-append  *gcc-3.* *gcc-4.* {clang < 300}

depends_build-append \
                    path:bin/perl:perl5

depends_lib-append  port:hunspell \
                    port:fontconfig \
                    port:ghostscript \
                    port:hyphen \
                    path:lib/pkgconfig/cairo.pc:cairo \
                    port:boost \
                    port:expat \
                    port:jpeg \
                    port:libart_lgpl \
                    port:libiconv \
                    port:lcms2 \
                    port:libpng\
                    port:libxml2 \
                    port:podofo \
                    port:python27 \
                    port:tiff \
                    port:zlib

patchfiles          patch-CMakeLists.txt.diff

set PyFRM           ${frameworks_dir}/Python.framework/Versions

configure.args-append \
                    -DCMAKE_INSTALL_PREFIX="${applications_dir}/[string toupper ${name} 0].app" \
                    -DPYTHON_LIBRARY="${prefix}/lib/libpython2.7.dylib" \
                    -DPYTHON_INCLUDE_DIR="${PyFRM}/2.7/include/python2.7" \
                    -DWITH_PODOFO=YES

build.env           HOME=${worksrcpath}

livecheck.regex     "${name}-(\\d+\\.\\d*\[02468\](?:\\.\\d+)*)${extract.suffix}"
