# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem      1.0

name            gnome3-core
version         3.22.2
revision        1
categories      gnome
license         Permissive
maintainers     {devans @dbevans} openmaintainer
description     The Core GNOME 3 User Experience module set
long_description \
                ${description}
homepage        https://help.gnome.org/misc/release-notes/3.16/
master_sites
platforms       darwin
distfiles

#
# This is a metaport
#

supported_archs noarch

#
# TODO
#
# The following modules are included in the current GNOME core
# module set but have not yet been ported to MacPorts
#
# NetworkManager
# cantarell-fonts
# caribou
# cheese
# gnome-bluetooth
# gnome-boxes
# gnome-color-manager (no support for darwin Mac OS X, requires colord, udev)
# gnome-contacts
# gnome-disk-utility
# gnome-documents
# gnome-initial-setup
# gnome-logs
# gnome-screenshot (X11 only, XQuartz does not support grab of window image from server to client).
# gnome-shell
# gnome-shell-extensions
# gnome-software
# gnome-user-share
# gnome-video-effects
# gom
# gsound
# gtk-vnc
# libgepub
# libgovert
# libgxps
# libvirt-glib
# libzapojit
# mousetweaks
# mutter
# network-manager-applet
# orca
# phodav
# pyatspi
# sushi
#
# BROKEN PORTS
#
# The following ports are included in the current GNOME desktop
# environment specification and have been ported to MacPorts but
# are currently broken and/or need to be updated
#
# gdm (builds but doesn't work due to missing OSX specific functionality in glib2, dependency on systemd)
# gnome-system-monitor (builds but segfaults on processes/resources due to g_free error in libgtop-server #41542)
#

depends_lib     port:adwaita-icon-theme \
                port:at-spi2-atk \
                port:at-spi2-core \
                port:atk \
                port:atkmm \
                port:baobab \
                port:clutter \
                port:clutter-gst \
                port:clutter-gst3 \
                port:clutter-gtk \
                port:cogl \
                port:dconf \
                port:eog \
                port:epiphany \
                port:evince \
                port:evolution-data-server \
                port:file-roller \
                port:folks \
                port:gcab \
                port:gcr \
                port:gdk-pixbuf2 \
                port:gedit \
                port:gegl-0.3 \
                port:geocode-glib \
                port:gjs \
                path:lib/pkgconfig/glib-2.0.pc:glib2 \
                port:glib-networking \
                port:glibmm \
                port:gmime \
                port:gnome-backgrounds \
                port:gnome-calculator \
                port:gnome-calendar \
                port:gnome-characters \
                port:gnome-control-center \
                port:gnome-desktop \
                port:gnome-font-viewer \
                port:gnome-getting-started-docs \
                port:gnome-keyring \
                port:gnome-maps \
                port:gnome-menus \
                port:gnome-online-accounts \
                port:gnome-photos \
                port:gnome-session \
                port:gnome-settings-daemon \
                port:gnome-terminal \
                port:gnome-themes-standard \
                port:gnome-user-docs \
                port:gnome-weather \
                port:gobject-introspection \
                port:grilo \
                port:grilo-plugins \
                port:gsettings-desktop-schemas \
                port:gssdp \
                port:gspell \
                port:gtk3 \
                port:gtk2 \
                port:gtk-doc \
                port:gtk-engines2 \
                port:gtkmm3 \
                port:gtksourceview3 \
                port:gupnp \
                port:gupnp-av \
                port:gupnp-dlna \
                port:gupnp-igd \
                port:gvfs \
                port:json-glib \
                port:libchamplain \
                port:libcroco \
                port:libgdata \
                port:libgee \
                port:gfbgraph \
                port:libgnomekbd \
                port:libgrss \
                port:libgsf \
                port:libgtop \
                port:libgweather \
                port:libmediaart \
                port:libnotify \
                port:libpeas \
                port:rest \
                port:librsvg \
                port:libsecret \
                port:libsigcxx2 \
                port:libsoup \
                port:libwnck3 \
                port:libxml2 \
                port:libxslt \
                port:mm-common \
                port:nautilus \
                path:lib/pkgconfig/pango.pc:pango \
                port:pangomm \
                port:totem \
                port:totem-pl-parser \
                port:tracker \
                port:vala \
                port:vino \
                port:vte \
                port:yelp \
                port:yelp-tools \
                port:yelp-xsl \
                port:zenity

# ports that require libc++ to build
# skip if default C++ stdlib is not libc++

platform darwin {
    if {${configure.cxx_stdlib} eq "libc++"} {
        depends_lib-append  \
                port:gnome-online-miners
    }
}

use_configure   no
build           { }

variant broken description {Build ports that are broken or need work} {
    depends_lib-append \
        port:gdm \
        port:gnome-system-monitor
}

variant python27 description {Build gobjects support for Python 2.7} {
    depends_lib-append \
        port:py27-gobject3
}

variant python34 description {Build gobjects support for Python 3.4} {
    depends_lib-append \
        port:py34-gobject3
}

variant python35 description {Build gobjects support for Python 3.5} {
    depends_lib-append \
        port:py35-gobject3
}

variant python36 description {Build gobjects support for Python 3.6} {
    depends_lib-append \
        port:py36-gobject3
}

if {![variant_isset python34] && ![variant_isset python35]} {
    default_variants +python27 +python36
}

destroot        {
    file mkdir ${destroot}${prefix}/share/doc/gnome
    file copy ${filespath}/versions.txt ${destroot}${prefix}/share/doc/gnome/${name}.versions.txt
}

livecheck.type  none
