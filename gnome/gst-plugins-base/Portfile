# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem 1.0

name		gst-plugins-base
version		0.10.21
description	This is gst-plugins, a set of plug-ins for GStreamer.
long_description        ${description}
maintainers	nomaintainer
categories	gnome
platforms	darwin
homepage	http://www.gnome.org/

# port:liboil is not universal
universal_variant no

use_bzip2 	yes
master_sites    gnome:sources/gst-plugins-base/0.10/ http://gstreamer.freedesktop.org/src/${name}/

checksums       md5     0e0cd485311502ad1c0c028148e3186a \
                sha1    ae83b3306f52aa3affd014dade30c6cd5c2baa66 \
                rmd160  4fa9056c8cc5d21db30074596831ffc14f6b671b

depends_lib	\
	port:gstreamer \
	port:gnome-vfs \
	port:liboil \
	port:libogg \
	port:libtheora \
	port:libvorbis \
	port:cdparanoia

use_autoreconf  yes
autoreconf.args -fvi

# Fix build issue when some packages aren't present
# http://sourceforge.net/mailarchive/forum.php?thread_name=48ECEA1E.1040601%40versatile.com&forum_name=gstreamer-devel
# (first patch, second is for destroot phase, like gstreamer's patch)
patchfiles       patch-tests_icles_Makefile.in patch-docs_libs_Makefile.in.diff

configure.args   --enable-experimental
# configure.cppflags-append  -I${prefix}/include/cdparanoia/paranoia -I${prefix}/include/cdparanoia/interface

# configure.env PYTHON=${prefix}/bin/python2.5 doesn't work
pre-configure {
        reinplace "s|python python2.2|python2.5 python2.2|" ${worksrcpath}/configure
}

#configure.env   CPPFLAGS="-L${prefix}/lib -I${prefix}/include" LDFLAGS="-L${prefix}/lib" \
#                CFLAGS="-no-cpp-precomp -funroll-loops -fstrict-aliasing"
#post-extract {
#	reinplace "s|-flat_namespace -undefined suppress|-undefined define_a_way|g" \
#		${worksrcpath}/configure
#}

livecheck.check regex
livecheck.url   http://gstreamer.freedesktop.org/src/${name}/
livecheck.regex "${name}-(\\d+(?:\\.\\d+)*)${extract.suffix}"
