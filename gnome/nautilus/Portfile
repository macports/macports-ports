# $Id: Portfile,v 1.8 2005/03/24 14:22:42 olegb Exp $
PortSystem 1.0
name		nautilus
version		2.10.0
description	The GNOME filemanager
long_description       	Nautilus is the official file manager for the \
			GNOME desktop. It is designed to be primarly a file manager, \
			but there are support for web and file viewing too.  
maintainers	gnome-darwinports@opendarwin.org
categories	gnome
platforms	darwin 
homepage	http://www.gnome.org/
master_sites    gnome:sources/nautilus/2.10/
checksums	md5 b29a02be8733a82e002179e2e0f3fe83
depends_lib	lib:libeel-2:eel lib:libexif.12:libexif
patchfiles	patch_nautilus-emblem-utils.c patch_nautilus-program-choosing.c 
use_bzip2 	yes
configure.args  --mandir=${prefix}/share/man
configure.env   CPPFLAGS="-L${prefix}/lib -I${prefix}/include" \
		CFLAGS="-flat_namespace -undefined suppress" \
		LDFLAGS="-L${prefix}/lib -lXft -lXrender -L/usr/X11R6/lib -lX11 -lXinerama -lXrandr -lXext"
post-extract {
	reinplace "s|-no-undefined||g"  \
		${worksrcpath}/libnautilus-private/Makefile.in \
		${worksrcpath}/libnautilus-extension/Makefile.in
}
pre-build {
	reinplace "s|-lesd||g" ${worksrcpath}/libnautilus-extension/Makefile
	reinplace "s|-lesd||g" ${worksrcpath}/cut-n-paste-code/Makefile
	reinplace "s|-lesd||g" ${worksrcpath}/cut-n-paste-code/widgets/gimphwrapbox/Makefile
	reinplace "s|-lesd||g" ${worksrcpath}/cut-n-paste-code/libegg/Makefile
	reinplace "s|-lesd||g" ${worksrcpath}/cut-n-paste-code/gsequence/Makefile
	reinplace "s|-lesd||g" ${worksrcpath}/libbackground/Makefile
	reinplace "s|-lesd||g" ${worksrcpath}/src/file-manager/Makefile
	reinplace "s|-lesd||g" ${worksrcpath}/libnautilus-private/Makefile

	reinplace "s|string URI|string URII|g" ${worksrcpath}/src/nautilus-shell-interface.idl
       	reinplace "s|sequence<URI>|sequence<URII>|g" ${worksrcpath}/src/nautilus-shell-interface.idl
}
