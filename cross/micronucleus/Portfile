# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0

PortGroup           github 1.0

github.setup        micronucleus micronucleus 2.6 v
github.tarball_from archive
revision            0

categories          cross
maintainers         {@mholling gmail.com:mdholling} openmaintainer
description         Micronucleus is a bootloader designed for AVR ATtiny microcontrollers
long_description    Micronucleus is a bootloader designed for AVR ATtiny microcontrollers \
                    with a minimal usb interface, cross platform libusb-based program \
                    upload tool, and a strong emphasis on bootloader compactness.
license             GPL-2

checksums           rmd160  ada983ecb8278cb792cc2641b780a538ad2acadc \
                    sha256  586d7bb1c064fe93dc5fc5b5ae0651641cd7fa8272b06cfd11feb6a0b2a06b9c \
                    size    2219881

depends_build-append \
                    path:bin/pkg-config:pkgconfig

depends_lib-append  path:lib/pkgconfig/libusb-1.0.pc:libusb \
                    port:libusb-compat

worksrcdir          ${distname}/commandline
use_configure       no
build.target        micronucleus

patch {
    reinplace "s|/usr/local/opt/libusb-compat|${prefix}|g" ${worksrcpath}/Makefile
    reinplace "s|/usr/local/opt/libusb|${prefix}|g" ${worksrcpath}/Makefile
}

destroot {
    xinstall -m 755 ${worksrcpath}/micronucleus ${destroot}${prefix}/bin
}
