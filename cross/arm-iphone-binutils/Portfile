# $Id$

PortSystem 1.0
name			arm-iphone-binutils
version			r93
categories		iphone
maintainers		landonf@macports.org openmaintainer@macports.org
description		iPhone Binutils for arm-iphone cross development
long_description	${description}

homepage		http://developer.berlios.de/projects/iphone-binutils/
platforms		darwin

master_sites		http://landonf.bikemonkey.org/static/iphone/
distname		iphone-binutils-${version}
checksums		md5 e7c782c48307e96a347787cf1d13d0b4

depends_build		port:Libstreams

patchfiles		patch-Makefile.in

set iphone_prefix	${prefix}/arm-iphone

configure.args		--prefix=${iphone_prefix} --with-heavenly=${iphone_prefix}/heavenly

build.args		DESTDIR=${destroot}

pre-configure {
	if {![file exists ${iphone_prefix}/heavenly/usr/lib/dyld]} {
		return -code error "Heavenly (the iPhone installation disk image) must be manually copied to ${iphone_prefix}/heavenly before building this port: sudo mkdir -p ${iphone_prefix}/heavenly && sudo cp -Rn <HeavenlyDirectory> ${iphone_prefix}"
	}
}

pre-build {
	file mkdir ${destroot}/${iphone_prefix}/bin
	file copy ${prefix}/include/streams ${worksrcpath}/cctools/include/streams
}

destroot {}
