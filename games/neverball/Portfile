# $Id: Portfile,v 1.7 2004/08/17 18:43:05 mww Exp $

PortSystem 1.0

name		neverball
version		1.3.7
categories	games
platforms	darwin
maintainers	mww@opendarwin.org
description	Tilt the floor to roll a ball through an obstacle course.
long_description	Tilt the floor to roll a ball through an obstacle \
			course before time runs out. Neverball is part puzzle \
			game, part action game, and entirely a test of skill.

homepage	http://icculus.org/neverball/
master_sites	${homepage}
checksums	md5 b7c0fe079ab88b63b77dd3e3f06819e8
patchfiles	patch-Makefile.diff

depends_lib	bin:sdl-config:libsdl \
		lib:libSDL_image:libsdl_image \
		lib:libSDL_mixer:libsdl_mixer \
		lib:libSDL_ttf:libsdl_ttf

configure	{
	reinplace "s|./data|${prefix}/share/${name}|g" \
		${worksrcpath}/share/config.h
}

build.env	CFLAGS=-I${prefix}/include \
		LDFLAGS=-L${prefix}/lib

destroot	{
	xinstall -d -m 755 ${destroot}${prefix}/share/
	file copy ${worksrcpath}/data ${destroot}${prefix}/share/${name}
	xinstall -s -m 755 ${worksrcpath}/neverball ${destroot}${prefix}/bin
}

variant darwin	{
	pre-destroot	{
		xinstall -d -m 755 ${destroot}/Applications/DarwinPorts/Neverball.app/Contents/MacOS
		system "ln -s ${prefix}/bin/neverball \
			${destroot}/Applications/DarwinPorts/Neverball.app/Contents/MacOS/Neverball"
	}
}
