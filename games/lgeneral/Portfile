# $Id: Portfile,v 1.1 2003/12/28 19:36:13 mww Exp $

PortSystem 1.0

name		lgeneral
version		1.1.1
categories	games
platforms	darwin
maintainers	mww@opendarwin.org
description	Turn-based strategy engine heavily inspired by Panzer General
long_description	LGeneral is a turn-based strategy engine heavily \
			inspired by Panzer General. You play single scenarios \
			or whole campaigns turn by turn against a human player \
			or the AI. Entrenchment, rugged defense, defensive \
			fire, surprise contacts, surrender, unit supply, \
			weather influence, reinforcements and other \
			implementations contribute to the tactical and \
			strategic depth of the game.

homepage	http://lgames.sourceforge.net/index.php?project=LGeneral
master_sites	sourceforge
distfiles	${distname}${extract.suffix} \
		${name}-data-1.1.3${extract.suffix} \
		lgc-pg-0.32${extract.suffix}
checksums	${distname}${extract.suffix} \
			md5 18b88069c91e7e7c75cc44a9aa90d0d9 \
		${name}-data-1.1.3${extract.suffix} \
			md5 786feb83f163834a22e3e85e1970145f \
		lgc-pg-0.32${extract.suffix} \
			md5 750d3e68bea1fde7935a357133026c9a

depends_lib	lib:libsdl:libsdl \
		lib:libsdl_mixer:libsdl_mixer

configure.env	CFLAGS=-I${prefix}/include \
		LDFLAGS=-L${prefix}/lib
configure.cmd	cd ${worksrcpath} \
			&& ./configure ${configure.pre_args} \
		&& cd ${workpath}/${name}-data-1.1.3 \
			&& ./configure ${configure.pre_args} \
		&& cd ${workpath}/lgc-pg-0.32 \
			&& ./configure ${configure.pre_args}

post-configure	{
	reinplace "s|,-export-dynamic||g" ${worksrcpath}/src/Makefile
	reinplace "s|-I${prefix}/include/SDL|-I${prefix}/include|g" \
		${workpath}/lgc-pg-0.32/src/Makefile
}

build.cmd	cd ${worksrcpath} && make all \
		&& cd ${workpath}/${name}-data-1.1.3 && make all \
		&& cd ${workpath}/lgc-pg-0.32 && make all

destroot.cmd	cd ${worksrcpath} \
			&& make install ${destroot.destdir} \
		&& cd ${workpath}/${name}-data-1.1.3 \
			&& make install ${destroot.destdir} \
		&& cd ${workpath}/lgc-pg-0.32 \
			&& make install ${destroot.destdir}

