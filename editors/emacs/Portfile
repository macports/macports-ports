# $Id$

PortSystem 1.0
name            emacs
version         22.1
categories      editors
maintainers     nomaintainer@macports.org
description     The GNU Emacs text editor (command line only)
long_description \
    GNU Emacs is a self-documenting, customizable, extensible real-time \
    display editor. Users new to Emacs will be able to use basic        \
    features fairly rapidly by studying the tutorial and using the      \
    self-documentation features. Emacs also has an extensive            \
    interactive manual browser. It is easily extensible since its       \
    editing commands are written in Lisp.

platforms       darwin freebsd
homepage        http://www.gnu.org/software/emacs/emacs.html
master_sites    gnu
checksums       md5 6949df37caec2d7a2e0eee3f1b422726
configure.args  --without-x \
                --without-carbon
#destroot.args   prefix=${destroot}/${prefix}

#patch.pre_args  -p1
#patchfiles      patch-src-xterm.c apple-patches ange-ftp.el.diff
patchfiles      patch-src-s-darwin.h

depends_lib     port:ncurses
build.target    bootstrap

post-destroot {
    cd ${destroot}${prefix}
#    delete info/dir share/info share/man
#    file rename info share/info
#    file rename man share/man
    xinstall -d share/emacs/${version}/leim
    if {[variant_isset carbon]} {
#        global version
        delete bin/emacs bin/emacs-${version}
    }
}

platform darwin 8 {
    configure.env-append    CC=/usr/bin/gcc-4.0 \
                            CPP=/usr/bin/cpp-4.0 \
                            CXX=/usr/bin/g++-4.0
}

platform darwin 7 {
    depends_build-append    port:autoconf
}

livecheck.check regex
livecheck.url   http://ftp.gnu.org/gnu/emacs/?M=D
livecheck.regex emacs-(\\d+\\.\\d+\\w*).tar.gz
