# $Id: Portfile,v 1.33 2004/12/19 21:20:58 jkh Exp $

PortSystem 1.0
name		emacs
version		21.3
categories	editors
maintainers	jkh@opendarwin.org
description	The GNU Emacs text editor
long_description	GNU Emacs is a self-documenting, customizable, extensible real-time display editor. \
			Users new to Emacs will be able to use basic features fairly rapidly \
			by studying the tutorial and using the self-documentation features. \
			Emacs also has an extensive interactive manual browser.  It is easily \
			extensible since its editing commands are written in Lisp.
platforms	darwin freebsd
master_sites	gnu
checksums	md5 a0bab457cbf5b4f8eb99d1d0a3ada420
configure.args	--without-x
destroot.args	prefix=${destroot}/${prefix}

post-destroot {
	cd ${destroot}${prefix}
	file delete info/dir
	file delete share/info
	file rename info share/info
	system "rm -rf share/man"
	file rename man share/man
	if {[variant_isset carbon]} {
		global destroot prefix version

		file delete ${destroot}${prefix}/bin/emacs
		file delete ${destroot}${prefix}/bin/emacs-$version
	}
}

variant darwin {
	patchfiles	apple-patches ange-ftp.el.diff
	patch.pre_args	-p1
}

variant devel {
	version 21.3.50
	fetch.type	cvs
	cvs.root	:ext:anoncvs@savannah.gnu.org:/cvsroot/emacs
	cvs.module	emacs
	cvs.env		CVS_RSH=ssh
	worksrcdir	emacs
	build.target	bootstrap
	patchfiles-delete	apple-patches ange-ftp.el.diff
}

variant x11 {
	configure.args --with-x --with-x-toolkit=lucid --with-xpm=no --without-carbon
}

# Overrides darwin
variant carbon requires devel {
	configure.args-append	--with-carbon --enable-carbon-app=${destroot}/Applications/DarwinPorts
}
