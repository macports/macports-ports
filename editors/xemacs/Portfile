# $Id $

PortSystem 1.0
name		xemacs
version		21.4.16
categories	editors
maintainers	jkh@opendarwin.org
description	A highly customizable open source text editor.
long_description \
		 XEmacs is a highly customizable open source text editor and \
		 application development system. It is protected under the \
		 GNU Public License and related to other versions of Emacs, \
		 in  particular GNU Emacs.
platforms	darwin
homepage	http://www.xemacs.org
master_sites	ftp://ftp.us.xemacs.org/pub/xemacs/xemacs-21.4/:source \
		http://ftp.us.xemacs.org/ftp/pub/xemacs/xemacs-21.4/:source \
		ftp://ibiblio.org/pub/packages/editors/xemacs/xemacs-21.4/:source \
		http://ibiblio.org/pub/packages/editors/xemacs/xemacs-21.4/:source \
		http://mirrors.mix5.com/xemacs/xemacs-21.4/:source \
		http://www.binarycode.org/xemacs/xemacs-21.4/:source \
		http://www.online-mirror.org/xemacs/xemacs-21.4/:source \
                ftp://ftp.us.xemacs.org/pub/xemacs/packages/:sumo \
                http://ftp.us.xemacs.org/ftp/pub/xemacs/packages/:sumo \
                ftp://ibiblio.org/pub/packages/editors/xemacs/packages/:sumo \
                http://ibiblio.org/pub/packages/editors/xemacs/packages/:sumo \
                http://mirrors.mix5.com/xemacs/packages/:sumo \
                http://www.binarycode.org/xemacs/packages/:sumo \
                http://www.online-mirror.org/xemacs/packages/:sumo

use_bzip2	yes

distfiles       ${name}-${version}-src${extract.suffix}:source

checksums	${name}-${version}-src${extract.suffix} \
	 	 md5 8e4d7660d60ca57cc105595742b8ce31

configure.args	--with-dialogs=athena --with-widgets=athena --with-athena=3d \
		--without-postgresql --without-ldap --with-sound=none --pdump \
		--site-prefixes=${prefix} --with-tty

depends_lib	lib:libpng.3:libpng lib:libXaw3d.7:Xaw3d

destroot.args   prefix=${destroot}/${prefix}

set xemacs_lib  ${destroot}${prefix}/lib/xemacs-${version}
set pkg_contents        "etc info lisp man pkginfo"

post-destroot {
        ui_info "Installing packages into destroot"

	destroot.keepdirs ${destroot}${prefix}/lib/xemacs
	xinstall -d ${xemacs_lib}/xemacs-packages

	system "tar -cpf - -C ${worksrcpath}/.. ${pkg_contents} | \
	        tar -xpf - -C ${xemacs_lib}/xemacs-packages"
}

variant sumo {
	set sumo_dist		${name}-sumo${extract.suffix}

	distfiles-append	${sumo_dist}:sumo
	checksums-append	${sumo_dist} \
				 md5 48f4bf340c55fb94a54de65f109fd443

	post-destroot {
		ui_info "Installing sumo distribution into destroot"
		system "cp -Rp ${worksrcpath}/../xemacs-packages ${xemacs_lib}"
	}
}
