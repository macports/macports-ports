# $Id: Portfile,v 1.20 2006/06/21 21:27:45 mww Exp $

PortSystem 1.0
name		SuiteSparse
version		2.1.1
revision	0
categories	math science
maintainers     andre@splunk.com
platforms	darwin
description	Sparse matrix routines
long_description \
		SuiteSparse is a single archive that contains all packages \
		authored by Tim Davis.

homepage	http://www.cise.ufl.edu/research/sparse/SuiteSparse/
master_sites	http://www.cise.ufl.edu/research/sparse/SuiteSparse/
distname	SuiteSparse

depends_build	port:metis

checksums	md5 bc01ef2f26e6ad3eed83b4ad62e46a68

use_configure	no

pre-configure	{
		reinplace "s,#define SIZE_T_MAX ((size_t) (-1)),," ${worksrcpath}/AMD/Include/amd_internal.h
		reinplace "s,#define SIZE_T_MAX ((size_t) (-1)),," ${worksrcpath}/CAMD/Include/camd_internal.h
		reinplace "s,METIS_PATH = ../../metis-4.0,METIS_PATH = ${prefix}/include/metis," ${worksrcpath}/UFconfig/UFconfig.mk
		reinplace "s,METIS = ../../metis-4.0/libmetis.a,METIS = ${prefix}/lib/libmetis.a," ${worksrcpath}/UFconfig/UFconfig.mk
		reinplace "s,BLAS = -lgoto -lgfortran,BLAS = -L${prefix}/lib -lblas," ${worksrcpath}/UFconfig/UFconfig.mk
		reinplace "s,-I\$(METIS_PATH)/Lib,-I\$(METIS_PATH)," ${worksrcpath}/CHOLMOD/Lib/Makefile
		reinplace "s,f77,gfortran-dp-4.2," ${worksrcpath}/CXSparse/Demo/Makefile
		reinplace "s,( cd metis-4.0 ; \$(MAKE) ),# ( cd metis-4.0 ; \$(MAKE) )," ${worksrcpath}/Makefile
}

build.target	default

destroot	{
	xinstall -m 644 ${worksrcpath}/AMD/Lib/libamd.a ${destroot}${prefix}/lib
	xinstall -m 644 ${worksrcpath}/BTF/Lib/libbtf.a ${destroot}${prefix}/lib
	xinstall -m 644 ${worksrcpath}/CAMD/Lib/libcamd.a ${destroot}${prefix}/lib
	xinstall -m 644 ${worksrcpath}/CCOLAMD/libccolamd.a ${destroot}${prefix}/lib
	xinstall -m 644 ${worksrcpath}/CHOLMOD/Lib/libcholmod.a ${destroot}${prefix}/lib
	xinstall -m 644 ${worksrcpath}/COLAMD/libcolamd.a ${destroot}${prefix}/lib
	xinstall -m 644 ${worksrcpath}/CXSparse/Source/libcxsparse.a ${destroot}${prefix}/lib
	xinstall -m 644 ${worksrcpath}/KLU/Lib/libklu.a ${destroot}${prefix}/lib
	xinstall -m 644 ${worksrcpath}/KLU/User/libklu_cholmod.a ${destroot}${prefix}/lib
	xinstall -m 644 ${worksrcpath}/LDL/libldl.a ${destroot}${prefix}/lib
	xinstall -m 644 ${worksrcpath}/UFconfig/xerbla/libcerbla.a ${destroot}${prefix}/lib
	xinstall -m 644 ${worksrcpath}/UMFPACK/Lib/libumfpack.a ${destroot}${prefix}/lib

	file mkdir ${destroot}${prefix}/include/ufsparse

	xinstall -m 644 ${worksrcpath}/AMD/Include/amd.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/BTF/Include/btf.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/CAMD/Include/camd.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/CCOLAMD/ccolamd.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/CHOLMOD/Include/cholmod.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/CHOLMOD/Include/cholmod_check.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/CHOLMOD/Include/cholmod_cholesky.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/CHOLMOD/Include/cholmod_config.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/CHOLMOD/Include/cholmod_core.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/CHOLMOD/Include/cholmod_matrixops.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/CHOLMOD/Include/cholmod_modify.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/CHOLMOD/Include/cholmod_partition.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/CHOLMOD/Include/cholmod_supernodal.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/COLAMD/colamd.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/CXSparse/Source/cs.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/KLU/Include/klu.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/LDL/ldl.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UFconfig/UFconfig.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_col_to_triplet.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_defaults.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_free_numeric.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_free_symbolic.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_get_determinant.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_get_lunz.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_get_numeric.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_get_symbolic.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_global.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_load_numeric.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_load_symbolic.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_numeric.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_qsymbolic.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_report_control.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_report_info.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_report_matrix.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_report_numeric.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_report_perm.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_report_status.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_report_symbolic.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_report_triplet.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_report_vector.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_save_numeric.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_save_symbolic.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_scale.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_solve.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_symbolic.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_tictoc.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_timer.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_transpose.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_triplet_to_col.h ${destroot}${prefix}/include/ufsparse
	xinstall -m 644 ${worksrcpath}/UMFPACK/Include/umfpack_wsolve.h ${destroot}${prefix}/include/ufsparse
}
