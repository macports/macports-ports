# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0

# '-ml' stands for Machine Learning, which is appended in order to avoid conflict with devel/opal.
name                opal-ml
version             20111221
categories          math
platforms           darwin
maintainers         hum openmaintainer
license             GPL-2

homepage            http://www.tkl.iis.u-tokyo.ac.jp/~ynaga/opal/
description         C++ header library of online learning with kernel slicing
long_description    Opal is a ${description}.

master_sites        ${homepage}
checksums           rmd160  3991b56081ece5dcb97da6bf3a69d343f0805bf6 \
                    sha256  96185b857b668387e3fc884d99b9ecb9f8dd51534954ab961282d0ceda45c6ec

distname            opal-${version}
worksrcdir          opal
use_bzip2           yes

use_configure       no

variant universal   {}

build.args          CC="${configure.cxx}" \
                    CFLAGS="${configure.cxxflags} [get_canonical_archflags cxx]"

destroot {
    xinstall -m 755 -W ${worksrcpath} \
        opal rand_shuf opal-prune opal-pmt opal-prune-pmt opalk \
        ${destroot}${prefix}/bin
    file mkdir ${destroot}${prefix}/share/doc/${name}
    xinstall -m 644 -W ${worksrcpath} \
        COPYING GPL README \
        ${destroot}${prefix}/share/doc/${name}
}

variant multiclass description {Add a multi-class classifier} {
    patchfiles-append  patch-multiclass.diff
    post-destroot {
        xinstall -m 755 -W ${worksrcpath} \
            opal-multiclass \
            ${destroot}${prefix}/bin
    }
}
    
default_variants    +multiclass

livecheck.type      regex
livecheck.url       ${homepage}
livecheck.regex     opal-(\\d+)\\.tar
