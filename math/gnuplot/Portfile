# $Id: Portfile,v 1.12 2004/07/04 02:31:31 jkh Exp $
PortSystem 1.0

name			gnuplot
version			3.8j.0
categories		math science
maintainers		rshaw@opendarwin.org
description		A command-driven interactive function plotting program
long_description	Gnuplot is a command-driven interactive function \
					plotting program. Plots any number of functions, \
					built up of C operators, C library functions, and \
					some things C doesn't have like **, sgn(), etc. \
					Also support for plotting data files, to compare \
					actual data to theoretical curves.
platforms		darwin
homepage		http://gnuplot.sourceforge.net/
master_sites	sourceforge
distfiles		${distname}.tar.gz \
				${distname}-docs.tar.gz
checksums		${distname}.tar.gz md5 929e210e2d6585d34b029fa59d39915f \
				${distname}-docs.tar.gz md5 12ac252b4d69a4d80aa994ae398867f5

depends_lib		lib:libgd.2:gd2 \
				lib:libpng:libpng \
				lib:libreadline.4:readline \
				lib:libX11.6:XFree86 \
				lib:libz.1:zlib

patchfiles		patch-term-tkcanvas.trm

platform darwin {
	depends_run			path:/Applications/DarwinPorts/AquaTerm.app:aquaterm

	patchfiles-append	patch-darwin.diff
}

configure.env	LDFLAGS="-L${prefix}/lib" \
				CPPFLAGS="-I${prefix}/include -no-cpp-precomp"
configure.args	--with-readline=gnu \
				--with-gd \
				--with-png \
				--with-x \
				--infodir='\${prefix}/share/info' \
				--mandir='\${prefix}/share/man'

variant no_x11 {
	depends_lib-delete	lib:libX11.6:XFree86

	configure.args-delete	--with-x
	configure.args-append	--without-x
}

destroot.destdir	prefix=${destroot}${prefix}
post-destroot {
	xinstall -d -m 0755 ${destroot}${prefix}/share/doc
	system "cp -R ${workpath}/${name}-${version}-docs \
		${destroot}${prefix}/share/doc/${name}"
	file delete ${destroot}${prefix}/share/info/dir
}

