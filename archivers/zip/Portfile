# $Id$

PortSystem			1.0

name				zip
version				2.32
categories			archivers
platforms			darwin freebsd
description			compression utility
maintainers			nomaintainer

long_description	Zip is different from gzip in that it allows packing \
					multiple files into a single archive (without the \
					assistance of tar). It is compatible with pkzip, \
					pkunzip, and other Windows zip utilities.  This \
					utility is necessary to install several packages in a \
					pure Darwin installation, as Darwin does not come \
                    with zip/unzip.

homepage			http://www.info-zip.org/pub/infozip/Zip.html
master_sites		ftp://ftp.info-zip.org/pub/infozip/src/ \
					http://www.mirrorservice.org/sites/ftp.info-zip.org/pub/infozip/src/ \
			macports
distname			${name}[strsed ${version} {/\.//}]

checksums			md5 8a4da4460386e324debe97f3b7fe4d96 \
					sha1 5bc562bf95d9aee0cb6625e6038898e1f191a4aa \
					rmd160 6b9326c8a60bc6bf08825e416140fd0ca8a6a7f1

extract.suffix		.tgz

worksrcdir			${name}-${version}

set args			"-f unix/Makefile"

configure.cmd		${build.cmd}
configure.dir		${worksrcpath}
configure.pre_args	flags \
					${args}

build.target		generic
build.args			${args}

destroot.args		${args} \
					BINDIR=${destroot}${prefix}/bin \
					MANDIR=${destroot}${prefix}/share/man/man1

post-destroot {
	set docdir ${prefix}/share/doc/${name}-${version}
	xinstall -d ${destroot}${docdir}
	xinstall -m 0644 -W ${worksrcpath} BUGS CHANGES LICENSE README TODO WHATSNEW \
		${destroot}${docdir}
}

variant universal {
	configure.args	"LOCAL_ZIP=\"${configure.universal_cflags}\""

	post-patch {
		reinplace -E "s|(LFLAGS1=\")|\\1${configure.universal_ldflags}|" \
			${worksrcpath}/unix/configure
	}
}

livecheck.check	regex
livecheck.url	${homepage}
livecheck.regex	"Zip (\\d+(?:\\.\\d+)*)"

