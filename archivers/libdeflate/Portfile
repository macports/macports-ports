# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           cmake           1.1
PortGroup           github          1.0
PortGroup           legacysupport   1.1

github.setup        ebiggers libdeflate 1.25 v
github.tarball_from releases
revision            0

checksums           rmd160  58584517791330b7eed1f8ae8d3475b1dec37794 \
                    sha256  fed5cd22f00f30cc4c2e5329f94e2b8a901df9fa45ee255cb70e2b0b42344477 \
                    size    186474

description         Heavily optimized library for DEFLATE/zlib/gzip \
                    compression and decompression

long_description    libdeflate is a library for fast, whole-buffer \
                    DEFLATE-based compression and decompression. It has \
                    support for the DEFLATE (raw), zlib (DEFLATE w/ zlib \
                    wrapper), and gzip (DEFLATE w/ gzip wrapper) formats. \
                    It is heavily optimized, and significantly faster than \
                    the zlib library, both for compression and decompression, \
                    and especially on x86 processors. In addition, libdeflate \
                    provides optional high compression modes that provide \
                    a better compression ratio than the zlib's \"level 9\".

categories          archivers devel
license             MIT
maintainers         {linux.com:nickblack @dankamongmen} \
                    {gmail.com:herby.gillot @herbygillot} \
                    openmaintainer

# https://github.com/ebiggers/libdeflate/commit/a83fb24e1cb0ec6b6fd53446c941013edf055192
compiler.blacklist-append   *gcc-4.* {clang < 800} {macports-clang-3.[0-8]}

configure.args-append \
                    -DLIBDEFLATE_BUILD_TESTS=1

# TODO: verify powerpc defs in common_defs.h
# https://github.com/ebiggers/libdeflate/issues/362

test.run            yes
test.cmd            ctest --test-dir ${workpath}/build
