# $Id$

PortSystem		1.0

name            m4
version         1.4.10
revision        1
categories      devel
maintainers     blair openmaintainer
platforms       darwin
description     GNU macro processor

long_description \
    GNU `m4' is an implementation of the traditional Unix macro         \
    processor.  It is mostly SVR4 compatible, although it has some      \
    extensions (for example, handling more than 9 positional parameters \
    to macros). `m4' also has built-in functions for including files,   \
    running shell commands, doing arithmetic, etc. Autoconf needs GNU   \
    `m4' for generating `configure' scripts, but not for running them.

homepage        http://www.gnu.org/software/m4/
master_sites    gnu
use_bzip2       yes

checksums       md5 0a35bab2f5d605e08083d7e3cbd4b8b0 \
                sha1 df46910c7e711aef1a654b077ef48d86a6a0cc6b \
                rmd160 db9e91a01104a7543e69527da6d4f059a56ffefb

patchfiles      patch-src_output.c

configure.args  --program-prefix=g

post-destroot {
    move ${destroot}${prefix}/share/info/m4.info ${destroot}${prefix}/share/info/gm4.info
    delete ${destroot}${prefix}/lib/charset.alias

	set docdir ${prefix}/share/doc/${name}-${version}
	xinstall -d ${destroot}${docdir}
	xinstall -m 0644 -W ${worksrcpath} AUTHORS COPYING ChangeLog NEWS README THANKS \
		TODO ${destroot}${docdir}
}

test.run        yes
test.target     check

variant with_default_names {
    post-destroot {
        foreach d {bin share/info share/man/man1} {
            foreach a [glob -directory ${destroot}${prefix}/$d -tail g*] {
                regexp g(.+) $a dummy b
                file link -hard ${destroot}${prefix}/$d/$b ${destroot}${prefix}/$d/g$b
            }
        }
    }
}

livecheck.check regex
livecheck.url   http://ftp.gnu.org/gnu/${name}/?C=M&O=D
livecheck.regex ${name}-(\\d+(?:\\.\\d+)*)\\.tar\\.bz2

