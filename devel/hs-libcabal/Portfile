# $Id$

PortSystem 1.0

name		hs-libcabal
set canonicalname	Cabal
version		1.6.0.1
categories	devel haskell
maintainers	gwright
platforms	darwin

description	Library for Haskell's Cabal build system.
long_description	\
		Cabal is a system for building and packaging Haskell	\
		libraries and programs It defines a common interface	\
		for package authors and distributors to easily build	\
		their applications in a portable way. Cabal is part of	\
		a larger infrastructure for distributing, organizing,	\
		and cataloging Haskell libraries and programs.		\
		    	       	       		     			\
		This port provides only the library.  The hs-cabal	\
		port provides the "cabal" installer program.

homepage	http://www.haskell.org/cabal/
master_sites	${homepage}/release/cabal-${version}
distname	${canonicalname}-${version}

checksums       md5     23080358a9a05d3126255c7f6756be41		\
                sha1    2a9564d0e8e32f85424f84f33856e2df216b1617	\
                rmd160  329f28ce021aecb8fec3e71555d33a2da504a4bf

depends_build	port:ghc

configure       { system "cd ${worksrcpath} && runhaskell Setup configure --ghc --prefix=${prefix} --with-compiler=${prefix}/bin/ghc --enable-library-profiling"
                }

build		{ system "cd ${worksrcpath} && runhaskell Setup build"
		}

destroot	{ system "cd ${worksrcpath} && runhaskell Setup copy --copy-prefix=${destroot}${prefix}"
                  system "cd ${worksrcpath} && runhaskell Setup register   --gen-script"
                  system "cd ${worksrcpath} && runhaskell Setup unregister --gen-script"

                  file mkdir ${destroot}${prefix}/libexec/${name}
                  file copy ${worksrcpath}/register.sh \
                            ${destroot}${prefix}/libexec/${name}
                  file copy ${worksrcpath}/unregister.sh \
                            ${destroot}${prefix}/libexec/${name}
                 }

post-activate	{ system "${prefix}/libexec/${name}/register.sh" }

#pre-deactivate	{ system "${prefix}/libexec/${name}/unregister.sh" }

