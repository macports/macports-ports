# $Id$

PortSystem 1.0

name            poedit
version         1.3.7
categories      devel aqua
platforms       darwin 
maintainers     raimue@macports.org \
                openmaintainer@macports.org

description     poEdit is a cross-platform gettext catalogs (.po files) editor.
long_description \
    poEdit is a cross-platform gettext catalogs (.po files) editor. It aims to \
    provide more convenient approach to editing catalogs than editing the file by \
    hand. This port installs poEdit.app.
homepage        http://poedit.sourceforge.net/

master_sites    sourceforge
checksums \
  md5 36110e8c16109ec1fcefd583ebbb7a34 \
  sha1 4086a1594e0af71fb664ac773d5e7700799ee8c9 \
  rmd160 4b184ae5521eb86b79ae7bbe0d15238066bc1540

depends_build   port:pkgconfig
depends_lib     port:wxWidgets
depends_run     port:gettext

configure.args  --disable-transmem --disable-spellchecking

build.dir           ${build.dir}/src
build.target        bundle
build.env-append    GETTEXT_BINARIES=${prefix}/bin

variant transmem description {Enables translation memory for often used phrases} {
    depends_lib-append      port:db4
    configure.args-delete   --disable-transmem
    configure.args-append   --enable-transmem
}

variant spellcheck description {Enables spellchecking} {
    depends_lib-append      port:gtkspell2
    configure.args-delete   --disable-spellchecking
    configure.args-append   --enable-spellchecking
}

destroot {
    # the gettext binaries are copied into poEdit.app during build, 
    # but we rather delete and symlink them to get updates to gettext automatically {
    foreach extra { msgfmt msgmerge msgunfmt xgettext } {
        file delete ${worksrcpath}/src/poEdit.app/Contents/MacOS/${extra}
        ln -s ${prefix}/bin/${extra} ${worksrcpath}/src/poEdit.app/Contents/MacOS/${extra}
    }
    file delete ${worksrcpath}/src/poEdit.app/Contents/MacOS/gnu_gettext.COPYING
    # }

    set appPath "/Applications/MacPorts/"
    xinstall -d -m 755 ${destroot}${appPath}
    file copy ${worksrcpath}/src/poEdit.app ${destroot}${appPath}poEdit.app
}

