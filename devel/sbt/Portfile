# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0

name                sbt
version             0.7.4
categories          devel java
maintainers         jon.buffington.name:me
platforms           darwin

description         Simple build tool (sbt) is designed to simplify building Scala projects.

long_description    Simple build tool (sbt) is provides unintrusive and easy to set up for simple \
                    Scala projects. All configuration, customization, and extension are done in Scala. \
                    Sbt supports continuous compilation and testing with triggered execution in \
                    mixed Scala/Java projects.

set project_name    simple-build-tool
homepage            http://code.google.com/p/${project_name}/
master_sites        googlecode:${project_name}
distname            ${name}-launch-${version}

checksums           md5     8903fb141037056a497925f3efdb9edf \
                    sha1    2b7cfadf05b3b26285bb2038145479741268d334 \
                    rmd160  19c39da679d05b600fde06acf9acf657a7701f93

depends_build       bin:java:kaffe

# Name the wrapper shell script.
set wrapper         sbt.sh

extract.suffix      .jar
extract.mkdir       yes
pre-extract {
    file copy ${filespath}/${wrapper} ${worksrcpath}
}

set jarname ${distname}${extract.suffix}

post-patch {
    reinplace "s|__SBT_LAUNCHER_PATH__|${prefix}/share/${name}/${jarname}|g" ${worksrcpath}/${wrapper}
}

supported_archs     noarch
use_configure       no
build               {}

destroot {
    set sbtdir ${destroot}${prefix}/share/${name}

    xinstall -m 755 -d ${sbtdir}
    xinstall -m 644 ${distpath}/${jarname} ${sbtdir}/
    xinstall -m 755 ${worksrcpath}/${wrapper} ${sbtdir}/${name}

    ln -s ${prefix}/share/${name}/${name} ${destroot}${prefix}/bin
}
