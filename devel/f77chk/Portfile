# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem      1.0

name            f77chk
version         1.2.2f
revision        1
categories      devel
platforms       any
license         GPL-2+
maintainers     {@kamischi web.de:karl-michael.schindler} openmaintainer
homepage        http://spdg1.sci.shizuoka.ac.jp/contrib/${name}/index.html.en
master_sites    http://spdg1.sci.shizuoka.ac.jp/downloads/contrib/${name}
extract.suffix  .tgz
checksums       rmd160  7bff72c34a3fbc102f9ae949c7a55bf2b2047afe \
                sha256  07696ef9555c5d41b4cbe4e902b6012104b523b68d340133b7d1f76f3402bbbe \
                size    28984
extract.mkdir   yes
supported_archs noarch

description     Fortran77 source code checker

long_description \
F77chk is written in Perl and checks consistencies of arguments at every \
calls to externals in source files.   Including definition files, in which \
definitions of externals in libraries are listed, entire consistencies of \
arguments can be checked to reduce run time errors.   A definition file \
for a library can be generated by f77chk automatically if the source code \
is available, or by hand referring user's manuals, for example.

# macOS 10.15 and higher has no built-in perl
if {${os.major} >= 19} {
    post-patch {
        reinplace "s|/usr/local|${prefix}|g" f77chk.pl
    }
}

use_configure   no
build           {}

destroot {
    xinstall -m 0755 -W ${worksrcpath} f77chk.pl \
        ${destroot}${prefix}/bin
    xinstall -m 0644 -W ${worksrcpath} library.def \
        ${destroot}${prefix}/etc
    xinstall -d ${destroot}${prefix}/share/doc/f77chk
    xinstall -m 0644 -W ${worksrcpath} COPYING README README.jp \
        ${destroot}${prefix}/share/doc/f77chk
}

livecheck.regex "f77chk-(\\d+(?:\\.\\d+)*f)"
