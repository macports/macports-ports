# $Id$

PortSystem 1.0

name            allegro
version         4.2.2
description     A game programming library for C/C++ developers.
long_description \
                Allegro is a game programming library for \
                C/C++ developers distributed freely, supporting \
                many platforms.
maintainers     raimue \
                openmaintainer
categories      devel games
platforms       darwin
use_parallel_build  yes
homepage        http://www.talula.demon.co.uk/allegro/
master_sites    sourceforge:alleg
checksums       md5 87ffb1def034e0ec29a9ad4a595cda7e
depends_lib     lib:libX11:XFree86
patchfiles      patch-makefile.osx

configure    {
    system "cd ${worksrcpath} && sh fix.sh macosx"
}

# check for universal build
pre-build {
    if {! [variant_isset universal]} {
        build.args  PREFIX=${prefix}
    } else {
        build.args  PREFIX=${prefix} UB=1
    }
}

build.target

destroot.target     install install-man
destroot.args       PREFIX=${prefix}

# some additional tools were build, let's install them
post-destroot {
    foreach tool {colormap dat dat2c dat2s exedat grabber pack pat2dat rgbmap textconv} {
        xinstall -m 0755 -W ${worksrcpath}/tools/ ${tool} ${destroot}${prefix}/bin/
    }
}

livecheck.check regex
livecheck.regex " (\\S+) released!"
