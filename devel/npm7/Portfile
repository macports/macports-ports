# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           npm 1.0

npm.setup           7.20.1
revision            0
maintainers         {ciserlohn @ci42} openmaintainer

# Please keep the sha1 - users can use it to validate sha values
# published on npmjs.org for the package
checksums           rmd160  600ef152c4492793dc7a33cafd7af77d683403f8 \
                    sha1    31215a343c05611988190cedefe35a754db3c770 \
                    sha256  ed1857384642ca868eb1bea424e40086cff4a6c1f142b7d3a978fdc1b1e9902a \
                    size    3147829

patchfiles          patch-lib-update.js.diff

post-patch {
    foreach f [concat ${worksrcpath}/bin/npm-cli.js \
                   ${worksrcpath}/bin/npx-cli.js \
                   ${worksrcpath}/node_modules/@npmcli/arborist/bin/index.js \
                   ${worksrcpath}/node_modules/ajv/scripts/info \
                   ${worksrcpath}/node_modules/mkdirp/bin/cmd.js \
                   ${worksrcpath}/node_modules/node-gyp/bin/node-gyp.js \
                   ${worksrcpath}/node_modules/nopt/bin/nopt.js \
                   ${worksrcpath}/node_modules/npm-packlist/bin/index.js \
                   ${worksrcpath}/node_modules/opener/bin/opener-bin.js \
                   ${worksrcpath}/node_modules/pacote/lib/bin.js \
                   ${worksrcpath}/node_modules/qrcode-terminal/bin/qrcode-terminal.js \
                   ${worksrcpath}/node_modules/rimraf/bin.js \
                   ${worksrcpath}/node_modules/semver/bin/semver.js \
                   ${worksrcpath}/node_modules/sshpk/bin/sshpk-conv \
                   ${worksrcpath}/node_modules/sshpk/bin/sshpk-sign \
                   ${worksrcpath}/node_modules/sshpk/bin/sshpk-verify \
                   ${worksrcpath}/node_modules/uuid/bin/uuid \
                   ${worksrcpath}/node_modules/which/bin/node-which] {
        reinplace "s|/usr/bin/env node|${prefix}/bin/node|" ${f}
    }
}

