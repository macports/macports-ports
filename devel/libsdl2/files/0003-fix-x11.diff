--- include/SDL_config_macosx.h	2023-07-02 01:04:05.000000000 +0800
+++ include/SDL_config_macosx.h	2023-07-23 05:28:30.000000000 +0800
@@ -182,14 +182,16 @@
 #define SDL_TIMER_UNIX  1
 
 /* Enable various video drivers */
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= 1060 && !defined(__ppc__)
 #define SDL_VIDEO_DRIVER_COCOA  1
+#endif
 #define SDL_VIDEO_DRIVER_DUMMY  1
-#undef SDL_VIDEO_DRIVER_X11
-#define SDL_VIDEO_DRIVER_X11_DYNAMIC "/opt/X11/lib/libX11.6.dylib"
-#define SDL_VIDEO_DRIVER_X11_DYNAMIC_XEXT "/opt/X11/lib/libXext.6.dylib"
-#define SDL_VIDEO_DRIVER_X11_DYNAMIC_XINPUT2 "/opt/X11/lib/libXi.6.dylib"
-#define SDL_VIDEO_DRIVER_X11_DYNAMIC_XRANDR "/opt/X11/lib/libXrandr.2.dylib"
-#define SDL_VIDEO_DRIVER_X11_DYNAMIC_XSS "/opt/X11/lib/libXss.1.dylib"
+#define SDL_VIDEO_DRIVER_X11    1
+#define SDL_VIDEO_DRIVER_X11_DYNAMIC "@PREFIX@/lib/libX11.6.dylib"
+#define SDL_VIDEO_DRIVER_X11_DYNAMIC_XEXT "@PREFIX@/lib/libXext.6.dylib"
+#define SDL_VIDEO_DRIVER_X11_DYNAMIC_XINPUT2 "@PREFIX@/lib/libXi.6.dylib"
+#define SDL_VIDEO_DRIVER_X11_DYNAMIC_XRANDR "@PREFIX@/lib/libXrandr.2.dylib"
+#define SDL_VIDEO_DRIVER_X11_DYNAMIC_XSS "@PREFIX@/lib/libXss.1.dylib"
 #define SDL_VIDEO_DRIVER_X11_XDBE 1
 #define SDL_VIDEO_DRIVER_X11_XRANDR 1
 #define SDL_VIDEO_DRIVER_X11_XSCRNSAVER 1

--- src/video/x11/SDL_x11opengl.c	2023-07-02 01:04:05.000000000 +0800
+++ src/video/x11/SDL_x11opengl.c	2023-07-23 07:49:24.000000000 +0800
@@ -40,7 +40,8 @@
  */
 #define DEFAULT_OPENGL  "libGL.so"
 #elif defined(__MACOSX__)
-#define DEFAULT_OPENGL  "/opt/X11/lib/libGL.1.dylib"
+#include <AvailabilityMacros.h>
+#define DEFAULT_OPENGL  "/usr/X11/lib/libGL.1.dylib"
 #elif defined(__QNXNTO__)
 #define DEFAULT_OPENGL  "libGL.so.3"
 #else
@@ -468,7 +469,9 @@
     }
 
     if (context) {
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= 1060 && !defined(__ppc__) /* FIXME: Calling glXMakeCurrent with "None" context causes a dead lock */
         _this->gl_data->glXMakeCurrent(display, None, NULL);
+#endif
         _this->gl_data->glXDestroyContext(display, context);
         if (prev_ctx && prev_drawable) {
             _this->gl_data->glXMakeCurrent(display, prev_drawable, prev_ctx);

