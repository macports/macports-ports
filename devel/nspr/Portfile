# $Id$

PortSystem	1.0

name		nspr
version		4.7.3
categories	devel
maintainers	reiffert openmaintainer
platforms	darwin
description	A platform-neutral API for system level and libc like functions.

long_description ${description}

homepage	http://www.mozilla.org/projects/nspr
master_sites	http://ftp.mozilla.org/pub/mozilla.org/nspr/releases/v${version}/src/ \
		ftp://ftp.mozilla.org/pub/mozilla.org/nspr/releases/v${version}/src/
checksums	md5     3496d6656f3e02dddc7e29f1b122b744 \
		sha1    351c34c8f26d11a441bc3130655cd9144e724899 \
		rmd160  532417c8c4d04a32d6cfc09ea8f2279d5ee69e72

worksrcdir	${worksrcdir}/mozilla/nsprpub

post-patch {
	reinplace "s|@executable_path|${prefix}/lib|g" \
		${worksrcpath}/configure.in \
		${worksrcpath}/configure
}

universal_variant no

configure.args	--disable-debug

post-destroot {
	file mkdir ${destroot}${prefix}/lib/pkgconfig
	copy ${filespath}/nspr.pc ${destroot}${prefix}/lib/pkgconfig
	reinplace "s|@@prefix@@|${prefix}|" ${destroot}${prefix}/lib/pkgconfig/nspr.pc
	set mylibs [exec ${destroot}${prefix}/bin/nspr-config --libs]
	set mycflags [exec ${destroot}${prefix}/bin/nspr-config --cflags]
	set myversion [exec ${destroot}${prefix}/bin/nspr-config --version]
	reinplace "s|@@FULL_NSPR_LIBS@@|${mylibs}|" ${destroot}${prefix}/lib/pkgconfig/nspr.pc
	reinplace "s|@@FULL_NSPR_CFLAGS@@|${mycflags}|" ${destroot}${prefix}/lib/pkgconfig/nspr.pc
	reinplace "s|@@NSPR_VERSION@@|${myversion}|" ${destroot}${prefix}/lib/pkgconfig/nspr.pc
}
