http://sources.gentoo.org/viewcvs.py/gentoo-x86/dev-util/cmake/files/cmake-2.8.0-darwin-no-app-with-qt.patch

Description: Don't build the GUI's app-bundle.
Author:	     Heiko Przybyl <zuxez@cs.tu-berlin.de>
--- CMakeLists.txt.orig	2010-02-10 19:38:03 +0100
+++ CMakeLists.txt	2010-02-10 19:38:49 +0100
@@ -381,7 +381,7 @@ IF(BUILD_CursesDialog)
 ENDIF(BUILD_CursesDialog)
 
 IF(BUILD_QtDialog)
-  IF(APPLE)
+  IF(FALSE)
     SET(CMAKE_BUNDLE_NAME
       "CMake ${CMake_VERSION_MAJOR}.${CMake_VERSION_MINOR}-${CMake_VERSION_PATCH}")
     SET(CMAKE_BUNDLE_LOCATION "${CMAKE_INSTALL_PREFIX}")
@@ -394,7 +394,7 @@ IF(BUILD_QtDialog)
     ENDIF(NOT "${ENDCH}" STREQUAL "/")
     SET(CMAKE_INSTALL_PREFIX 
       "${CMAKE_INSTALL_PREFIX}${CMAKE_BUNDLE_NAME}.app/Contents")
-  ENDIF(APPLE)
+  ENDIF(FALSE)
   
   SET(QT_NEED_RPATH FALSE)
   IF(NOT "${QT_LIBRARY_DIR}" STREQUAL "/lib" AND NOT "${QT_LIBRARY_DIR}" STREQUAL "/usr/lib" AND NOT "${QT_LIBRARY_DIR}" STREQUAL "/lib64" AND NOT "${QT_LIBRARY_DIR}" STREQUAL "/usr/lib64")
--- Source/QtDialog/CMakeLists.txt.orig	2010-02-10 19:39:59 +0100
+++ Source/QtDialog/CMakeLists.txt	2010-02-10 19:42:12 +0100
@@ -66,12 +66,12 @@ ELSE(NOT QT4_FOUND)
   IF(Q_WS_WIN)
     SET(SRCS ${SRCS} CMakeSetup.rc)
   ENDIF(Q_WS_WIN)
-  IF(Q_WS_MAC)
+  IF(FALSE)
     SET(SRCS ${SRCS} CMakeSetup.icns)
     SET(MACOSX_BUNDLE_ICON_FILE CMakeSetup.icns)
     SET_SOURCE_FILES_PROPERTIES(CMakeSetup.icns PROPERTIES
       MACOSX_PACKAGE_LOCATION Resources)
-  ENDIF(Q_WS_MAC)
+  ENDIF(FALSE)
 
   INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR})
   INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR})
@@ -79,13 +79,13 @@ ELSE(NOT QT4_FOUND)
   INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR})
   INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR})
 
-  ADD_EXECUTABLE(cmake-gui WIN32 MACOSX_BUNDLE ${SRCS})
+  ADD_EXECUTABLE(cmake-gui WIN32 ${SRCS})
   TARGET_LINK_LIBRARIES(cmake-gui CMakeLib ${QT_QTMAIN_LIBRARY} ${QT_LIBRARIES})
   IF(${CMAKE_MAJOR_VERSION}.${CMAKE_MINOR_VERSION} GREATER 2.4)
-    IF(APPLE)
+    IF(FALSE)
       SET_TARGET_PROPERTIES(cmake-gui PROPERTIES
        OUTPUT_NAME ${CMAKE_BUNDLE_NAME})
-    ENDIF(APPLE)
+    ENDIF(FALSE)
     SET(CMAKE_INSTALL_DESTINATION_ARGS 
       BUNDLE DESTINATION "${CMAKE_BUNDLE_LOCATION}")
   ENDIF(${CMAKE_MAJOR_VERSION}.${CMAKE_MINOR_VERSION} GREATER 2.4)
@@ -101,7 +101,7 @@ ELSE(NOT QT4_FOUND)
     INSTALL(FILES cmakecache.xml DESTINATION share/mime/packages )
   ENDIF(UNIX)
 
-  IF(APPLE)
+  IF(FALSE)
     SET(CMAKE_POSTFLIGHT_SCRIPT
       "${CMake_BINARY_DIR}/Source/QtDialog/postflight.sh")
     SET(CMAKE_POSTUPGRADE_SCRIPT
@@ -115,7 +115,7 @@ ELSE(NOT QT4_FOUND)
     INSTALL(CODE "set(input_file
        \"\$ENV{DESTDIR}\${CMAKE_INSTALL_PREFIX}/MacOS/${CMAKE_BUNDLE_NAME}\")")
     INSTALL(SCRIPT "${CMake_SOURCE_DIR}/Source/QtDialog/CMakeIngestOSXBundleLibraries.cmake")
-  ENDIF(APPLE)
+  ENDIF(FALSE)
   CONFIGURE_FILE("${QtDialog_SOURCE_DIR}/QtDialogCPack.cmake.in"
     "${QtDialog_BINARY_DIR}/QtDialogCPack.cmake" @ONLY)    
 ENDIF(NOT QT4_FOUND)
