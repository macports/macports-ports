# $Id$

PortSystem              1.0

name                    cfitsio
version                 3.100
revision                1
categories              devel
maintainers             nomaintainer

description \
    C/Fortran access to FITS data files with optional Fortran wrappers

long_description \
    CFITSIO is a library of C and Fortran subroutines for reading and \
    writing data files in FITS (Flexible Image Transport System) data \
    format. CFITSIO simplifies the task of writing software that deals \
    with FITS files by providing an easy to use set of high-level routines \
    that insulate the programmer from the internal complexities of the FITS \
    file format. At the same time, CFITSIO provides many advanced features \
    that have made it the most widely used FITS file programming interface \
    in the astronomical community.

platforms               darwin

homepage                http://heasarc.gsfc.nasa.gov/fitsio/
master_sites            ftp://heasarc.gsfc.nasa.gov/software/fitsio/c/
distname                ${name}[strsed ${version} {g/\.//}]

worksrcdir              ${name}

checksums \
    ${distname}${extract.suffix} \
        md5    3a4893c92f485d2d1c6cda10e49d2dcf \
        sha1   a0586a5411e2882165d55c46e66473f555142e07 \
        rmd160 cd2d944ad73c74053ecd4c78b7efe5195cc8d43b

# turn off FORTRAN compiler wrappers by removing FORTRAN from the path
configure.fc            ${prefix}/bin/no-possible-compiler

configure.cflags        -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64

build.target            all shared

post-destroot {
    system "ranlib ${destroot}${prefix}/lib/libcfitsio.a"
    set docdir ${destroot}${prefix}/share/doc/${name}-${version}
    xinstall -m 755 -d ${docdir}
    eval xinstall -m 644 ${worksrcpath}/README [glob ${worksrcpath}/*.txt] \
        [glob ${worksrcpath}/*.ps] [glob ${worksrcpath}/*.doc] \
        [glob ${worksrcpath}/*.toc] [glob ${worksrcpath}/*.tex] \
        ${docdir}
}

variant gcc42 description {create Fortran wrappers using gcc42} conflicts gcc43 g95 g77 {
    depends_lib-append  port:gcc42
    configure.fc-delete ${prefix}/bin/no-possible-compiler
    configure.fc        ${prefix}/bin/gfortran-mp-4.2
}

variant gcc43 description {create Fortran wrappers using gcc43} conflicts gcc42 g95 g77 {
    depends_lib-append  port:gcc43
    configure.fc-delete ${prefix}/bin/no-possible-compiler
    configure.fc        ${prefix}/bin/gfortran-mp-4.3
}

variant g95 description {create Fortran wrappers using f95} conflicts gcc42 gcc43 g77 {
    depends_lib-append  port:g95
    configure.fc-delete ${prefix}/bin/no-possible-compiler
    configure.fc        ${prefix}/bin/g95
}

variant g77 description {create Fortran wrappers using g77} conflicts gcc42 gcc43 g95 {
    depends_lib-append  bin:g77-dp-3.4:gcc34
    configure.fc-delete ${prefix}/bin/no-possible-compiler
    configure.fc        ${prefix}/bin/g77-dp-3.4
}
