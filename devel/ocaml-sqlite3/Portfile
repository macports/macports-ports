# $Id$

PortSystem          1.0
PortGroup ocaml 1.0

name                ocaml-sqlite3
version             1.6.3
categories          devel ml databases
platforms           darwin
maintainers         landonf openmaintainer
license             BSD
description         OCaml bindings for SQLite 3
long_description    ${description}

homepage            https://bitbucket.org/mmottl/sqlite3-ocaml
master_sites        https://bitbucket.org/mmottl/sqlite3-ocaml/downloads/

distname            sqlite3-ocaml-${version}

checksums           rmd160  2631aaa91d210015e8bcf45130dbd201e4e30b7b \
                    sha256  65c347570996703ddb1be6f83f87cf0266bcc046c428e54946ab2e809cf69c00

depends_lib         port:ocaml \
                    port:ocaml-findlib \
                    port:sqlite3

patchfiles          patch-Makefile.in

# ocamlmklib does not handle the -arch flag
if {[info exists build_arch] && ${os.platform} == "darwin"} {
  configure.cc_archflags
  configure.ld_archflags
  configure.pre_args-append --build=${build_arch}-apple-darwin${os.major}
}

configure.args      --with-sqlite3=${prefix}

use_parallel_build  no

pre-destroot {
    xinstall -m 755 -d ${destroot}${prefix}/share/doc
    file copy ${worksrcpath}/doc ${destroot}${prefix}/share/doc/${name}
}

livecheck.type      regex
livecheck.url       ${master_sites}
livecheck.regex     sqlite3-ocaml-(\[0-9.\]+)${extract.suffix}

