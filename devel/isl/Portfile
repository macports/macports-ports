# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           muniversal 1.0

name                isl
conflicts           isl-devel

epoch               2
version             0.20

categories          devel math
platforms           darwin
license             MIT
maintainers         {mcalhoun @MarcusCalhoun-Lopez} openmaintainer

description         Integer Set Library
long_description    isl is a library for manipulating sets and \
                    relations of integer points bounded by linear \
                    constraints. Supported operations on sets include \
                    intersection, union, set difference, emptiness \
                    check, convex hull, (integer) affine hull, integer \
                    projection, computing the lexicographic minimum \
                    using parametric integer programming, coalescing \
                    and parametric vertex enumeration. It also \
                    includes an ILP solver based on generalized basis \
                    reduction, transitive closures on maps (which may \
                    encode infinite graphs), dependence analysis and \
                    bounds on piecewise step-polynomials.
homepage            http://isl.gforge.inria.fr

depends_lib         port:gmp

master_sites        http://isl.gforge.inria.fr
use_bzip2           yes
checksums           rmd160  68464147f6c392876456c18faaf95d17d2800acc \
                    sha256  b587e083eb65a8b394e833dea1744f21af3f0e413a448c17536b5549ae42a4c2 \
                    size    1727820

configure.args      --disable-silent-rules

test.run            yes
test.target         check

livecheck.type      regex
livecheck.regex     ${name}-(\[0-9.\]+)${extract.suffix}

subport isl14 {
    epoch           0
    version         0.14.1

    conflicts-delete isl-devel

    checksums       rmd160  e4e45a8b777f89108303c165b149404ef84fd190 \
                    sha256  1f20561843eb9f6ae2076800bc45f3680ff7696520257cd5734ccfb843464cae \
                    size    1402630

    distname       isl-${version}

    # Don't link using "-flat_namespace -undefined suppress" on Yosemite and later.
    patchfiles-append   yosemite-libtool.patch

    configure.pre_args  --prefix=${prefix}/libexec/${subport}

    livecheck.regex     isl-([join [lrange [split ${version} .] 0 2] .]\[0-9.\]*)${extract.suffix}
}

subport isl18 {
    epoch           0
    version         0.18

    conflicts-delete isl-devel

    checksums           rmd160  e876f1049893de5be4a82a63f272f62547d455ca \
                        sha256  6b8b0fd7f81d0a957beb3679c81bbb34ccc7568d5682844d8924424a0dadcb1b \
                        size    1658291

    distname            isl-${version}

    # Add a missing include to the isl_int headers. Upstream doesn't want to
    # bother fixing deprecated APIs
    # (https://groups.google.com/d/msg/isl-development/N6UWJDbKXNA/2CY6WHDvOYoJ),
    # so this should be applied until they remove the headers outright.
    patchfiles          fix-deprecated-headers.patch

    configure.pre_args  --prefix=${prefix}/libexec/${subport}

    livecheck.regex     isl-([join [lrange [split ${version} .] 0 2] .]\[0-9.\]*)${extract.suffix}
}
