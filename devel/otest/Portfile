# $Id$

PortSystem			1.0
PortGroup			xcode 1.0

name				otest
version				41
categories			devel
maintainers			nomaintainer
description			Unit testing framework for Objective-C

long_description	OCUnit is a testing framework for Objective C in the Mac OS X, \
					Mac OS X Server, YellowBox/Cocoa and WebObjects environments. \
					This Objective C testing framework is a based on SUnit, Kent \
					Beck's Smalltalk unit testing framework, also available for Java \
					under the name JUnit, and is distributed as open source.

homepage            http://sente.epfl.ch/software/ocunit/
master_sites		http://www.sente.ch/pub/software/OCUnit/
distname			OCUnitHome-v${version}
dist_subdir			otest
extract.suffix		.tgz

depends_run			port:sentestingkit

checksums			md5 292cc78f477ca75890f455b5d9f9d04d \
					sha1 4ce07d4688a2dacfa37e2b315f8e849d6d5d17c1 \
					rmd160 40ae3553853c83de96a221f1d779fea0a5fdecf4

worksrcdir			[strsed ${distname} {/-.*$//}]/OCUnit/SourceCode/${name}

xcode.project			${name}.xcode
xcode.configuration		RootDeployment
xcode.destroot.path		${prefix}/bin

# Dummy configure to enable universal variant
use_configure	yes
configure		{}

post-patch {
	reinplace "s/~//" ${worksrcpath}/${name}.1 ${worksrcpath}/${xcode.project}/project.pbxproj
	reinplace "s|/usr/local|${prefix}/share|" ${worksrcpath}/${xcode.project}/project.pbxproj
}

post-activate {
	ui_info "To enable the use of MacPorts otest tool inside Xcode, you should set the OTEST"
	ui_info "environment variable to:"
	ui_info "	${prefix}/bin/otest"
}

variant universal {
	build.args		"ARCHS=\"i386 ppc\""
	destroot.args	"ARCHS=\"i386 ppc\""
}

livecheck.check	regex
livecheck.url	${homepage}
livecheck.regex	{New in Release v(\d+)}

