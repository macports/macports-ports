# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           github 1.0

github.setup        ocicl ocicl 2.5.22 v
revision            0
checksums           rmd160  d0570c75caea5b78464348dcefd5a8eac590a4a5 \
                    sha256  78e378a84f96f52a0dd8518a9d049f94d2d76ee0c3ec7db1384104e45b5c20e5 \
                    size    10146815

categories          devel

license             MIT

maintainers         @rudolfochrist

description         An OCI-based ASDF system distribution and management tool for Common Lisp
long_description    ${name} is a modern alternative to quicklisp. It is modern in the sense that: \
                    \n \
                    \n- All software is packaged as OCI-compliant artifacts and distributed from mirrored OCI-compliant registries (the GitHub and Docker Hub Container Registries). \
                    \n- All software packages are securely distributed over TLS connections. \
                    \n- All connections respect HTTPS_PROXY environment settings for authenticated proxy support. \
                    \n- sigstore is used to ensure the integrity and authenticity of all software packages. \
                    \n- Software packages are project-local by default, simplifying the process of tying specific versions to your projects. \
                    \n- All software packages are built and published transparently using hosted CI infrastructure \
                    \n- LLM-generated summaries of changes between versions are available for all packages.

homepage            https://github.com/ocicl/ocicl
github.tarball_from archive

depends_build       port:sbcl

use_configure       no

build.env           OCICL_PREFIX=${worksrcpath}/stage
build.cmd           sbcl --non-interactive --no-userinit
build.target        --load setup.lisp

destroot {
    xinstall ${worksrcpath}/stage/bin/ocicl ${destroot}${prefix}/bin/ocicl
}

notes-append "
After installation run 'ocicl setup' to install the ocicl-runtime library:
    $ ocicl setup
    ;; Add the following to your lisp startup file
    ;; (~/.sbclrc, ~/.eclrc, ~/.abclrc or ~/.roswell/init.lisp):

    #-ocicl
    (when (probe-file #P\"/home/green/.local/share/ocicl/ocicl-runtime.lisp\")
    (load #P\"/home/green/.local/share/ocicl/ocicl-runtime.lisp\"))
    (asdf:initialize-source-registry
     (list :source-registry (list :directory (uiop:getcwd)) :inherit-configuration))
"

