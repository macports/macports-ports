# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           golang 1.0

go.setup            github.com/mvdan/sh 3.6.0 v
name                shfmt
categories          devel
maintainers         {amake @amake} openmaintainer
license             BSD

description         Autoformat shell script source code

long_description    A shell script formatter supporting POSIX shell, Bash, and mksh.

go.package          mvdan.cc/sh

checksums           ${distname}${extract.suffix} \
                        rmd160  677a6f78a97602c05646d4d0d49d8878c52f1566 \
                        sha256  691827287a7a4558283d88d7fb03bd4a70be06b0c303d6c3b4fced5bc36bcdb8 \
                        size    216700

go.vendors          mvdan.cc/editorconfig \
                        repo    github.com/mvdan/editorconfig \
                        lock    v0.2.0 \
                        rmd160  eeb4ad1e0690027cac47e6bcaa7567937e1177d4 \
                        sha256  0f53c5da1bc4c459c91f8a4a64397ec0b0321a483a2a9e95f2ffc6607f35b54b \
                        size    9402 \
                    golang.org/x/term \
                        lock    v0.3.0 \
                        rmd160  14a60f913597d05ed7df0b6d6fbca50ca672b594 \
                        sha256  c5e084b265e4c0dfb37ef0a0e7aa5b5ff4f9afe55c71452d13789a85abcd46c9 \
                        size    14800 \
                    golang.org/x/sys \
                        lock    v0.3.0 \
                        rmd160  17c78e6210a6f938db21fa772584ab8c7d4e06c1 \
                        sha256  b04ddf676ead57e0d3e367e9aa17db1b11fc20af719e479d1ca56873a2bdf06b \
                        size    1411264 \
                    golang.org/x/sync \
                        lock    v0.1.0 \
                        rmd160  bf68702d961107a225cce561701852f129f16a3d \
                        sha256  50a67a11e715a61c022f218604adc63e61684de5f5db2330741077439c4ce68f \
                        size    19355 \
                    github.com/rogpeppe/go-internal \
                        lock    v1.9.0 \
                        rmd160  acb8f644e5634bdae632cdb61ea736422aeb88f0 \
                        sha256  65b0852e5c78fa920fef2176fa17180bf1f7f32a1163baacb44c2aa480845a16 \
                        size    133682 \
                    github.com/pkg/diff \
                        lock    20ebb0f2a09e \
                        rmd160  f8336f7442e9394b64a6aad23a6ae1d6a230dfc4 \
                        sha256  086dfcc0449ef79f412e6308fd2ace2207a8a88cde2c86f13f77635673e08890 \
                        size    200592 \
                    github.com/kr/text \
                        lock    v0.2.0 \
                        rmd160  48558c7e8ff67d510f83c66883907e95f4783163 \
                        sha256  2f2e21ac8a9d523e88cbba4039441defc4a66bfaa78811c900a88fcf28729c4c \
                        size    8702 \
                    github.com/kr/pretty \
                        lock    v0.3.1 \
                        rmd160  8c08579b4c56cdc958794e77afe3413e80aa67c3 \
                        sha256  7fcea475d6280976cf4a838e75d2b3a4105827316e588a80e49e8063d950c999 \
                        size    10232 \
                    github.com/google/renameio \
                        lock    v2.0.0 \
                        rmd160  3e5bee752f1d83bcb6b2598ff5fdc2be13f69cfc \
                        sha256  7aba06e13c302f23c133799fbc596417832109f674e35b686a9e19223968441c \
                        size    14223 \
                    github.com/google/go-cmp \
                        lock    v0.5.9 \
                        rmd160  9832ae80123461baed8aa20e830199c0e21e337b \
                        sha256  3058d20d61f03aa05fca0fc07acb8c50850c68086998c542857aec7ad1529482 \
                        size    104431 \
                    github.com/frankban/quicktest \
                        lock    v1.14.4 \
                        rmd160  3e886282dd68388197724b50d6e2cf503e67b6fe \
                        sha256  4a9be95b7fd81f6d3c3a753b2141f4e1d9371fabe391bcf4dacd84d540d380c4 \
                        size    39505 \
                    github.com/creack/pty \
                        lock    v1.1.18 \
                        rmd160  7ba5c3871eab7e529a05dc65ddc2a68c9daa6017 \
                        sha256  19cd1eaadd9f3218dc3e71483833a979c245090b5e64512a9d4cf4acf22f3112 \
                        size    10671

build.pre_args      -ldflags '-X main.version=${version}'
build.post_args     ${go.package}/cmd/shfmt

depends_build-append  port:scdoc

post-build {
    system -W ${worksrcpath} "scdoc < cmd/shfmt/shfmt.1.scd | gzip > shfmt.1.gz"
}

destroot {
    xinstall -m 0755 ${worksrcpath}/${name} ${destroot}${prefix}/bin
    xinstall -m 0644 ${worksrcpath}/shfmt.1.gz ${destroot}${prefix}/share/man/man1
}

github.livecheck.regex  {([0-9.]+)}
