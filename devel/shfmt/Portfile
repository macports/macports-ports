# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           golang 1.0

go.setup            github.com/mvdan/sh 3.2.1 v
name                shfmt
categories          devel
maintainers         {amake @amake} openmaintainer
license             BSD

description         Autoformat shell script source code

long_description    A shell script formatter supporting POSIX shell, Bash, and mksh.

go.package          mvdan.cc/sh

checksums           ${distname}${extract.suffix} \
                        rmd160  32f39100c38d5dcc34065a221a0ebbecb6799fba \
                        sha256  1105e27544abccabc519d5f7247b6c5fb6408caba1fa0a04f50600a6ac4489c5 \
                        size    181070 \

go.vendors          mvdan.cc/editorconfig \
                        repo    github.com/mvdan/editorconfig \
                        lock    e40951bde157 \
                        rmd160  1262f81708a7f5f626fa77318897780a3104373a \
                        sha256  ff6d5f23da7cfd2d9afaa6f139365cd6d2a52f56ffc4a44e727bc9096c959744 \
                        size    9311 \
                    gopkg.in/yaml.v2 \
                        lock    v2.2.2 \
                        rmd160  03aea7b7e847179b29044d5a928b9f8a889fe87b \
                        sha256  da1e31b7beb9a6907947caa794134bdc2501d1a3474568b61cc2562a398d3d87 \
                        size    70676 \
                    gopkg.in/errgo.v2 \
                        lock    v2.1.0 \
                        rmd160  6629a8436aacbbf5e42c0211d591941bfd8ce34d \
                        sha256  c14c14eba0928e6dfa4f89449bdbe2b6feafc76116b60bdc1b51956abf55c6bf \
                        size    9938 \
                    gopkg.in/check.v1 \
                        lock    788fd7840127 \
                        rmd160  b63165c8909a27edc15dda210df66a1b49efb49e \
                        sha256  7e5547c6471cc48da89a7c87f965b20ca5311f43fc4d883ca62f9fccf7551630 \
                        size    31597 \
                    golang.org/x/term \
                        lock    ad39bd3f0407 \
                        rmd160  71b379fd8428cf4204f2ef83244ff77a26986988 \
                        sha256  2614c636c1ff18bf771909fc742f9c2ac7da90a5e591ecdd82f227477c781998 \
                        size    3898 \
                    golang.org/x/sys \
                        lock    201ba4db2418 \
                        rmd160  b9c1928e984674827b0fc5388429b43fea4bd0e9 \
                        sha256  add77b06939efdd672258cede04133f802acb2e3fe817f66f596e7eaf9099c56 \
                        size    1078837 \
                    golang.org/x/sync \
                        lock    67f06af15bc9 \
                        rmd160  1975599ab89b8c6a6b7fbca131efb1b705f7f022 \
                        sha256  78883bdc5e24128ee3700bfe03eddb759dbaabdeb99eeda2826bf95a2784d18e \
                        size    18695 \
                    github.com/stretchr/testify \
                        lock    v1.4.0 \
                        rmd160  86bd663e13ea7266334c47689074df16252db5ff \
                        sha256  8ed95078bfd318ea477da509e6b16e6cf8d0d1b6b8d93b1f6097c6ba2a6df788 \
                        size    110114 \
                    github.com/sergi/go-diff \
                        lock    v1.0.0 \
                        rmd160  c5ac5f7253544101282f5477a71560d1fd6c3e58 \
                        sha256  147eecf13dff7c6715ada19e097d4c3b7d20b169b475861a98e41e27b891d062 \
                        size    41633 \
                    github.com/rogpeppe/go-internal \
                        lock    v1.6.2 \
                        rmd160  2846fb5b3dc0aa3ebf74166c27b7593b72efd67f \
                        sha256  3cea19a23e8e335c8fdd80e3fd2273f3bb5d4cbe558cc38971db2476e89b73bd \
                        size    123232 \
                    github.com/pmezard/go-difflib \
                        lock    v1.0.0 \
                        rmd160  fc879bfbdef9e3ff50844def58404e2b5a613ab8 \
                        sha256  7cd492737641847266115f3060489a67f63581e521a8ec51efbc280c33fc991f \
                        size    11409 \
                    github.com/pkg/diff \
                        lock    5b29258ca4f7 \
                        rmd160  f64e901711bf8a99a3bd67e64fc4a1db4a4fb083 \
                        sha256  52a522dc9d3001ff39a69b9e5025e94da6b783e2705ecf9cac960546587d942e \
                        size    201074 \
                    github.com/kr/text \
                        lock    v0.1.0 \
                        rmd160  0b3c78459e227170a3b80a0103d87a3eef77ed88 \
                        sha256  5ed970aad0da3cba3cffacdb4d154a162a8968655ee6d6f7b627e71b869efaf6 \
                        size    8691 \
                    github.com/kr/pretty \
                        lock    v0.2.1 \
                        rmd160  eaf5b58a46b962079cbafddbc3ef83bdbf02b31e \
                        sha256  253c4a190c9337800e08aba66b77ea3db0835e3ae61289d80093995a649eb7ae \
                        size    8769 \
                    github.com/google/renameio \
                        lock    v0.1.0 \
                        rmd160  ba2fe6be9202636dcf17dd2d1c495aceed231cc9 \
                        sha256  dd166ecfcacfff3e36567edab9ef94affe756932becbf382939c20646f504a83 \
                        size    9728 \
                    github.com/davecgh/go-spew \
                        lock    v1.1.0 \
                        rmd160  0303eae19a01f38fe314921fd965e4d09b9ef3ad \
                        sha256  810a597004388d68bb92d8aa612375419ba1080dd5fc2c66dd41b58f0ba4442c \
                        size    42348 \
                    github.com/creack/pty \
                        lock    v1.1.11 \
                        rmd160  59af3958845963790280e10bb0ff275e202406c5 \
                        sha256  648758575d338a1abcc7f3f3cbc9c138f079355d4defe709949ecd7e639c48a2 \
                        size    8407

build.pre_args      -ldflags '-X main.version=${version}'
build.post_args     ${go.package}/cmd/shfmt

depends_build-append  port:scdoc

post-build {
    system -W ${worksrcpath} "scdoc < cmd/shfmt/shfmt.1.scd | gzip > shfmt.1.gz"
}

destroot {
    xinstall -m 0755 ${worksrcpath}/${name} ${destroot}${prefix}/bin
    xinstall -m 0644 ${worksrcpath}/shfmt.1.gz ${destroot}${prefix}/share/man/man1
}

livecheck.regex     {archive/v([0-9.]+)\.tar\.gz}
