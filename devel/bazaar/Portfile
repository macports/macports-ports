# $Id: Portfile,v 1.3 2005/09/25 19:53:03 mww Exp $
PortSystem 1.0
name              bazaar
version           1.4.2
distname          bazaar_${version}
categories        devel
maintainers       josh_root@users.sourceforge.net
description       an improved GNU Arch client
long_description \
	Bazaar is intended to be an implementation of the GNU Arch \
	protocol that open source developers both want to use, and \
	love using. It is a drop-in replacement for tla. \
	GNU arch is a revision control system, similar in purpose to \
	tools such as CVS, SCCS, and Subversion. It is used to keep \
	track of the changes made to a source tree and to help \
	programmers combine and otherwise manipulate changes made by \
	multiple people or at different times.
homepage          http://bazaar.canonical.com/

master_sites      http://bazaar.canonical.com/releases/src/
checksums    md5 6e61d7aeec990a801977ee6cdc3958d5

configure.env 	CFLAGS="-I'${prefix}/include' -L'${prefix}/lib'"
configure.dir    ${workpath}/thelove@canonical.com---dists--bazaar--1.4/build
build.dir        ${configure.dir}

pre-configure {
	file mkdir ${configure.dir}
}
configure.cmd    ../src/configure

build.env CFLAGS="-g -O2 -Wall -fno-strict-aliasing \
-I'${prefix}/include' -L'${prefix}/lib' \
-lintl -lneon -lgpgme -lpth"

destroot.env CFLAGS="-I'${prefix}/include' -L'${prefix}/lib' -lintl -lneon -lgpgme" \
LDFLAGS="-L'${prefix}/lib'"
destroot.destdir prefix=${destroot}${prefix}
post-destroot   {
	file rename ${destroot}${prefix}/bin/annotate ${destroot}${prefix}/bin/annotate-baz
}

variant darwin {
	if {${os.version} < 8} {
		depends_lib           bin:gdiff:diffutils
		depends_lib	      bin:gpatch:gpatch
		depends_lib	      bin:gnutar:gnutar
		configure.args-append --with-gnu-diff=${prefix}/bin/gdiff \
		                      --with-gnu-diff3=${prefix}/bin/gdiff3
	}
	depends_lib	      lib:libneon:neon
	depends_lib	      lib:libgpgme:gpgme
}
