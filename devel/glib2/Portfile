# $Id: Portfile,v 1.28 2004/09/10 21:19:10 mij Exp $

PortSystem 1.0
name		glib2
version		2.4.6
categories	devel
maintainers	mij@opendarwin.org
description	Library with data structure functions and other constructs
homepage	http://www.gtk.org/
platforms	darwin

long_description Glib is a library which includes support routines for \
		 C, such as lists, trees, hashes, memory allocation, and \
		 many other things.

master_sites	gnome:sources/glib/2.4

distname	glib-${portversion}
checksums	md5 a45db7d82480da431f6cd00ea041a534

use_bzip2	yes

depends_build	bin:pkg-config:pkgconfig
depends_lib	lib:libintl.3:gettext

patchfiles	patch-configure

configure.env	LDFLAGS="-L${prefix}/lib -bind_at_load" \
		CPPFLAGS="-I${prefix}/include" \
		CFLAGS="-O3 -funroll-loops -fstrict-aliasing"

configure.args   --mandir=${prefix}/share/man

variant puredarwin { depends_run bin:perl:perl5.8 }

post-destroot {
		system "ln -fs libglib-2.0.0.400.6.dylib \
		    ${destroot}${prefix}/lib/libglib.2.dylib"
		system "ln -fs libgmodule-2.0.0.400.6.dylib \
		    ${destroot}${prefix}/lib/libgmodule.2.dylib"
		system "ln -fs libgobject-2.0.0.400.6.dylib \
		    ${destroot}${prefix}/lib/libgobject.2.dylib"
		system "ln -fs libgthread-2.0.0.400.6.dylib \
		    ${destroot}${prefix}/lib/libgthread.2.dylib"
		file delete ${destroot}${prefix}/lib/charset.alias
}
