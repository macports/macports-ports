# $Id: Portfile,v 1.12 2003/06/29 20:42:03 mij Exp $

PortSystem 1.0
name		glib2
version		2.2.2
categories	devel
maintainers	mij@opendarwin.org
description	Library with data structure functions and other constructs
homepage	http://www.gtk.org/
platforms	darwin

long_description Glib is a library which includes support routines for \
		 C, such as lists, trees, hashes, memory allocation, and \
		 many other things.

master_sites	ftp://ftp.gnome.org/pub/gnome/sources/glib/2.2/ \
		ftp://archive.progeny.com/GNOME/sources/glib/2.2/ \
		http://archive.progeny.com/GNOME/sources/glib/2.2/

distname	glib-${portversion}
checksums	md5 3e9a9512943c81a78cafa0536dcc8b41

use_bzip2	yes

depends_lib	lib:libdl.1:dlcompat lib:libintl.1:gettext
depends_build	bin:pkg-config:pkgconfig

patchfiles	patch-Makefile.in patch-configure \
		patch-glib-libcharset-Makefile.in \
		patch-glib-libcharset-charset.alias \
		patch-ltmain.sh patch-po-Makefile.in.in

configure.env	LDFLAGS="-L${prefix}/lib" CPPFLAGS="-I${prefix}/include \
		-no-cpp-precomp" CFLAGS="-O3 -funroll-loops -fstrict-aliasing"

configure.args	--disable-gtk-doc

variant puredarwin { depends_run bin:perl:perl5.8 }

post-install	{ system "ln -fs libglib-2.0.0.200.2.dylib \
		    ${destroot}${prefix}/lib/libglib.2.dylib"
		  system "ln -fs libgmodule-2.0.0.200.2.dylib \
		    ${destroot}${prefix}/lib/libgmodule.2.dylib"
		  system "ln -fs libgobject-2.0.0.200.2.dylib \
		    ${destroot}${prefix}/lib/libgobject.2.dylib"
		  system "ln -fs libgthread-2.0.0.200.2.dylib \
		    ${destroot}${prefix}/lib/libgthread.2.dylib" }
