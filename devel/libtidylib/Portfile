# -*- coding: utf-8; mode: tcl; tab-width: 4; truncate-lines: t; indent-tabs-mode: nil; c-basic-offset: 4 -*-
# $Id$
# vim: set fileencoding=utf-8 tabstop=8 shiftwidth=4 softtabstop=4 noexpandtab filetype=tcl :

PortSystem	    1.0

name		    libtidylib
version		    0.1.1
#epoch		    20090114
#revision	    1
platforms	    darwin
categories	    devel
maintainers	    macports.org:krischik
description	    libtidylib for Sigil, the ePub editor
long_description					\
    Sigil is a multi-platform WYSIWYG ebook editor. It	\
    is designed to edit books in ePub format

homepage	    http://code.google.com/p/sigil
master_sites	    googlecode:sigil

distfiles	    Sigil_code_${version}.zip
worksrcdir	    Sigil_code_${version}/src
dist_subdir	    sigil

checksums           md5     ef1d26bf5e20e5b0313484840cc23ef5 \
                    sha1    48554f7026ebb9e788b54deaa9c6095cc28de166 \
                    rmd160  743fe87f7d1d3afbbefd5e37d04f6d91aa4e9e09

use_zip		    yes
use_parallel_build  yes
use_configure	    yes

depends_lib	    port:qt4-mac

configure {
    system "
	if test ! -x /opt/local/bin/qmake ; then
	    ln -s /opt/local/libexec/qt4-mac/bin/qmake /opt/local/bin;
	fi;
	mkdir -p ${workpath}/build;
	pushd ${workpath}/build;
	    cmake -G \"Unix Makefiles\" ${workpath}/${worksrcdir}/tidylib;
	popd;
    "
}

build {
    system "
	pushd ${workpath}/build;
	    gmake;
	popd;
    "
}

destroot {
    set lib_dir	${destroot}${prefix}/lib

    xinstall -m 775 -d ${lib_dir}

    eval xinstall -m 644 [glob ${workpath}/build/lib*]	${lib_dir}
}


