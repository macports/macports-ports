# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           github 1.0

github.setup        oven-sh bun 1.2.22 v
git.branch          ${github.project}-${github.tag_prefix}${github.version}

maintainers         {johnlindop.com:git @JLindop} openmaintainer

description         Bun is an all-in-one toolkit for JavaScript and TypeScript apps.

long_description    Bun is a fast JavaScript runtime designed as a drop-in replacement for Node.js. \
                    It's written in Zig and powered by JavaScriptCore under the hood, \
                    dramatically reducing startup times and memory usage.

categories          devel
homepage            https://bun.sh
license             MIT

# Checksums of source zip
checksums           rmd160  89953c041f3941084e0168479396c778da5e8e10 \
                    sha256  35101dfffd4c63e178c09b746512b28a7080be2a98e54293f5ef5a8f9032d400 \
                    size    34697263

supported_archs     arm64 x86_64

if {${configure.build_arch} eq "arm64"} {
    set dist_arch "aarch64"
    checksums       rmd160  541a474d99af1b37c2e0905f2f41082b7d3ed9fe \
                    sha256  eb8c7e09cbea572414a0a367848e1acbf05294a946a594405a014b1fb3b3fc76 \
                    size    22178114
} elseif {${configure.build_arch} eq "x86_64"} {
    set dist_arch "x64"
    checksums       rmd160  ce5d6f45b497c23f1642fdcf6c6b58df4b599e8f \
                    sha256  a7484721a7ead45887c812e760b124047e663173cf2a3ba7c5aa1992cb22cd3e \
                    size    24742163
} else {
    set dist_arch ${configure.build_arch}
}

distname            ${name}-${os.platform}-${dist_arch}
use_zip             yes
use_configure       no

build {}

destroot {
    xinstall -m 755 ${worksrcpath}/bun ${destroot}${prefix}/bin/bun
    file link -symbolic ${destroot}${prefix}/bin/bunx bun
}
