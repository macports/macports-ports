# $Id: Portfile,v 1.9 2004/05/07 20:34:54 jkh Exp $

PortSystem 1.0
name		ddd
version		3.3.1
revision	1
categories	devel
maintainers	jkh@opendarwin.org
description	Data Display Debugger
long_description DDD is a graphical front-end for GDB and other command-line debuggers.
homepage	http://www.gnu.org/software/ddd/
platforms	darwin
master_sites	gnu
checksums	md5 38589618d7cd02a03d062bb116bbf1d2
depends_lib	lib:libXm.4:openmotif
patchfiles	patch-combo patch-logplayer.C

# Use darwin variant.  Other OSes with gcc > 3.2 will need to come up with
# their own hack since this code doesn't compile with gcc 3.3.
variant darwin {
	configure.env CC=gcc3 CXX=c++3 CFLAGS=-no-cpp-precomp
}

post-configure {
	system "for i in `grep -rl '^#pragma implementation' ${worksrcpath}` ; do sed -e 's:^#pragma implementation:// #pragma implementation:' < \$i > \$i.new && mv \$i.new \$i; done"
	system "for i in `grep -rl '^#pragma interface' ${worksrcpath}` ; do sed -e 's:^#pragma interface:// #pragma interface:' < \$i > \$i.new && mv \$i.new \$i; done"
}

post-destroot {
	file rename ${destroot}${prefix}/bin/ddd.exe ${destroot}${prefix}/bin/ddd
}
